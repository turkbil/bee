<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop Product AI System - Implementation Prompt</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            line-height: 1.8;
            padding: 40px 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            margin-bottom: 50px;
            padding-bottom: 30px;
            border-bottom: 2px solid #334155;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #60a5fa, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .meta {
            color: #94a3b8;
            font-size: 0.95rem;
        }

        section {
            margin-bottom: 50px;
        }

        h2 {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: #60a5fa;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        h3 {
            font-size: 1.4rem;
            color: #fbbf24;
            margin-bottom: 15px;
            margin-top: 30px;
        }

        .block {
            background: rgba(30, 41, 59, 0.6);
            padding: 30px;
            margin-bottom: 25px;
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
        }

        .block.critical {
            border-left-color: #dc2626;
            background: rgba(220, 38, 38, 0.1);
        }

        .block.success {
            border-left-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }

        .block.warning {
            border-left-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        }

        .code {
            background: #0f172a;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid #334155;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: #86efac;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: rgba(30, 41, 59, 0.3);
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #334155;
        }

        th {
            background: rgba(59, 130, 246, 0.2);
            color: #93c5fd;
            font-weight: 600;
        }

        td {
            color: #cbd5e1;
        }

        ul, ol {
            margin-left: 25px;
            margin-top: 10px;
        }

        li {
            margin-bottom: 8px;
            color: #cbd5e1;
        }

        .flow {
            background: rgba(30, 41, 59, 0.5);
            padding: 25px;
            margin: 20px 0;
            border-radius: 12px;
            border: 2px solid #3b82f6;
        }

        .step {
            padding: 15px;
            margin: 10px 0;
            border-left: 3px solid #60a5fa;
            background: rgba(59, 130, 246, 0.05);
            border-radius: 6px;
        }

        .step.branch-a {
            border-left-color: #10b981;
            margin-left: 30px;
        }

        .step.branch-b {
            border-left-color: #dc2626;
            margin-left: 30px;
        }

        footer {
            margin-top: 60px;
            padding-top: 30px;
            border-top: 1px solid #334155;
            color: #64748b;
            font-size: 0.9rem;
            text-align: center;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ¤– Shop Product AI Content Generator</h1>
            <div class="meta">
                ğŸ“‹ Implementation Prompt | ğŸ¯ Yedek ParÃ§a Otomatik Ä°Ã§erik Ãœretimi
            </div>
        </header>

        <!-- SÄ°STEM KONTEKST -->
        <section>
            <h2><i class="fas fa-server"></i> SÄ°STEM KONTEKST</h2>

            <div class="block">
                <h3>ğŸ¢ Multi-Tenant Laravel Sistemi</h3>
                <table>
                    <tr>
                        <th>Parametre</th>
                        <th>DeÄŸer</th>
                    </tr>
                    <tr>
                        <td>Tenant ID</td>
                        <td>2</td>
                    </tr>
                    <tr>
                        <td>Domain</td>
                        <td>ixtif.com</td>
                    </tr>
                    <tr>
                        <td>Database</td>
                        <td>tenant_ixtif</td>
                    </tr>
                    <tr>
                        <td>SektÃ¶r</td>
                        <td>EndÃ¼striyel Ekipman (Forklift, Transpalet)</td>
                    </tr>
                    <tr>
                        <td>Laravel Versiyonu</td>
                        <td>11.x</td>
                    </tr>
                    <tr>
                        <td>PHP Versiyonu</td>
                        <td>8.3</td>
                    </tr>
                </table>

                <h3 style="margin-top: 25px;">ğŸ“Š Database Tables</h3>
                <div class="code">shop_products        â†’ Ana Ã¼rÃ¼n tablosu (PK: product_id)
shop_categories      â†’ Kategori tablosu (PK: category_id)
shop_brands          â†’ Marka tablosu (PK: brand_id)
shop_product_variants â†’ Variant Ã¼rÃ¼nler
media_library_items  â†’ GÃ¶rsel yÃ¶netimi (Leonardo AI outputs)</div>
            </div>

            <div class="block">
                <h3>ğŸ—„ï¸ ShopProduct Model</h3>
                <div class="code">Namespace: Modules\Shop\App\Models\ShopProduct
Table: shop_products
Primary Key: product_id (integer)

Translatable Fields (Spatie/HasTranslations):
- title (array: tr/en)
- slug (array: tr/en)
- body (array: tr/en)
- short_description (array: tr/en)

JSON Fields:
- primary_specs (array)
- faq_data (array)
- tags (array)
- technical_specs (array)
- highlighted_features (array)

Relations:
- category (BelongsTo ShopCategory)
- brand (BelongsTo ShopBrand)
- variants (HasMany ShopProductVariant)
- parent (BelongsTo ShopProduct, foreign: parent_product_id)</div>
            </div>

            <div class="block">
                <h3>ğŸ—„ï¸ ShopCategory Model</h3>
                <div class="code">Namespace: Modules\Shop\App\Models\ShopCategory
Table: shop_categories
Primary Key: category_id (integer)

Important Fields:
- parent_id (integer, nullable) â†’ Alt kategori ise parent category ID
- title (array: tr/en)
- slug (array: tr/en)

Yedek ParÃ§a Kategorisi:
category_id = 7 (parent_id IS NULL)
Alt kategoriler: parent_id = 7</div>
            </div>

            <div class="block">
                <h3>ğŸ§  AI Services</h3>
                <table>
                    <tr>
                        <th>Service</th>
                        <th>Namespace</th>
                        <th>KullanÄ±m</th>
                    </tr>
                    <tr>
                        <td>OpenAI GPT-4</td>
                        <td>App\Services\OpenAI\OpenAIService</td>
                        <td>Ä°Ã§erik Ã¼retimi (TR + EN bilingual)</td>
                    </tr>
                    <tr>
                        <td>Leonardo AI</td>
                        <td>App\Services\Media\LeonardoAIService</td>
                        <td>GÃ¶rsel Ã¼retimi (1024x1024 square)</td>
                    </tr>
                </table>
            </div>
        </section>

        <!-- GÃ–REV TANIMI -->
        <section>
            <h2><i class="fas fa-bullseye"></i> GÃ–REV TANIMI</h2>

            <div class="block critical">
                <h3>ğŸ¯ Ne YapacaksÄ±n?</h3>
                <p>Shop modÃ¼lÃ¼ iÃ§in <strong>yedek parÃ§a Ã¼rÃ¼nlerine</strong> otomatik AI iÃ§erik Ã¼retimi sistemi oluÅŸturacaksÄ±n.</p>

                <h3 style="margin-top: 20px;">âœ… Hangi ÃœrÃ¼nler Ä°ÅŸlenecek?</h3>
                <ul>
                    <li><strong>Kategori:</strong> Sadece "Yedek ParÃ§a" (category_id = 7 VEYA parent category = 7)</li>
                    <li><strong>Variant Durumu:</strong> Sadece ana Ã¼rÃ¼nler (parent_product_id IS NULL veya 0)</li>
                    <li><strong>Variant Ã¼rÃ¼nler SKIP:</strong> EÄŸer parent_product_id > 0 ise iÅŸleme</li>
                </ul>

                <h3 style="margin-top: 20px;">ğŸš« Hangi ÃœrÃ¼nler Ä°ÅLENMEZ?</h3>
                <ul>
                    <li>âŒ Forklift kategorisi Ã¼rÃ¼nleri</li>
                    <li>âŒ Transpalet kategorisi Ã¼rÃ¼nleri</li>
                    <li>âŒ Variant Ã¼rÃ¼nler (child products)</li>
                    <li>âŒ DiÄŸer kategoriler</li>
                </ul>
            </div>

            <div class="block warning">
                <h3>âš¡ Ä°ki FarklÄ± Strateji</h3>
                <p>ÃœrÃ¼n iÃ§eriÄŸi <strong>mevcut durumuna gÃ¶re</strong> iki farklÄ± akÄ±ÅŸa girecek:</p>

                <table style="margin-top: 15px;">
                    <tr>
                        <th>Durum</th>
                        <th>Strateji</th>
                        <th>Ne YapÄ±lacak?</th>
                    </tr>
                    <tr>
                        <td><strong>Branch A</strong><br>Mevcut iÃ§erik VAR</td>
                        <td>EXPAND (GeniÅŸlet)</td>
                        <td>
                            â€¢ Mevcut teknik detaylarÄ± koru<br>
                            â€¢ Ä°Ã§eriÄŸi geniÅŸlet<br>
                            â€¢ SEO ekle
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Branch B</strong><br>Mevcut iÃ§erik YOK</td>
                        <td>CREATE (Genel OluÅŸtur)</td>
                        <td>
                            â€¢ Genel tanÄ±tÄ±m yap<br>
                            â€¢ Teknik detay VERME<br>
                            â€¢ GÃ¼venli iÃ§erik
                        </td>
                    </tr>
                </table>
            </div>
        </section>

        <!-- AKIÅ DÄ°YAGRAMI -->
        <section>
            <h2><i class="fas fa-project-diagram"></i> AKIÅ DÄ°YAGRAMI</h2>

            <div class="flow">
                <div class="step">
                    <strong>BAÅLANGIÃ‡:</strong> Admin "Generate AI Content" butonuna tÄ±klar
                </div>

                <div class="step">
                    <strong>1. ÃœRÃœN FÄ°LTRELEME</strong>
                    <div class="code">$product = ShopProduct::find($productId);

// Kontrol 1: Yedek parÃ§a mÄ±?
if ($product->category_id != 7 && $product->category->parent_id != 7) {
    throw new Exception('Bu Ã¼rÃ¼n yedek parÃ§a kategorisinde deÄŸil');
}

// Kontrol 2: Variant Ã¼rÃ¼n mÃ¼?
if ($product->parent_product_id && $product->parent_product_id > 0) {
    throw new Exception('Variant Ã¼rÃ¼nler iÅŸlenmez, sadece ana Ã¼rÃ¼nler');
}</div>
                </div>

                <div class="step">
                    <strong>2. MEVCUT Ä°Ã‡ERÄ°K KONTROLÃœ (KRÄ°TÄ°K!)</strong>
                    <div class="code">$existingBody = $product->body['tr'] ?? '';
$hasContent = strlen($existingBody) > 100;

if ($hasContent) {
    // BRANCH A â†’ GeniÅŸlet
    $strategy = 'expand';
} else {
    // BRANCH B â†’ Yeni oluÅŸtur
    $strategy = 'create';
}</div>
                </div>

                <h3 style="color: #86efac; margin-top: 30px;">ğŸŸ¢ BRANCH A - Mevcut Ä°Ã§erik Varsa</h3>

                <div class="step branch-a">
                    <strong>A1. Mevcut veriyi parse et</strong>
                    <div class="code">$existingData = [
    'body' => $product->body,
    'primary_specs' => $product->primary_specs,
    'faq_data' => $product->faq_data,
];

// Teknik detaylarÄ± Ã§Ä±kar (regex ile)
// "150mm", "2.5 kg", "220V", "DÃ¶kÃ¼m Ã‡elik" gibi</div>
                </div>

                <div class="step branch-a">
                    <strong>A2. GPT-4 Prompt (GeniÅŸletme)</strong>
                    <div class="code">$prompt = "IMPROVE and EXPAND this existing product content for a forklift spare part.

PRODUCT: {$product->title['tr']}
CATEGORY: Yedek ParÃ§a

EXISTING CONTENT:
{$existingBody}

EXISTING SPECS:
{$extractedSpecs}

RULES:
âœ… KEEP all technical details (dimensions, materials, compatibility)
âœ… EXPAND descriptions with more context
âœ… ADD SEO keywords (forklift, yedek parÃ§a, onarÄ±m, servis, montaj)
âœ… Use Pattern v4 HTML structure
âŒ NEVER mention price
âœ… Bilingual output: TR + EN

OUTPUT FORMAT (JSON):
{
  \"title\": {\"tr\": \"...\", \"en\": \"...\"},
  \"short_description\": {\"tr\": \"...\", \"en\": \"...\"},
  \"primary_specs\": [
    {\"label\": \"Malzeme\", \"value\": \"DÃ¶kÃ¼m Ã‡elik\"},
    {\"label\": \"Uyumluluk\", \"value\": \"Forklift Arka Dingil\"}
  ],
  \"body\": {
    \"tr\": \"<section class='mb-20'>...</section>\",
    \"en\": \"<section class='mb-20'>...</section>\"
  },
  \"faq_data\": [
    {\"question\": \"...\", \"answer\": \"...\"}
  ],
  \"tags\": [\"forklift\", \"yedek parÃ§a\", \"akson kapaÄŸÄ±\"]
}"</div>
                </div>

                <div class="step branch-a">
                    <strong>A3. Leonardo AI GÃ¶rseller (2 adet)</strong>
                    <div class="code">// Foto 1: KullanÄ±m ortamÄ±
$prompt1 = "Industrial workshop scene, forklift spare part installation,
mechanic hands assembling parts, professional lighting, realistic photo";

// Foto 2: Teknik Ã§izim (blueprint)
$prompt2 = "Technical blueprint drawing, forklift axle component diagram,
engineering schematic, white background, clean lines";

// Her ikisi de: 1024x1024, cinematic style</div>
                </div>

                <h3 style="color: #fca5a5; margin-top: 30px;">ğŸ”´ BRANCH B - Mevcut Ä°Ã§erik Yoksa</h3>

                <div class="step branch-b">
                    <strong>B1. Sadece baÅŸlÄ±k + kategori al</strong>
                    <div class="code">$basicInfo = [
    'title' => $product->title,
    'category' => $product->category->title,
];

// BaÅŸka BÄ°LGÄ° YOK! Teknik detay yok!</div>
                </div>

                <div class="step branch-b">
                    <strong>B2. GPT-4 Prompt (GÃ¼venli Mod)</strong>
                    <div class="code">$prompt = "CREATE GENERAL product description for a forklift spare part.

PRODUCT: {$product->title['tr']}
CATEGORY: Yedek ParÃ§a

âš ï¸ CRITICAL RULES:
âŒ NO specific dimensions/weight/voltage
âŒ NO price information
âŒ NO exact technical specifications
âœ… Use general phrases: 'Detaylar iÃ§in arayÄ±n', 'Forklift modelinize uyumlu', 'Profesyonel montaj Ã¶nerilir'
âœ… Focus on: quality, reliability, OEM standards
âœ… SEO keywords (forklift, yedek parÃ§a, onarÄ±m)
âœ… Pattern v4 HTML structure
âœ… Bilingual: TR + EN

OUTPUT FORMAT (same JSON as Branch A, but with general content)"</div>
                </div>

                <div class="step branch-b">
                    <strong>B3. Leonardo AI GÃ¶rseller (2 adet)</strong>
                    <div class="code">// AynÄ± strateji (context gÃ¶rseller, exact product deÄŸil)</div>
                </div>

                <div class="step" style="margin-top: 30px;">
                    <strong>3. VALIDATION (Her iki branch iÃ§in)</strong>
                    <div class="code">// Fiyat kontrolÃ¼
if (preg_match('/\d+\s*(TL|USD|\$|â‚¬|lira|dolar)/i', $content)) {
    throw new Exception('Content contains price!');
}

// Branch B iÃ§in teknik detay kontrolÃ¼
if ($strategy === 'create') {
    if (preg_match('/\d+\s*(mm|cm|kg|volt|V|A)/i', $content)) {
        throw new Exception('New content should not have technical specs!');
    }
}</div>
                </div>

                <div class="step">
                    <strong>4. GÃ–RSELLER EMBED + SEO</strong>
                    <div class="code">// GÃ¶rselleri body iÃ§ine embed et
$imageTag = "&lt;a href='{$imageUrl}' class='glightbox'&gt;
    &lt;img src='{$imageUrl}'
         alt='Forklift {$product->title['tr']} Yedek ParÃ§a Montaj GÃ¶rseli'
         title='{$product->title['tr']} - OEM Kalite Forklift Yedek ParÃ§a'
         loading='lazy'
         class='w-full aspect-square rounded-xl object-cover'&gt;
&lt;/a&gt;";</div>
                </div>

                <div class="step">
                    <strong>5. DATABASE SAVE</strong>
                    <div class="code">$product->update([
    'title' => $aiContent['title'],
    'short_description' => $aiContent['short_description'],
    'body' => $aiContent['body'],
    'primary_specs' => $aiContent['primary_specs'],
    'faq_data' => $aiContent['faq_data'],
    'tags' => $aiContent['tags'],
]);

// Cache clear
Artisan::call('view:clear');
Artisan::call('responsecache:clear');</div>
                </div>
            </div>
        </section>

        <!-- KRÄ°TÄ°K KURALLAR -->
        <section>
            <h2><i class="fas fa-exclamation-triangle"></i> KRÄ°TÄ°K KURALLAR</h2>

            <div class="block critical">
                <h3>ğŸš¨ KURAL 1: FÄ°YAT BÄ°LGÄ°SÄ° ASLA</h3>
                <p>HiÃ§bir durumda fiyat bilgisi verilmeyecek:</p>
                <ul>
                    <li>âŒ "500 TL", "1000 $", "100-500 TL arasÄ±"</li>
                    <li>âŒ "Ucuz", "Uygun fiyat", "Ekonomik"</li>
                    <li>âœ… "Fiyat iÃ§in arayÄ±n"</li>
                    <li>âœ… "GÃ¼ncel fiyat bilgisi iÃ§in iletiÅŸime geÃ§in"</li>
                </ul>
            </div>

            <div class="block critical">
                <h3>ğŸš¨ KURAL 2: TEKNÄ°K DETAY (KoÅŸullu)</h3>
                <table style="margin-top: 15px;">
                    <tr>
                        <th>Durum</th>
                        <th>Teknik Detay</th>
                    </tr>
                    <tr>
                        <td>Branch A (Mevcut VAR)</td>
                        <td>âœ… KULLAN - Mevcut teknik detaylarÄ± koruyup geniÅŸlet</td>
                    </tr>
                    <tr>
                        <td>Branch B (Mevcut YOK)</td>
                        <td>âŒ VERME - Spesifik boyut/aÄŸÄ±rlÄ±k/voltaj belirtme</td>
                    </tr>
                </table>
            </div>

            <div class="block critical">
                <h3>ğŸš¨ KURAL 3: GOOGLE SEO Ã–NCELÄ°KLÄ°</h3>
                <ul>
                    <li>âœ… Long-tail keywords: "forklift arka dingil yedek parÃ§a"</li>
                    <li>âœ… LSI keywords: bakÄ±m, onarÄ±m, servis, montaj, deÄŸiÅŸim</li>
                    <li>âœ… FAQ = Google arama sorgularÄ± formatÄ±nda</li>
                    <li>âœ… Alt/title tags gÃ¶rsellerde</li>
                </ul>
            </div>

            <div class="block critical">
                <h3>ğŸš¨ KURAL 4: GÃ–RSEL STRATEJÄ°SÄ°</h3>
                <ul>
                    <li>âŒ ÃœrÃ¼nÃ¼ birebir oluÅŸturma (AI hallucination riski!)</li>
                    <li>âœ… Foto 1: KullanÄ±m ortamÄ± (atÃ¶lye, montaj sahnesi)</li>
                    <li>âœ… Foto 2: SallantÄ±lÄ± teknik Ã§izim (blueprint style)</li>
                    <li>âœ… 1024x1024 square format</li>
                    <li>âœ… Cinematic veya realistic style</li>
                </ul>
            </div>
        </section>

        <!-- IMPLEMENTASYON DETAYLARI -->
        <section>
            <h2><i class="fas fa-code"></i> IMPLEMENTASYON DETAYLARI</h2>

            <div class="block">
                <h3>ğŸ“ Dosya YapÄ±sÄ±</h3>
                <div class="code">Modules/Shop/app/Services/
â”œâ”€â”€ ProductFilterService.php          â†’ ÃœrÃ¼n filtreleme
â”œâ”€â”€ ContentStrategyRouter.php         â†’ Branch A/B yÃ¶nlendirme
â”œâ”€â”€ ShopProductAIContentService.php   â†’ Ana AI service (updated)
â”œâ”€â”€ ContentValidator.php              â†’ Validation (updated)
â””â”€â”€ ShopProductImageGenerator.php     â†’ Leonardo AI gÃ¶rseller

Modules/Shop/app/Jobs/
â””â”€â”€ GenerateProductImagesJob.php      â†’ Queue job (gÃ¶rseller)

Modules/Shop/app/Livewire/Admin/
â””â”€â”€ ProductAIContentGenerator.php     â†’ Admin UI component</div>
            </div>

            <div class="block">
                <h3>ğŸ”§ ProductFilterService.php</h3>
                <div class="code">namespace Modules\Shop\App\Services;

class ProductFilterService
{
    public function isEligible(ShopProduct $product): bool
    {
        // Yedek parÃ§a kontrolÃ¼
        $isSparePartCategory = $product->category_id === 7 ||
                               $product->category->parent_id === 7;

        if (!$isSparePartCategory) {
            return false;
        }

        // Variant kontrolÃ¼
        if ($product->parent_product_id && $product->parent_product_id > 0) {
            return false;
        }

        return true;
    }

    public function getEligibleProducts(): Collection
    {
        return ShopProduct::where(function($q) {
                $q->where('category_id', 7)
                  ->orWhereHas('category', fn($q2) => $q2->where('parent_id', 7));
            })
            ->where(function($q) {
                $q->whereNull('parent_product_id')
                  ->orWhere('parent_product_id', 0);
            })
            ->get();
    }
}</div>
            </div>

            <div class="block">
                <h3>ğŸ”§ ContentStrategyRouter.php</h3>
                <div class="code">namespace Modules\Shop\App\Services;

class ContentStrategyRouter
{
    public function route(ShopProduct $product): string
    {
        $existingBody = $product->body['tr'] ?? '';
        $hasContent = strlen($existingBody) > 100;

        return $hasContent ? 'expand' : 'create';
    }

    public function extractExistingData(ShopProduct $product): array
    {
        $body = $product->body['tr'] ?? '';

        return [
            'body' => $product->body,
            'specs' => $this->extractTechnicalSpecs($body),
            'primary_specs' => $product->primary_specs,
            'faq_data' => $product->faq_data,
        ];
    }

    protected function extractTechnicalSpecs(string $body): array
    {
        // Regex patterns for:
        // - Dimensions: "150mm", "2.5 cm"
        // - Weight: "3 kg", "500g"
        // - Voltage: "220V", "24V"
        // - Material: "DÃ¶kÃ¼m Ã‡elik", "AlÃ¼minyum"

        preg_match_all('/\d+\s*(mm|cm|kg|g|V|volt)/i', $body, $matches);

        return $matches[0] ?? [];
    }
}</div>
            </div>

            <div class="block">
                <h3>ğŸ”§ ContentValidator.php</h3>
                <div class="code">namespace Modules\Shop\App\Services;

class ContentValidator
{
    public function validate(array $content, string $strategy): array
    {
        $errors = [];

        // Fiyat kontrolÃ¼ (HER ZAMAN)
        if ($this->containsPrice($content)) {
            $errors[] = 'Content contains price information';
        }

        // Teknik detay kontrolÃ¼ (SADECE Branch B)
        if ($strategy === 'create' && $this->containsTechnicalSpecs($content)) {
            $errors[] = 'New content should not contain specific technical specifications';
        }

        return $errors;
    }

    protected function containsPrice($content): bool
    {
        $text = json_encode($content);

        return preg_match('/\d+\s*(TL|USD|\$|â‚¬|lira|dolar|euro)/i', $text) ||
               preg_match('/(ucuz|pahalÄ±|uygun fiyat|ekonomik)/i', $text);
    }

    protected function containsTechnicalSpecs($content): bool
    {
        $text = json_encode($content);

        return preg_match('/\d+\s*(mm|cm|kg|g|volt|V|A|amper)/i', $text);
    }
}</div>
            </div>

            <div class="block">
                <h3>ğŸ¨ HTML Pattern v4 (Output Format)</h3>
                <div class="code">&lt;!-- Ä°Ã§erik YapÄ±sÄ± --&gt;
&lt;section class='mb-20'&gt;
    &lt;div class='grid md:grid-cols-2 gap-8 mb-12'&gt;
        &lt;!-- Sol: AÃ§Ä±klama --&gt;
        &lt;div&gt;
            &lt;p class='text-gray-700 dark:text-gray-300'&gt;...&lt;/p&gt;
        &lt;/div&gt;

        &lt;!-- SaÄŸ: GÃ¶rsel --&gt;
        &lt;a href='{imageUrl}' class='glightbox'&gt;
            &lt;img src='{imageUrl}' alt='...' loading='lazy'&gt;
        &lt;/a&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;section class='mb-20'&gt;
    &lt;h2 class='text-3xl font-bold mb-12 text-gray-900 dark:text-white'&gt;
        Neden Bu Yedek ParÃ§ayÄ± Tercih Etmelisiniz?
    &lt;/h2&gt;

    &lt;div class='grid md:grid-cols-3 gap-8'&gt;
        &lt;!-- Kartlar --&gt;
    &lt;/div&gt;
&lt;/section&gt;</div>
            </div>
        </section>

        <!-- TEST SENARYOLARI -->
        <section>
            <h2><i class="fas fa-vial"></i> TEST SENARYOLARI</h2>

            <div class="block success">
                <h3>âœ… Test 1: ÃœrÃ¼n Filtreleme</h3>
                <ul>
                    <li>Forklift Ã¼rÃ¼nÃ¼ seÃ§ â†’ Hata: "Sadece yedek parÃ§a kategorisi"</li>
                    <li>Variant Ã¼rÃ¼n seÃ§ â†’ Hata: "Variant Ã¼rÃ¼nler iÅŸlenmez"</li>
                    <li>Yedek parÃ§a ana Ã¼rÃ¼n â†’ âœ… Devam</li>
                </ul>
            </div>

            <div class="block success">
                <h3>âœ… Test 2: Branch A (Mevcut Ä°Ã§erik VAR)</h3>
                <ul>
                    <li>ÃœrÃ¼n: Body dolu (>100 char)</li>
                    <li>Kontrol: Teknik detaylar korundu mu?</li>
                    <li>Kontrol: Ä°Ã§erik geniÅŸledi mi?</li>
                    <li>Kontrol: Fiyat YOK mu?</li>
                </ul>
            </div>

            <div class="block success">
                <h3>âœ… Test 3: Branch B (Mevcut Ä°Ã§erik YOK)</h3>
                <ul>
                    <li>ÃœrÃ¼n: Body boÅŸ veya <100 char</li>
                    <li>Kontrol: Genel tanÄ±tÄ±m yapÄ±ldÄ± mÄ±?</li>
                    <li>Kontrol: Teknik detay YOK mu?</li>
                    <li>Kontrol: Fiyat YOK mu?</li>
                </ul>
            </div>
        </section>

        <!-- SQL SORGULARI -->
        <section>
            <h2><i class="fas fa-database"></i> SQL SORGULARI</h2>

            <div class="block">
                <h3>Yedek ParÃ§a Ana ÃœrÃ¼nlerini Bul</h3>
                <div class="code">-- Tenant database seÃ§
USE tenant_ixtif;

-- Yedek parÃ§a kategorisindeki ana Ã¼rÃ¼nler
SELECT
    p.product_id,
    p.title,
    p.category_id,
    c.title AS category_title,
    LENGTH(JSON_EXTRACT(p.body, '$.tr')) AS content_length
FROM shop_products p
JOIN shop_categories c ON p.category_id = c.category_id
WHERE (p.category_id = 7 OR c.parent_id = 7)
AND (p.parent_product_id IS NULL OR p.parent_product_id = 0);</div>
            </div>

            <div class="block">
                <h3>Mevcut Ä°Ã§erik Ä°statistikleri</h3>
                <div class="code">-- Branch A: Mevcut iÃ§eriÄŸi olanlar
SELECT COUNT(*) AS has_content
FROM shop_products p
WHERE (p.category_id = 7 OR EXISTS(
    SELECT 1 FROM shop_categories c
    WHERE c.category_id = p.category_id AND c.parent_id = 7
))
AND (p.parent_product_id IS NULL OR p.parent_product_id = 0)
AND LENGTH(JSON_EXTRACT(p.body, '$.tr')) > 100;

-- Branch B: Mevcut iÃ§eriÄŸi olmayanlar
SELECT COUNT(*) AS no_content
FROM shop_products p
WHERE (p.category_id = 7 OR EXISTS(
    SELECT 1 FROM shop_categories c
    WHERE c.category_id = p.category_id AND c.parent_id = 7
))
AND (p.parent_product_id IS NULL OR p.parent_product_id = 0)
AND (p.body IS NULL OR LENGTH(JSON_EXTRACT(p.body, '$.tr')) <= 100);</div>
            </div>
        </section>

        <!-- BAÅARI KRÄ°TERLERÄ° -->
        <section>
            <h2><i class="fas fa-trophy"></i> BAÅARI KRÄ°TERLERÄ°</h2>

            <div class="block success">
                <h3>âœ… Sistem BaÅŸarÄ±lÄ± SayÄ±lÄ±r EÄŸer:</h3>
                <ol>
                    <li>Sadece yedek parÃ§a kategorisi iÅŸleniyor</li>
                    <li>Variant Ã¼rÃ¼nler otomatik skip ediliyor</li>
                    <li>Mevcut iÃ§erik varsa (Branch A) teknik detaylar KORUNUYOR</li>
                    <li>Mevcut iÃ§erik yoksa (Branch B) genel tanÄ±tÄ±m yapÄ±lÄ±yor</li>
                    <li>HÄ°Ã‡BÄ°R ÃœRÃœNDE fiyat bilgisi YOK</li>
                    <li>Branch B Ã¼rÃ¼nlerinde spesifik teknik detay YOK</li>
                    <li>SEO keywords her Ã¼rÃ¼nde mevcut</li>
                    <li>GÃ¶rseller context saÄŸlÄ±yor (exact product deÄŸil)</li>
                    <li>GLightbox + SEO tags Ã§alÄ±ÅŸÄ±yor</li>
                    <li>Validation tÃ¼m kurallara uyuyor</li>
                </ol>
            </div>
        </section>

        <footer>
            ğŸ¤– Implementation Prompt - Shop Product AI Content System<br>
            ğŸ“… 2025-11-27 | ğŸ¯ v4 - Final Prompt Format
        </footer>
    </div>
</body>
</html>