<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subscription Sistemi - ULTIMATE KILAVUZ v2</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-slate-900 via-indigo-900 to-slate-900 text-slate-100 min-h-screen">
    <div class="max-w-7xl mx-auto px-6 py-12">
        <!-- Header -->
        <header class="mb-16 pb-8 border-b-2 border-emerald-500">
            <div class="flex items-center gap-4 mb-4">
                <h1 class="text-5xl font-black bg-gradient-to-r from-emerald-400 via-blue-400 to-purple-400 bg-clip-text text-transparent">
                    ğŸ“š Subscription Sistemi
                </h1>
                <span class="px-4 py-2 bg-gradient-to-r from-emerald-600 to-green-600 text-white font-bold rounded-full shadow-lg">
                    ULTIMATE KILAVUZ v2
                </span>
            </div>
            <p class="text-slate-300 text-xl mb-4">TÃ¼m Bilgiler Tek Sayfada - Master Plan + Settings + KullanÄ±cÄ± DurumlarÄ± + Device Hierarchy</p>
            <div class="mt-4 flex flex-wrap gap-4 text-sm text-slate-400">
                <span>ğŸ“… 2025-12-05</span>
                <span>ğŸ¯ Basit & Net & Minimal</span>
                <span>âœ… Production Ready</span>
                <span>ğŸ”¥ v2: Trial Plan Dinamik</span>
            </div>
        </header>

        <!-- V2 DEÄÄ°ÅÄ°KLÄ°KLER -->
        <section class="mb-16">
            <div class="bg-gradient-to-r from-red-900/40 to-orange-900/40 border-2 border-orange-500 rounded-xl p-8">
                <h2 class="text-3xl font-bold mb-6 text-orange-400">ğŸ†• v2 DeÄŸiÅŸiklikler (Trial Plan Dinamik)</h2>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-slate-900/50 rounded-lg p-6 border border-red-700/50">
                        <h3 class="text-red-400 font-bold mb-4 text-lg">âŒ v1 (YANLIÅ)</h3>
                        <ul class="space-y-2 text-sm text-slate-300">
                            <li>âŒ "7 gÃ¼n sabit" ifadesi</li>
                            <li>âŒ Trial her zaman otomatik baÅŸlar</li>
                            <li>âŒ Hardcode 7 gÃ¼n</li>
                        </ul>
                    </div>

                    <div class="bg-slate-900/50 rounded-lg p-6 border border-green-700/50">
                        <h3 class="text-green-400 font-bold mb-4 text-lg">âœ… v2 (DOÄRU)</h3>
                        <ul class="space-y-2 text-sm text-slate-300">
                            <li>âœ… Trial plan yoksa â†’ Trial YOK!</li>
                            <li>âœ… Trial sÃ¼resi â†’ Plan cycle'dan (7, 14, 30 gÃ¼n olabilir)</li>
                            <li>âœ… Trial plan'da TEK cycle olacak</li>
                        </ul>
                    </div>
                </div>

                <div class="mt-6 bg-blue-900/30 rounded-lg p-4 border border-blue-700/50">
                    <p class="text-blue-400 font-bold mb-2">ğŸ’¡ Kritik:</p>
                    <p class="text-slate-300"><code class="bg-slate-800 px-2 py-1 rounded">is_trial=true</code> olan plan YOKSA trial sistemi devreye GÄ°RMEZ! Plan varsa cycle'daki gÃ¼n sayÄ±sÄ± trial sÃ¼residir.</p>
                </div>
            </div>
        </section>

        <!-- Ä°Ã‡Ä°NDEKÄ°LER -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-purple-400">ğŸ“‘ Ä°Ã§indekiler</h2>
            
            <div class="grid md:grid-cols-3 gap-4">
                <a href="#master-plan" class="bg-slate-800/50 hover:bg-slate-800 rounded-lg p-6 border border-emerald-700/50 transition">
                    <h3 class="text-lg font-bold text-emerald-400 mb-2">1ï¸âƒ£ ULTIMATE Master Plan</h3>
                    <p class="text-slate-400 text-sm">Stratejik kararlar + Settings yaklaÅŸÄ±mÄ±</p>
                </a>

                <a href="#settings" class="bg-slate-800/50 hover:bg-slate-800 rounded-lg p-6 border border-purple-700/50 transition">
                    <h3 class="text-lg font-bold text-purple-400 mb-2">2ï¸âƒ£ Settings (2 Ayar)</h3>
                    <p class="text-slate-400 text-sm">auth_subscription, auth_device_limit</p>
                </a>

                <a href="#hardcode" class="bg-slate-800/50 hover:bg-slate-800 rounded-lg p-6 border border-blue-700/50 transition">
                    <h3 class="text-lg font-bold text-blue-400 mb-2">3ï¸âƒ£ Hardcode DeÄŸerler</h3>
                    <p class="text-slate-400 text-sm">30 saniye preview</p>
                </a>

                <a href="#trial-plan" class="bg-slate-800/50 hover:bg-slate-800 rounded-lg p-6 border border-orange-700/50 transition">
                    <h3 class="text-lg font-bold text-orange-400 mb-2">ğŸ†• Trial Plan Sistemi</h3>
                    <p class="text-slate-400 text-sm">is_trial plan + dinamik sÃ¼re</p>
                </a>

                <a href="#user-states" class="bg-slate-800/50 hover:bg-slate-800 rounded-lg p-6 border border-green-700/50 transition">
                    <h3 class="text-lg font-bold text-green-400 mb-2">4ï¸âƒ£ KullanÄ±cÄ± DurumlarÄ±</h3>
                    <p class="text-slate-400 text-sm">Guest, Trial, Premium, Expired</p>
                </a>

                <a href="#device-hierarchy" class="bg-slate-800/50 hover:bg-slate-800 rounded-lg p-6 border border-cyan-700/50 transition">
                    <h3 class="text-lg font-bold text-cyan-400 mb-2">5ï¸âƒ£ Device Hierarchy</h3>
                    <p class="text-slate-400 text-sm">User â†’ Plan â†’ Setting</p>
                </a>

                <a href="#quick-summary" class="bg-slate-800/50 hover:bg-slate-800 rounded-lg p-6 border border-yellow-700/50 transition">
                    <h3 class="text-lg font-bold text-yellow-400 mb-2">âš¡ HÄ±zlÄ± Ã–zet</h3>
                    <p class="text-slate-400 text-sm">TÃ¼m Ã¶nemli noktalar tek bakÄ±ÅŸta</p>
                </a>
            </div>
        </section>

        <!-- 1. ULTIMATE MASTER PLAN -->
        <section id="master-plan" class="mb-16">
            <h2 class="text-4xl font-bold mb-8 text-emerald-400">1ï¸âƒ£ ULTIMATE Master Plan</h2>
            
            <!-- Stratejik Kararlar -->
            <div class="bg-blue-900/20 border border-blue-700/50 rounded-xl p-8 mb-8">
                <h3 class="text-2xl font-bold text-blue-400 mb-6">ğŸ¯ Stratejik Kararlar</h3>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-slate-900/50 rounded-lg p-6">
                        <h4 class="text-lg font-bold text-green-400 mb-4">âœ… Kabul Edilen Kararlar</h4>
                        <ul class="space-y-2 text-sm text-slate-300">
                            <li>âœ… Trial plan varsa otomatik baÅŸlar</li>
                            <li>âœ… Trial sÃ¼resi â†’ Plan cycle'dan (dinamik)</li>
                            <li>âœ… is_trial checkbox (slug deÄŸil)</li>
                            <li>âœ… has_used_trial kontrolÃ¼ (tek kullanÄ±m)</li>
                            <li>âœ… 30 saniye preview (hardcode)</li>
                            <li>âœ… Request-level fresh check (cache yok)</li>
                            <li>âœ… Event-based system (Observer pattern)</li>
                            <li>âœ… Hibrit sistem (Lazy + Cron)</li>
                        </ul>
                    </div>

                    <div class="bg-slate-900/50 rounded-lg p-6">
                        <h4 class="text-lg font-bold text-purple-400 mb-4">ğŸ”§ Teknik Mimari</h4>
                        <ul class="space-y-2 text-sm text-slate-300">
                            <li>ğŸ“¦ SubscriptionService (core logic)</li>
                            <li>ğŸ”” Event System (SubscriptionExpired vb.)</li>
                            <li>â±ï¸ Cron Job (expire check, daily)</li>
                            <li>ğŸ¯ Request-level check (stale Ã¶nleme)</li>
                            <li>ğŸ—„ï¸ Database: 18 field (unified)</li>
                            <li>ğŸ” SettingsManagement (tenant-aware)</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Settings YaklaÅŸÄ±mÄ± -->
            <div class="bg-gradient-to-r from-emerald-900/40 to-green-900/40 border-2 border-emerald-500 rounded-xl p-8">
                <h3 class="text-2xl font-bold text-emerald-400 mb-6">ğŸ“‹ Settings YaklaÅŸÄ±mÄ±</h3>
                
                <div class="grid md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-red-900/20 border border-red-700 rounded-lg p-6">
                        <p class="text-red-400 font-bold mb-3">âŒ Reddedilen: tenants.data JSON</p>
                        <ul class="text-sm text-slate-300 space-y-2">
                            <li>â€¢ Duplicate Ã§Ã¶zÃ¼m</li>
                            <li>â€¢ SettingsManagement zaten var</li>
                            <li>â€¢ Tenant-aware deÄŸil</li>
                        </ul>
                    </div>

                    <div class="bg-green-900/20 border border-green-700 rounded-lg p-6">
                        <p class="text-green-400 font-bold mb-3">âœ… Kabul: SettingsManagement</p>
                        <ul class="text-sm text-slate-300 space-y-2">
                            <li>â€¢ Bu iÅŸ iÃ§in tasarlanmÄ±ÅŸ</li>
                            <li>â€¢ 3-layer system</li>
                            <li>â€¢ Tenant-aware otomatik</li>
                            <li>â€¢ Admin UI hazÄ±r</li>
                        </ul>
                    </div>
                </div>

                <div class="bg-blue-900/30 rounded-lg p-6 border border-blue-700/50">
                    <p class="text-blue-400 font-bold mb-3">ğŸ’¡ 3-Layer System</p>
                    <ul class="space-y-2 text-slate-300 text-sm">
                        <li>1ï¸âƒ£ <strong>settings_groups</strong> (CENTRAL DB) â†’ Grup tanÄ±mÄ±</li>
                        <li>2ï¸âƒ£ <strong>settings</strong> (CENTRAL DB) â†’ Setting tanÄ±mÄ± + default_value</li>
                        <li>3ï¸âƒ£ <strong>settings_values</strong> (TENANT DB) â†’ Tenant'a Ã¶zel deÄŸer</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- 2. SETTINGS -->
        <section id="settings" class="mb-16">
            <h2 class="text-4xl font-bold mb-8 text-purple-400">2ï¸âƒ£ Settings (SADECE 2 AYAR - Minimal YaklaÅŸÄ±m)</h2>
            
            <div class="space-y-8">
                <!-- auth_subscription -->
                <div class="bg-gradient-to-r from-emerald-900/40 to-green-900/40 border-2 border-emerald-500 rounded-xl p-8">
                    <div class="flex items-start gap-4 mb-6">
                        <span class="w-14 h-14 bg-emerald-600 text-white rounded-full flex items-center justify-center font-bold text-2xl flex-shrink-0">1</span>
                        <div class="flex-1">
                            <h3 class="text-3xl font-bold text-emerald-400 mb-3">auth_subscription</h3>
                            <p class="text-slate-300 text-lg">Ãœcretli Ãœyelik Sistemi (Ana Anahtar - Trial Dahil)</p>
                        </div>
                    </div>

                    <div class="grid md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-slate-900/50 rounded-lg p-4">
                            <p class="text-xs text-slate-400 mb-2">Setting ID</p>
                            <p class="text-white font-bold text-lg">211</p>
                        </div>
                        <div class="bg-slate-900/50 rounded-lg p-4">
                            <p class="text-xs text-slate-400 mb-2">Type</p>
                            <p class="text-white font-bold text-lg">select</p>
                        </div>
                        <div class="bg-slate-900/50 rounded-lg p-4">
                            <p class="text-xs text-slate-400 mb-2">Values</p>
                            <p class="text-white font-bold text-lg">0 / 1</p>
                        </div>
                        <div class="bg-slate-900/50 rounded-lg p-4">
                            <p class="text-xs text-slate-400 mb-2">Muzibu Status</p>
                            <p class="text-green-400 font-bold text-lg">1 (AKTÄ°F)</p>
                        </div>
                    </div>

                    <div class="bg-slate-900/50 rounded-lg p-6 mb-4">
                        <h4 class="text-white font-bold mb-4 text-lg">ğŸ“‹ Ne Yapar?</h4>
                        <ul class="space-y-3 text-slate-300">
                            <li class="flex items-start gap-3">
                                <span class="text-emerald-400 text-xl">âœ…</span>
                                <span><strong>1 (AÃ§Ä±k):</strong> Subscription modÃ¼lÃ¼ aktif â†’ Trial plan varsa otomatik baÅŸlar, Premium kontrolleri Ã§alÄ±ÅŸÄ±r</span>
                            </li>
                            <li class="flex items-start gap-3">
                                <span class="text-red-400 text-xl">âŒ</span>
                                <span><strong>0 (KapalÄ±):</strong> Subscription modÃ¼lÃ¼ tamamen kapalÄ± â†’ Herkes sÄ±nÄ±rsÄ±z kullanÄ±r (free model)</span>
                            </li>
                        </ul>
                    </div>

                    <div class="bg-orange-900/30 rounded-lg p-4 border border-orange-700/50">
                        <p class="text-orange-400 font-bold mb-2">ğŸ”¥ v2 Ã–nemli DeÄŸiÅŸiklik:</p>
                        <p class="text-slate-300">Bu ayar 1 OLSA BÄ°LE trial planÄ± yoksa trial baÅŸlamaz! Trial plan (<code class="bg-slate-800 px-2 py-1 rounded">is_trial=true</code>) olmalÄ±.</p>
                    </div>
                </div>

                <!-- auth_device_limit -->
                <div class="bg-gradient-to-r from-blue-900/40 to-cyan-900/40 border-2 border-blue-500 rounded-xl p-8">
                    <div class="flex items-start gap-4 mb-6">
                        <span class="w-14 h-14 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-2xl flex-shrink-0">2</span>
                        <div class="flex-1">
                            <h3 class="text-3xl font-bold text-blue-400 mb-3">auth_device_limit</h3>
                            <p class="text-slate-300 text-lg">Cihaz Limit KontrolÃ¼ (Global Fallback)</p>
                        </div>
                    </div>

                    <div class="grid md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-slate-900/50 rounded-lg p-4">
                            <p class="text-xs text-slate-400 mb-2">Setting ID</p>
                            <p class="text-white font-bold text-lg">212</p>
                        </div>
                        <div class="bg-slate-900/50 rounded-lg p-4">
                            <p class="text-xs text-slate-400 mb-2">Type</p>
                            <p class="text-white font-bold text-lg">number</p>
                        </div>
                        <div class="bg-slate-900/50 rounded-lg p-4">
                            <p class="text-xs text-slate-400 mb-2">Default</p>
                            <p class="text-white font-bold text-lg">1</p>
                        </div>
                        <div class="bg-slate-900/50 rounded-lg p-4">
                            <p class="text-xs text-slate-400 mb-2">Ã–nerilen</p>
                            <p class="text-yellow-400 font-bold text-lg">1-3 arasÄ±</p>
                        </div>
                    </div>

                    <div class="bg-slate-900/50 rounded-lg p-6 mb-4">
                        <h4 class="text-white font-bold mb-4 text-lg">ğŸ“‹ Ne Yapar?</h4>
                        <ul class="space-y-3 text-slate-300">
                            <li class="flex items-start gap-3">
                                <span class="text-blue-400 text-xl">ğŸ“±</span>
                                <span><strong>Global Fallback:</strong> User ve Plan'da device_limit yoksa bu deÄŸer kullanÄ±lÄ±r (son Ã§are)</span>
                            </li>
                            <li class="flex items-start gap-3">
                                <span class="text-purple-400 text-xl">ğŸ”¢</span>
                                <span><strong>3-Layer HierarÅŸi:</strong> <code class="bg-slate-800 px-2 py-1 rounded">user.device_limit</code> â†’ <code class="bg-slate-800 px-2 py-1 rounded">plan.device_limit</code> â†’ <code class="bg-slate-800 px-2 py-1 rounded text-blue-400">auth_device_limit (setting)</code></span>
                            </li>
                        </ul>
                    </div>

                    <div class="bg-cyan-900/30 rounded-lg p-4 border border-cyan-700/50">
                        <p class="text-cyan-400 font-bold mb-2">ğŸ’¡ DetaylÄ± Bilgi:</p>
                        <p class="text-slate-300">DetaylÄ± hiyerarÅŸi iÃ§in <a href="#device-hierarchy" class="text-cyan-400 underline hover:text-cyan-300">Device Limit Hierarchy</a> bÃ¶lÃ¼mÃ¼ne bak</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 3. HARDCODE DEÄERLER -->
        <section id="hardcode" class="mb-16">
            <h2 class="text-4xl font-bold mb-8 text-blue-400">3ï¸âƒ£ Hardcode DeÄŸerler (SADECE 30 SANÄ°YE)</h2>
            
            <div class="bg-gradient-to-r from-purple-900/30 to-pink-900/30 border border-purple-700/50 rounded-xl p-8">
                <div class="flex items-start gap-4">
                    <span class="text-5xl">ğŸµ</span>
                    <div class="flex-1">
                        <h3 class="text-2xl font-bold text-purple-400 mb-3">30 Saniye Preview Duration</h3>
                        <p class="text-slate-300 mb-4">Abonelik yoksa veya biterse mÃ¼zik 30 saniye Ã§alÄ±ÅŸÄ±r (Guest & Expired kullanÄ±cÄ±lar)</p>
                        
                        <div class="bg-slate-900/50 rounded-lg p-4 font-mono text-sm text-green-400 mb-4">
const PREVIEW_DURATION = 30; // saniye
                        </div>

                        <div class="bg-green-900/30 rounded-lg p-4 border border-green-700/50">
                            <p class="text-green-400 font-bold mb-2">âœ… Neden Hardcode?</p>
                            <p class="text-slate-300 text-sm">Bu deÄŸer deÄŸiÅŸmeyecek, ayar olarak yÃ¶netmeye gerek yok. KullanÄ±cÄ±: "muzibu 30 saniye kuralÄ± kalÄ±cÄ± deÄŸiÅŸtirmeye gerek yok. hardcode olsun"</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-8 bg-orange-900/30 rounded-lg p-6 border border-orange-700/50">
                <h3 class="text-xl font-bold text-orange-400 mb-4">ğŸ”¥ v2: Ã‡Ä±karÄ±lan Hardcode'lar</h3>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <p class="text-red-400 font-bold mb-2">âŒ "7 gÃ¼n trial" (v1'de vardÄ±)</p>
                        <p class="text-slate-300 text-sm">ArtÄ±k hardcode deÄŸil, trial plan'Ä±n cycle'Ä±ndan gelir (dinamik)</p>
                    </div>
                    <div>
                        <p class="text-red-400 font-bold mb-2">âŒ "Otomatik trial baÅŸlatma" (v1'de vardÄ±)</p>
                        <p class="text-slate-300 text-sm">Trial plan varsa baÅŸlar, yoksa baÅŸlamaz (koÅŸullu)</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- TRIAL PLAN SÄ°STEMÄ° (YENÄ° BÃ–LÃœM) -->
        <section id="trial-plan" class="mb-16">
            <h2 class="text-4xl font-bold mb-8 text-orange-400">ğŸ†• Trial Plan Sistemi (v2)</h2>
            
            <div class="bg-gradient-to-r from-orange-900/40 to-red-900/40 border-2 border-orange-500 rounded-xl p-8 mb-8">
                <h3 class="text-2xl font-bold text-orange-400 mb-6">ğŸ¯ NasÄ±l Ã‡alÄ±ÅŸÄ±r?</h3>
                
                <div class="space-y-6">
                    <div class="bg-slate-900/50 rounded-lg p-6">
                        <h4 class="text-white font-bold mb-4 text-lg">1ï¸âƒ£ Trial Plan KontrolÃ¼</h4>
                        <div class="bg-slate-900 rounded-lg p-4 font-mono text-sm text-green-400 mb-4">
$trialPlan = SubscriptionPlan::where('is_trial', true)<br>
&nbsp;&nbsp;->where('is_active', true)<br>
&nbsp;&nbsp;->first();<br>
<br>
if (!$trialPlan) {<br>
&nbsp;&nbsp;// Trial sistemi yok, direkt return<br>
&nbsp;&nbsp;return null;<br>
}
                        </div>
                        <p class="text-slate-300 text-sm"><strong>Kritik:</strong> <code class="bg-slate-800 px-2 py-1 rounded">is_trial=true</code> olan plan yoksa trial sistemi Ã§alÄ±ÅŸmaz!</p>
                    </div>

                    <div class="bg-slate-900/50 rounded-lg p-6">
                        <h4 class="text-white font-bold mb-4 text-lg">2ï¸âƒ£ Trial SÃ¼resi Hesaplama</h4>
                        <div class="bg-slate-900 rounded-lg p-4 font-mono text-sm text-blue-400 mb-4">
$cycles = $trialPlan->billing_cycles; // JSON decode<br>
$firstCycle = array_values($cycles)[0];<br>
$trialDays = $firstCycle['duration_days']; // 7, 14, 30 vs.
                        </div>
                        <p class="text-slate-300 text-sm"><strong>Dinamik:</strong> Trial plan'Ä±n cycle'Ä±nda yazÄ±lan gÃ¼n sayÄ±sÄ± kullanÄ±lÄ±r (7, 14, 30 olabilir)</p>
                    </div>

                    <div class="bg-slate-900/50 rounded-lg p-6">
                        <h4 class="text-white font-bold mb-4 text-lg">3ï¸âƒ£ Trial Plan YapÄ±sÄ± (Ã–rnek JSON)</h4>
                        <div class="bg-slate-900 rounded-lg p-4 font-mono text-sm text-purple-400 overflow-x-auto">
{<br>
&nbsp;&nbsp;"subscription_plan_id": 1,<br>
&nbsp;&nbsp;"title": {"tr": "Deneme", "en": "Trial"},<br>
&nbsp;&nbsp;"slug": "deneme",<br>
&nbsp;&nbsp;"is_trial": true,<br>
&nbsp;&nbsp;"is_active": true,<br>
&nbsp;&nbsp;"billing_cycles": {<br>
&nbsp;&nbsp;&nbsp;&nbsp;"deneme-7-gun": {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"name": {"tr": "7 GÃ¼nlÃ¼k Deneme"},<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"duration_days": 7,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"price": 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;}<br>
}
                        </div>
                        <p class="text-slate-300 text-sm mt-4"><strong>Ã–nemli:</strong> Trial plan'da SADECE 1 cycle olmalÄ± (deneme sÃ¼resi)</p>
                    </div>
                </div>
            </div>

            <!-- Ã–rnekler -->
            <div>
                <h3 class="text-2xl font-bold text-orange-400 mb-6">ğŸ“ Ã–rnek Senaryolar</h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-slate-900/50 rounded-lg p-6 border border-green-700/50">
                        <h4 class="text-green-400 font-bold mb-4">âœ… Trial Plan Var (7 gÃ¼n)</h4>
                        <div class="space-y-2 text-sm">
                            <p><span class="text-slate-400">is_trial:</span> <span class="text-green-400 font-bold">true</span></p>
                            <p><span class="text-slate-400">cycle duration_days:</span> <span class="text-green-400 font-bold">7</span></p>
                            <p class="pt-2 border-t border-slate-700"><span class="text-white font-bold">SONUÃ‡:</span> <span class="text-green-400 font-bold">7 gÃ¼n trial verilir</span></p>
                        </div>
                    </div>

                    <div class="bg-slate-900/50 rounded-lg p-6 border border-blue-700/50">
                        <h4 class="text-blue-400 font-bold mb-4">âœ… Trial Plan Var (14 gÃ¼n)</h4>
                        <div class="space-y-2 text-sm">
                            <p><span class="text-slate-400">is_trial:</span> <span class="text-blue-400 font-bold">true</span></p>
                            <p><span class="text-slate-400">cycle duration_days:</span> <span class="text-blue-400 font-bold">14</span></p>
                            <p class="pt-2 border-t border-slate-700"><span class="text-white font-bold">SONUÃ‡:</span> <span class="text-blue-400 font-bold">14 gÃ¼n trial verilir</span></p>
                        </div>
                    </div>

                    <div class="bg-slate-900/50 rounded-lg p-6 border border-red-700/50">
                        <h4 class="text-red-400 font-bold mb-4">âŒ Trial Plan Yok</h4>
                        <div class="space-y-2 text-sm">
                            <p><span class="text-slate-400">is_trial=true plan:</span> <span class="text-red-400 font-bold">BULUNAMADI</span></p>
                            <p><span class="text-slate-400">auth_subscription:</span> <span class="text-green-400">1 (aÃ§Ä±k olsa bile)</span></p>
                            <p class="pt-2 border-t border-slate-700"><span class="text-white font-bold">SONUÃ‡:</span> <span class="text-red-400 font-bold">Trial sistemi YOK</span></p>
                        </div>
                    </div>

                    <div class="bg-slate-900/50 rounded-lg p-6 border border-purple-700/50">
                        <h4 class="text-purple-400 font-bold mb-4">âœ… Trial Plan Var (30 gÃ¼n)</h4>
                        <div class="space-y-2 text-sm">
                            <p><span class="text-slate-400">is_trial:</span> <span class="text-purple-400 font-bold">true</span></p>
                            <p><span class="text-slate-400">cycle duration_days:</span> <span class="text-purple-400 font-bold">30</span></p>
                            <p class="pt-2 border-t border-slate-700"><span class="text-white font-bold">SONUÃ‡:</span> <span class="text-purple-400 font-bold">30 gÃ¼n trial verilir</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4. KULLANICI DURUMLARI -->
        <section id="user-states" class="mb-16">
            <h2 class="text-4xl font-bold mb-8 text-green-400">4ï¸âƒ£ KullanÄ±cÄ± DurumlarÄ± (4 Durum)</h2>
            
            <div class="space-y-6">
                <!-- GUEST -->
                <div class="bg-gradient-to-r from-slate-900/40 to-slate-800/40 border-2 border-slate-500 rounded-xl p-6">
                    <div class="flex items-center gap-4 mb-4">
                        <span class="w-14 h-14 bg-slate-600 text-white rounded-full flex items-center justify-center font-bold text-2xl">ğŸ‘¤</span>
                        <div>
                            <h3 class="text-2xl font-bold text-slate-300">GUEST (Misafir)</h3>
                            <p class="text-slate-400">KayÄ±t olmamÄ±ÅŸ, siteyi gezinen kullanÄ±cÄ±</p>
                        </div>
                    </div>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-slate-900/50 rounded p-4">
                            <p class="text-white font-bold mb-2">Dinleme:</p>
                            <p class="text-yellow-400 text-2xl font-bold">30 saniye</p>
                        </div>
                        <div class="bg-slate-900/50 rounded p-4">
                            <p class="text-white font-bold mb-2">Ã–zellikler:</p>
                            <p class="text-red-400">Playlist âŒ | Favori âŒ</p>
                        </div>
                        <div class="bg-slate-900/50 rounded p-4">
                            <p class="text-white font-bold mb-2">CTA:</p>
                            <p class="text-blue-400">"SÄ±nÄ±rsÄ±z dinlemek iÃ§in Ã¼ye ol!"</p>
                        </div>
                    </div>
                </div>

                <!-- TRIAL -->
                <div class="bg-gradient-to-r from-green-900/40 to-emerald-900/40 border-2 border-green-500 rounded-xl p-6">
                    <div class="flex items-center gap-4 mb-4">
                        <span class="w-14 h-14 bg-green-600 text-white rounded-full flex items-center justify-center font-bold text-2xl">ğŸ†“</span>
                        <div>
                            <h3 class="text-2xl font-bold text-green-400">TRIAL (Deneme Ãœyesi)</h3>
                            <p class="text-slate-300">Yeni kayÄ±t, trial plan sÃ¼resince deneme (7-30 gÃ¼n)</p>
                        </div>
                    </div>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-slate-900/50 rounded p-4">
                            <p class="text-white font-bold mb-2">Dinleme:</p>
                            <p class="text-green-400 text-2xl font-bold">SÄ±nÄ±rsÄ±z (X gÃ¼n)</p>
                        </div>
                        <div class="bg-slate-900/50 rounded p-4">
                            <p class="text-white font-bold mb-2">Ã–zellikler:</p>
                            <p class="text-green-400">Playlist âœ… | Favori âœ…</p>
                        </div>
                        <div class="bg-slate-900/50 rounded p-4">
                            <p class="text-white font-bold mb-2">CTA:</p>
                            <p class="text-yellow-400">"X gÃ¼n kaldÄ±, Premium'a geÃ§!"</p>
                        </div>
                    </div>
                    <div class="mt-4 bg-orange-900/30 rounded-lg p-4 border border-orange-700/50">
                        <p class="text-orange-400 font-bold mb-2">ğŸ”¥ v2: Dinamik SÃ¼re</p>
                        <p class="text-slate-300 text-sm">Trial sÃ¼resi trial plan'Ä±n cycle'Ä±ndaki <code class="bg-slate-800 px-2 py-1 rounded">duration_days</code> deÄŸeridir (7, 14, 30 vs.)</p>
                    </div>
                </div>

                <!-- PREMIUM -->
                <div class="bg-gradient-to-r from-purple-900/40 to-pink-900/40 border-2 border-purple-500 rounded-xl p-6">
                    <div class="flex items-center gap-4 mb-4">
                        <span class="w-14 h-14 bg-purple-600 text-white rounded-full flex items-center justify-center font-bold text-2xl">ğŸ‘‘</span>
                        <div>
                            <h3 class="text-2xl font-bold text-purple-400">PREMIUM (Ãœcretli Ãœye)</h3>
                            <p class="text-slate-300">Ã–deme yapmÄ±ÅŸ, aktif premium aboneliÄŸi var</p>
                        </div>
                    </div>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-slate-900/50 rounded p-4">
                            <p class="text-white font-bold mb-2">Dinleme:</p>
                            <p class="text-purple-400 text-2xl font-bold">SÄ±nÄ±rsÄ±z (Ã–mÃ¼r boyu)</p>
                        </div>
                        <div class="bg-slate-900/50 rounded p-4">
                            <p class="text-white font-bold mb-2">Ã–zellikler:</p>
                            <p class="text-purple-400">TÃœM Ã–zellikler âœ…</p>
                        </div>
                        <div class="bg-slate-900/50 rounded p-4">
                            <p class="text-white font-bold mb-2">CTA:</p>
                            <p class="text-blue-400">"Premium Ã¼yesiniz, keyifle dinleyin!"</p>
                        </div>
                    </div>
                </div>

                <!-- EXPIRED -->
                <div class="bg-gradient-to-r from-red-900/40 to-rose-900/40 border-2 border-red-500 rounded-xl p-6">
                    <div class="flex items-center gap-4 mb-4">
                        <span class="w-14 h-14 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-2xl">â°</span>
                        <div>
                            <h3 class="text-2xl font-bold text-red-400">EXPIRED (SÃ¼resi BitmiÅŸ)</h3>
                            <p class="text-slate-300">Trial veya Premium sÃ¼resi dolmuÅŸ, Ã¶deme yapÄ±lmamÄ±ÅŸ</p>
                        </div>
                    </div>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-slate-900/50 rounded p-4">
                            <p class="text-white font-bold mb-2">Dinleme:</p>
                            <p class="text-yellow-400 text-2xl font-bold">30 saniye</p>
                        </div>
                        <div class="bg-slate-900/50 rounded p-4">
                            <p class="text-white font-bold mb-2">Ã–zellikler:</p>
                            <p class="text-red-400">Playlist âŒ | Favori âŒ</p>
                        </div>
                        <div class="bg-slate-900/50 rounded p-4">
                            <p class="text-white font-bold mb-2">CTA:</p>
                            <p class="text-red-400">"AboneliÄŸiniz sona erdi! HEMEN YENÄ°LE!"</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- HÄ±zlÄ± Tablo -->
            <div class="mt-10">
                <h3 class="text-2xl font-bold mb-6 text-cyan-400">ğŸ“Š HÄ±zlÄ± Referans Tablosu</h3>
                <div class="overflow-x-auto">
                    <table class="w-full bg-slate-900/50 rounded-lg overflow-hidden">
                        <thead class="bg-slate-800">
                            <tr>
                                <th class="px-6 py-4 text-left text-white">Durum</th>
                                <th class="px-6 py-4 text-left text-white">Dinleme</th>
                                <th class="px-6 py-4 text-left text-white">SÃ¼re</th>
                                <th class="px-6 py-4 text-left text-white">Playlist</th>
                                <th class="px-6 py-4 text-left text-white">CTA</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-800">
                            <tr>
                                <td class="px-6 py-4 text-slate-300 font-bold">ğŸ‘¤ GUEST</td>
                                <td class="px-6 py-4 text-yellow-400 font-bold">30 saniye</td>
                                <td class="px-6 py-4 text-slate-400">-</td>
                                <td class="px-6 py-4 text-red-400">âŒ</td>
                                <td class="px-6 py-4 text-blue-400">Ãœye ol</td>
                            </tr>
                            <tr class="bg-green-900/20">
                                <td class="px-6 py-4 text-green-400 font-bold">ğŸ†“ TRIAL</td>
                                <td class="px-6 py-4 text-green-400 font-bold">SÄ±nÄ±rsÄ±z</td>
                                <td class="px-6 py-4 text-green-400">7-30 gÃ¼n (plan'dan)</td>
                                <td class="px-6 py-4 text-green-400">âœ…</td>
                                <td class="px-6 py-4 text-yellow-400">Premium'a geÃ§</td>
                            </tr>
                            <tr class="bg-purple-900/20">
                                <td class="px-6 py-4 text-purple-400 font-bold">ğŸ‘‘ PREMIUM</td>
                                <td class="px-6 py-4 text-purple-400 font-bold">SÄ±nÄ±rsÄ±z</td>
                                <td class="px-6 py-4 text-purple-400">Ã–mÃ¼r boyu</td>
                                <td class="px-6 py-4 text-purple-400">âœ…</td>
                                <td class="px-6 py-4 text-blue-400">Keyifle dinle</td>
                            </tr>
                            <tr class="bg-red-900/20">
                                <td class="px-6 py-4 text-red-400 font-bold">â° EXPIRED</td>
                                <td class="px-6 py-4 text-yellow-400 font-bold">30 saniye</td>
                                <td class="px-6 py-4 text-slate-400">-</td>
                                <td class="px-6 py-4 text-red-400">âŒ</td>
                                <td class="px-6 py-4 text-red-400 font-bold">HEMEN YENÄ°LE!</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- 5. DEVICE LIMIT HIERARCHY -->
        <section id="device-hierarchy" class="mb-16">
            <h2 class="text-4xl font-bold mb-8 text-cyan-400">5ï¸âƒ£ Device Limit Hierarchy (3-Layer Fallback)</h2>
            
            <div class="bg-cyan-900/20 border border-cyan-700/50 rounded-xl p-8 mb-8">
                <h3 class="text-2xl font-bold text-cyan-400 mb-6">ğŸ¯ NasÄ±l Ã‡alÄ±ÅŸÄ±r?</h3>
                
                <div class="space-y-6">
                    <div class="flex items-center gap-4">
                        <div class="px-8 py-4 bg-green-600 text-white rounded-lg font-bold min-w-[250px] text-center text-lg">1ï¸âƒ£ user.device_limit</div>
                        <span class="text-3xl">â†’</span>
                        <div class="flex-1 text-slate-300 text-lg">En yÃ¼ksek Ã¶ncelik (VIP, Test, Ban kullanÄ±cÄ±larÄ± iÃ§in override)</div>
                    </div>

                    <div class="flex items-center gap-4">
                        <div class="px-8 py-4 bg-blue-600 text-white rounded-lg font-bold min-w-[250px] text-center text-lg">2ï¸âƒ£ plan.device_limit</div>
                        <span class="text-3xl">â†’</span>
                        <div class="flex-1 text-slate-300 text-lg">Plan'Ä±n default deÄŸeri (Normal kullanÄ±cÄ±lar iÃ§in)</div>
                    </div>

                    <div class="flex items-center gap-4">
                        <div class="px-8 py-4 bg-purple-600 text-white rounded-lg font-bold min-w-[250px] text-center text-lg">3ï¸âƒ£ auth_device_limit</div>
                        <span class="text-3xl">â†’</span>
                        <div class="flex-1 text-slate-300 text-lg">Global fallback (Son Ã§are, setting)</div>
                    </div>
                </div>

                <div class="mt-6 bg-blue-900/30 rounded-lg p-4 border border-blue-700/50">
                    <p class="text-blue-400 font-bold mb-2">ğŸ’¡ MantÄ±k:</p>
                    <p class="text-slate-300">Ãœstten alta inerken ilk NULL OLMAYAN deÄŸer kullanÄ±lÄ±r. NULL ise bir sonraki katmana geÃ§.</p>
                </div>
            </div>

            <!-- Kod -->
            <div class="bg-slate-900/50 rounded-xl p-8 border border-cyan-700/50 mb-8">
                <h3 class="text-2xl font-bold text-cyan-400 mb-4">ğŸ’» Kod Ä°mplementasyonu</h3>
                <div class="bg-slate-900 rounded-lg p-6 font-mono text-sm text-green-400 overflow-x-auto">
public function getDeviceLimit(User $user): int<br>
{<br>
&nbsp;&nbsp;// 1. User override (Ã¶zel durumlar - VIP/Test/Ban)<br>
&nbsp;&nbsp;if ($user->device_limit !== null) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;return $user->device_limit;<br>
&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;// 2. Plan default (normal akÄ±ÅŸ - Ã§oÄŸu kullanÄ±cÄ± buradan)<br>
&nbsp;&nbsp;$sub = $user->activeSubscription();<br>
&nbsp;&nbsp;if ($sub && $sub->plan->device_limit) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;return $sub->plan->device_limit;<br>
&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;// 3. Global fallback (son Ã§are - setting)<br>
&nbsp;&nbsp;return setting('auth_device_limit', 1);<br>
}
                </div>
            </div>
        </section>

        <!-- 6. HIZLI Ã–ZET -->
        <section id="quick-summary" class="mb-16">
            <h2 class="text-4xl font-bold mb-8 text-yellow-400">âš¡ HÄ±zlÄ± Ã–zet (v2 - Trial Dinamik)</h2>
            
            <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-emerald-900/20 border border-emerald-800/50 rounded-lg p-6">
                    <h3 class="text-lg font-bold mb-4 text-emerald-400">ğŸ“‹ ULTIMATE Master Plan</h3>
                    <ul class="space-y-1 text-sm text-slate-300">
                        <li>âœ… Trial plan varsa otomatik baÅŸlar</li>
                        <li>âœ… Trial sÃ¼resi â†’ Plan cycle'dan (DÄ°NAMÄ°K)</li>
                        <li>âœ… is_trial checkbox</li>
                        <li>âœ… has_used_trial kontrolÃ¼</li>
                        <li>âœ… 30 saniye preview</li>
                        <li>âœ… Request-level check</li>
                        <li>âœ… SettingsManagement (3-layer)</li>
                    </ul>
                </div>

                <div class="bg-purple-900/20 border border-purple-800/50 rounded-lg p-6">
                    <h3 class="text-lg font-bold mb-4 text-purple-400">âš™ï¸ Settings (2 Adet)</h3>
                    <ul class="space-y-1 text-sm text-slate-300">
                        <li>1ï¸âƒ£ <strong>auth_subscription</strong> (0/1)</li>
                        <li>&nbsp;&nbsp;&nbsp;â†’ Ana anahtar (trial plan gerekli!)</li>
                        <li>2ï¸âƒ£ <strong>auth_device_limit</strong> (number)</li>
                        <li>&nbsp;&nbsp;&nbsp;â†’ Global fallback</li>
                    </ul>
                </div>

                <div class="bg-blue-900/20 border border-blue-800/50 rounded-lg p-6">
                    <h3 class="text-lg font-bold mb-4 text-blue-400">ğŸ”§ Hardcode (1 Adet)</h3>
                    <ul class="space-y-1 text-sm text-slate-300">
                        <li>1ï¸âƒ£ <strong>30 saniye</strong> - Preview sÃ¼resi</li>
                        <li class="pt-2 text-red-400">âŒ 7 gÃ¼n (v1) â†’ DÄ°NAMÄ°K (v2)</li>
                        <li class="text-red-400">âŒ Auto-start (v1) â†’ KOÅULLU (v2)</li>
                    </ul>
                </div>

                <div class="bg-orange-900/20 border border-orange-800/50 rounded-lg p-6">
                    <h3 class="text-lg font-bold mb-4 text-orange-400">ğŸ†• Trial Plan (v2)</h3>
                    <ul class="space-y-1 text-sm text-slate-300">
                        <li>âœ… <code class="bg-slate-800 px-2 py-1 rounded">is_trial=true</code> plan gerekli</li>
                        <li>âœ… Plan yoksa trial YOK</li>
                        <li>âœ… SÃ¼re: cycle'dan <code class="bg-slate-800 px-2 py-1 rounded">duration_days</code></li>
                        <li>âœ… Tek cycle (7, 14, 30 gÃ¼n vs.)</li>
                    </ul>
                </div>

                <div class="bg-green-900/20 border border-green-800/50 rounded-lg p-6">
                    <h3 class="text-lg font-bold mb-4 text-green-400">ğŸ‘¥ KullanÄ±cÄ± (4 Durum)</h3>
                    <ul class="space-y-1 text-sm text-slate-300">
                        <li>ğŸ‘¤ <strong>GUEST</strong> - 30 saniye</li>
                        <li>ğŸ†“ <strong>TRIAL</strong> - X gÃ¼n (plan'dan)</li>
                        <li>ğŸ‘‘ <strong>PREMIUM</strong> - Ã–mÃ¼r boyu</li>
                        <li>â° <strong>EXPIRED</strong> - 30 saniye</li>
                    </ul>
                </div>

                <div class="bg-cyan-900/20 border border-cyan-800/50 rounded-lg p-6">
                    <h3 class="text-lg font-bold mb-4 text-cyan-400">ğŸ“± Device Hierarchy</h3>
                    <ul class="space-y-1 text-sm text-slate-300">
                        <li>1ï¸âƒ£ <strong>user.device_limit</strong> - Ã–ncelikli</li>
                        <li>2ï¸âƒ£ <strong>plan.device_limit</strong> - Normal</li>
                        <li>3ï¸âƒ£ <strong>auth_device_limit</strong> - Fallback</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="mt-20 pt-8 border-t border-slate-700 text-center text-slate-500 text-sm">
            <p>ğŸ¤– Claude AI - Tailwind CSS</p>
            <p class="mt-2">Tarih: 2025-12-05 | ULTIMATE KILAVUZ v2</p>
            <p class="mt-2 text-xs">v2: Trial plan dinamik sistemi eklendi - Plan yoksa trial yok!</p>
        </footer>
    </div>
</body>
</html>
