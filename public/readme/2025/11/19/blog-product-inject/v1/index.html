<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Ä°Ã§eriÄŸinde Dinamik ÃœrÃ¼n Enjeksiyonu - Analiz & Strateji</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            line-height: 1.7;
            padding: 40px 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            margin-bottom: 50px;
            padding-bottom: 30px;
            border-bottom: 2px solid #334155;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #60a5fa, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .meta {
            color: #94a3b8;
            font-size: 0.95rem;
        }

        section {
            margin-bottom: 50px;
        }

        h2 {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: #60a5fa;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        h3 {
            font-size: 1.4rem;
            margin: 30px 0 20px 0;
            color: #93c5fd;
        }

        .card {
            background: rgba(30, 41, 59, 0.5);
            padding: 30px;
            margin-bottom: 25px;
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
            backdrop-filter: blur(10px);
        }

        .card:hover {
            background: rgba(30, 41, 59, 0.7);
            transform: translateX(5px);
            transition: all 0.3s ease;
        }

        .card h4 {
            color: #60a5fa;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .card p, .card ul {
            color: #cbd5e1;
            line-height: 1.8;
        }

        ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        li {
            margin-bottom: 10px;
        }

        .tech-term {
            color: #fbbf24;
            font-weight: 500;
        }

        .priority-high {
            background: #dc2626;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 10px;
        }

        .priority-medium {
            background: #f59e0b;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 10px;
        }

        .priority-low {
            background: #10b981;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 10px;
        }

        .warning-box {
            background: rgba(251, 191, 36, 0.1);
            border-left: 4px solid #fbbf24;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .success-box {
            background: rgba(16, 185, 129, 0.1);
            border-left: 4px solid #10b981;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .code-block {
            background: #1e293b;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid #334155;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #334155;
        }

        th {
            background: rgba(59, 130, 246, 0.1);
            color: #60a5fa;
            font-weight: 600;
        }

        footer {
            margin-top: 60px;
            padding-top: 30px;
            border-top: 1px solid #334155;
            color: #64748b;
            font-size: 0.9rem;
            text-align: center;
        }

        .strategy-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .strategy-card {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(99, 102, 241, 0.1));
            padding: 25px;
            border-radius: 12px;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .strategy-card h5 {
            color: #60a5fa;
            font-size: 1.1rem;
            margin-bottom: 12px;
        }

        .icon {
            font-size: 2rem;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“Š Blog Ä°Ã§eriÄŸinde Dinamik ÃœrÃ¼n Enjeksiyonu</h1>
            <div class="meta">
                ğŸ“… Tarih: 2025-11-19 |
                ğŸ¯ Tenant: ixtif.com (Tenant 2) |
                ğŸ‘¤ Talep: Blog yazÄ±larÄ±na otomatik Ã¼rÃ¼n kartlarÄ± enjekte et
            </div>
        </header>

        <!-- MEVCUT DURUM ANALÄ°ZÄ° -->
        <section>
            <h2>ğŸ” Mevcut Sistem Analizi</h2>

            <h3>1. Blog ModÃ¼lÃ¼ YapÄ±sÄ±</h3>
            <div class="card">
                <h4>Blog Model (Modules/Blog/app/Models/Blog.php)</h4>
                <ul>
                    <li><strong>Primary Key:</strong> blog_id</li>
                    <li><strong>Ã‡oklu Dil:</strong> HasTranslations trait (title, slug, body, excerpt JSON kolonlar)</li>
                    <li><strong>Ä°Ã§erik AlanÄ±:</strong> body (array/JSON - her dil iÃ§in HTML iÃ§erik)</li>
                    <li><strong>Ä°liÅŸkiler:</strong> BlogCategory, Tags, MediaLibrary</li>
                    <li><strong>Ã–zel Alanlar:</strong> faq_data, howto_data (JSON)</li>
                    <li><strong>Review System:</strong> HasReviews trait mevcut</li>
                </ul>
            </div>

            <div class="card">
                <h4>Blog Detay SayfasÄ± (show-content.blade.php)</h4>
                <ul>
                    <li><strong>Content Render:</strong> SatÄ±r 364-395 arasÄ± <span class="tech-term">prose</span> class ile</li>
                    <li><strong>Widget Shortcode:</strong> parse_widget_shortcodes() fonksiyonu mevcut (satÄ±r 389)</li>
                    <li><strong>Image Processing:</strong> process_blog_images() ile Thumbmaker optimizasyonu (satÄ±r 392)</li>
                    <li><strong>H2 Heading YapÄ±sÄ±:</strong> TocService ile anchor oluÅŸturuluyor (satÄ±r 11)</li>
                </ul>
            </div>

            <h3>2. Shop ModÃ¼lÃ¼ YapÄ±sÄ±</h3>
            <div class="card">
                <h4>ShopProduct Model (Modules/Shop/app/Models/ShopProduct.php)</h4>
                <ul>
                    <li><strong>Primary Key:</strong> product_id</li>
                    <li><strong>MeiliSearch:</strong> Laravel Scout + Searchable trait mevcut âœ…</li>
                    <li><strong>is_homepage Flag:</strong> <span class="tech-term">show_on_homepage</span> kolonu mevcut (satÄ±r 78)</li>
                    <li><strong>Homepage Sort:</strong> <span class="tech-term">homepage_sort_order</span> kolonu mevcut (satÄ±r 79)</li>
                    <li><strong>Kategori Ä°liÅŸkisi:</strong> belongsTo ShopCategory (category_id)</li>
                    <li><strong>Tag Sistemi:</strong> tags (JSON array) - satÄ±r 86</li>
                    <li><strong>Scout toSearchableArray():</strong> SatÄ±r 185-232 arasÄ± zengin indexing</li>
                </ul>
            </div>

            <div class="warning-box">
                <strong>âš ï¸ Kritik Bulgu:</strong> ShopProduct modelinde <span class="tech-term">show_on_homepage</span> ve <span class="tech-term">homepage_sort_order</span> kolonlarÄ± zaten mevcut! Ek kolon eklemeye gerek yok.
            </div>
        </section>

        <!-- STRATEJÄ° -->
        <section>
            <h2>ğŸ¯ Ã–nerilen Strateji: 3 YÃ¶ntem</h2>

            <div class="strategy-grid">
                <div class="strategy-card">
                    <div class="icon">ğŸ¯</div>
                    <h5>YÃ¶ntem 1: MeiliSearch ile AkÄ±llÄ± EÅŸleÅŸtirme</h5>
                    <p><strong>NasÄ±l Ã‡alÄ±ÅŸÄ±r:</strong></p>
                    <ul>
                        <li>Blog baÅŸlÄ±ÄŸÄ±ndan ve iÃ§eriÄŸinden anahtar kelimeleri Ã§Ä±kar</li>
                        <li>MeiliSearch'e bu kelimelerle sor</li>
                        <li>Ä°lgili Ã¼rÃ¼nleri is_homepage=1 olanlardan filtrele</li>
                    </ul>
                    <p><strong>Avantajlar:</strong></p>
                    <ul>
                        <li>âœ… Otomatik iÃ§erik eÅŸleÅŸtirme</li>
                        <li>âœ… HÄ±zlÄ± (MeiliSearch RAM-based)</li>
                        <li>âœ… Ek kolon gereksiz</li>
                    </ul>
                    <p><strong>Dezavantajlar:</strong></p>
                    <ul>
                        <li>âŒ Her zaman doÄŸru eÅŸleÅŸmeyebilir</li>
                    </ul>
                    <span class="priority-high">Ã–ncelik: YÃ¼ksek</span>
                </div>

                <div class="strategy-card">
                    <div class="icon">ğŸ·ï¸</div>
                    <h5>YÃ¶ntem 2: Tag-Based EÅŸleÅŸtirme</h5>
                    <p><strong>NasÄ±l Ã‡alÄ±ÅŸÄ±r:</strong></p>
                    <ul>
                        <li>Blog ve Ã¼rÃ¼nlerde ortak tag sistemi kullan</li>
                        <li>Ã–rnek: transpalet tag'i hem blogda hem Ã¼rÃ¼nde</li>
                        <li>Tag eÅŸleÅŸmesine gÃ¶re Ã¼rÃ¼n gÃ¶ster</li>
                    </ul>
                    <p><strong>Avantajlar:</strong></p>
                    <ul>
                        <li>âœ… Kesin kontrol (admin belirler)</li>
                        <li>âœ… Basit SQL JOIN</li>
                    </ul>
                    <p><strong>Dezavantajlar:</strong></p>
                    <ul>
                        <li>âŒ Manuel yÃ¶netim gerekir</li>
                        <li>âŒ Tag sistemi Blog ve Shop arasÄ±nda senkron olmalÄ±</li>
                    </ul>
                    <span class="priority-medium">Ã–ncelik: Orta</span>
                </div>

                <div class="strategy-card">
                    <div class="icon">ğŸ“‹</div>
                    <h5>YÃ¶ntem 3: Manuel Product ID Atama</h5>
                    <p><strong>NasÄ±l Ã‡alÄ±ÅŸÄ±r:</strong></p>
                    <ul>
                        <li>Blog admin paneline Ä°lgili ÃœrÃ¼nler seÃ§ici ekle</li>
                        <li>Admin hangi Ã¼rÃ¼nlerin gÃ¶sterileceÄŸini manuel seÃ§er</li>
                    </ul>
                    <p><strong>Avantajlar:</strong></p>
                    <ul>
                        <li>âœ… 100% kontrol</li>
                    </ul>
                    <p><strong>Dezavantajlar:</strong></p>
                    <ul>
                        <li>âŒ Ek kolon gerekir (related_product_ids JSON)</li>
                        <li>âŒ Her blog iÃ§in manuel atama</li>
                        <li>âŒ CLAUDE.md kuralÄ±na gÃ¶re: Ek tablo/kolon olmazsa daha iyi</li>
                    </ul>
                    <span class="priority-low">Ã–ncelik: DÃ¼ÅŸÃ¼k</span>
                </div>
            </div>
        </section>

        <!-- Ã–NERÄ°LEN Ã‡Ã–ZÃœM -->
        <section>
            <h2>âœ… Ã–nerilen Ã‡Ã¶zÃ¼m: Hybrid YaklaÅŸÄ±m</h2>

            <div class="success-box">
                <strong>ğŸ¯ Ana Strateji:</strong> MeiliSearch + Tag-Based Fallback (YÃ¶ntem 1 + 2 kombinasyonu)
            </div>

            <h3>MantÄ±k AkÄ±ÅŸÄ±</h3>

            <div class="card">
                <h4>AdÄ±m 1: Blog Ä°Ã§eriÄŸinden Anahtar Kelime Ã‡Ä±kar</h4>
                <p>Blog baÅŸlÄ±ÄŸÄ± ve body HTML'inden stop-word olmayan Ã¶nemli kelimeleri Ã§Ä±kar. Ã–rneÄŸin:</p>
                <ul>
                    <li>BaÅŸlÄ±k: "Transpalet SeÃ§erken Dikkat Edilmesi Gerekenler"</li>
                    <li>Ã‡Ä±kan Kelimeler: "transpalet", "seÃ§erken", "dikkat", "gerekenler"</li>
                </ul>
            </div>

            <div class="card">
                <h4>AdÄ±m 2: MeiliSearch ile Ä°lgili ÃœrÃ¼nleri Bul</h4>
                <p>Bu anahtar kelimelerle MeiliSearch'te ara. Filtreleme kriterleri:</p>
                <ul>
                    <li>show_on_homepage = 1 (anasayfada gÃ¶sterilebilecek Ã¼rÃ¼nler)</li>
                    <li>is_active = 1 (aktif Ã¼rÃ¼nler)</li>
                    <li>SÄ±ralama: homepage_sort_order ASC</li>
                </ul>
            </div>

            <div class="card">
                <h4>AdÄ±m 3: Fallback - Tag EÅŸleÅŸtirme</h4>
                <p>EÄŸer MeiliSearch yeterli Ã¼rÃ¼n dÃ¶ndÃ¼rmezse (Ã¶rn. 3'ten az):</p>
                <ul>
                    <li>Blog tag_list ile ShopProduct tags JSON match yap</li>
                    <li>Eksik Ã¼rÃ¼nleri tamamla</li>
                </ul>
            </div>

            <div class="card">
                <h4>AdÄ±m 4: H2 BaÅŸlÄ±klarÄ±na ÃœrÃ¼n Enjekte Et</h4>
                <p>Blog body HTML'ini parse et ve ÅŸu konumlara Ã¼rÃ¼n kartlarÄ± ekle:</p>
                <ul>
                    <li>2. H2 baÅŸlÄ±ÄŸÄ± Ã¶ncesi: Ä°lk 3 Ã¼rÃ¼n</li>
                    <li>Sondan 1. H2 baÅŸlÄ±ÄŸÄ± Ã¶ncesi: Son 3 Ã¼rÃ¼n</li>
                </ul>
            </div>
        </section>

        <!-- PERFORMANS -->
        <section>
            <h2>âš¡ Performans Stratejisi</h2>

            <div class="card">
                <h4>1. Cache YÃ¶netimi</h4>
                <ul>
                    <li><strong>Blog BazlÄ± Cache:</strong> Her blog iÃ§in ilgili Ã¼rÃ¼nleri 1 saat cache'le</li>
                    <li><strong>Cache Key:</strong> <span class="tech-term">blog_products_{blog_id}_{locale}</span></li>
                    <li><strong>Invalidation:</strong> ÃœrÃ¼n show_on_homepage deÄŸiÅŸtiÄŸinde tÃ¼m blog cache'lerini temizle</li>
                </ul>
            </div>

            <div class="card">
                <h4>2. MeiliSearch Optimizasyonu</h4>
                <ul>
                    <li>ShopProduct::toSearchableArray() zaten optimized</li>
                    <li>Filtreleme: show_on_homepage, is_active indexte mevcut</li>
                    <li>SÄ±ralama: homepage_sort_order kullanÄ±labilir</li>
                </ul>
            </div>

            <div class="warning-box">
                <strong>âš ï¸ Dikkat:</strong> Blog render sÄ±rasÄ±nda gerÃ§ek zamanlÄ± HTML parse yapÄ±lacak. EÄŸer Ã§ok yavaÅŸ olursa Observer pattern'e geÃ§:
                <ul>
                    <li>BlogObserver::saved() eventinde body'yi parse et</li>
                    <li>Sonucu processed_body kolonuna kaydet</li>
                    <li>Ancak bu ek kolon gerektirir (CLAUDE.md kuralÄ±na aykÄ±rÄ±)</li>
                </ul>
            </div>
        </section>

        <!-- TENANT AWARE -->
        <section>
            <h2>ğŸŒ Multi-Tenant Uyumluluk</h2>

            <div class="card">
                <h4>Tenant-Specific Behavior</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Tenant</th>
                            <th>SektÃ¶r</th>
                            <th>DavranÄ±ÅŸ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Tenant 2 (ixtif.com)</td>
                            <td>EndÃ¼striyel Ekipman</td>
                            <td><strong>Aktif:</strong> Transpalet/Forklift yazÄ±larÄ±nda ilgili Ã¼rÃ¼nler</td>
                        </tr>
                        <tr>
                            <td>Tenant 1001 (muzibu.com)</td>
                            <td>MÃ¼zik Platformu</td>
                            <td><strong>FarklÄ± Strateji:</strong> MÃ¼zik aletleri, kurslar vb.</td>
                        </tr>
                        <tr>
                            <td>DiÄŸer Tenant'lar</td>
                            <td>Ã‡eÅŸitli</td>
                            <td>AynÄ± sistem, farklÄ± Ã¼rÃ¼n kategorileri</td>
                        </tr>
                    </tbody>
                </table>
                <p><strong>Implementasyon:</strong></p>
                <ul>
                    <li>Helper fonksiyonlar global (tÃ¼m tenant'lar iÃ§in)</li>
                    <li>MeiliSearch tenant-aware (zaten mevcut)</li>
                    <li>ÃœrÃ¼n filtreleme tenant database'inden yapÄ±lÄ±yor</li>
                </ul>
            </div>
        </section>

        <!-- YAPILACAKLAR -->
        <section>
            <h2>ğŸ“ Uygulama YapÄ±lacaklar Listesi</h2>

            <div class="card">
                <h4>AdÄ±m 1: Helper Fonksiyonlar <span class="priority-high">YÃ¼ksek Ã–ncelik</span></h4>
                <p><strong>Konum:</strong> app/Helpers/blog_product_injector.php (yeni)</p>
                <ul>
                    <li>extractKeywordsFromBlog() fonksiyonu yaz (blog title + body'den anahtar kelime Ã§Ä±kar)</li>
                    <li>getRelatedProductsForBlog() fonksiyonu yaz (MeiliSearch + Tag fallback)</li>
                </ul>
                <p><strong>Beklenen SonuÃ§:</strong> Blog objesi gir â†’ Ä°lgili 3-6 Ã¼rÃ¼n dÃ¶n</p>
            </div>

            <div class="card">
                <h4>AdÄ±m 2: Content Injector Service <span class="priority-high">YÃ¼ksek Ã–ncelik</span></h4>
                <p><strong>Konum:</strong> app/Services/BlogContentInjectorService.php (yeni)</p>
                <ul>
                    <li>injectProducts() metodu: H2 taglerini bul ve Ã¼rÃ¼n enjekte et</li>
                    <li>DOMDocument ile HTML parse et (gÃ¼venli & performanslÄ±)</li>
                    <li>Blade component render: product-grid-inline</li>
                </ul>
                <p><strong>Beklenen SonuÃ§:</strong> HTML gir â†’ ÃœrÃ¼n kartlarÄ± eklenmiÅŸ HTML dÃ¶n</p>
            </div>

            <div class="card">
                <h4>AdÄ±m 3: Blade Component <span class="priority-medium">Orta Ã–ncelik</span></h4>
                <p><strong>Konum:</strong> resources/views/components/shop/product-grid-inline.blade.php (yeni)</p>
                <ul>
                    <li>TasarÄ±m: Blog iÃ§inde gÃ¶zÃ¼kmeyecek kadar gÃ¶ze batan olmasÄ±n</li>
                    <li>Tailwind CSS kullan (mevcut blog tasarÄ±mÄ±na uyumlu)</li>
                    <li>Responsive grid (mobilde 1, tablette 2, masaÃ¼stÃ¼nde 3 sÃ¼tun)</li>
                    <li>Lazy loading gÃ¶rsel</li>
                    <li>CTA: ÃœrÃ¼nÃ¼ Ä°ncele butonu</li>
                </ul>
                <p><strong>Beklenen SonuÃ§:</strong> 3 Ã¼rÃ¼nlÃ¼k kompakt grid</p>
            </div>

            <div class="card">
                <h4>AdÄ±m 4: show-content.blade.php Entegrasyonu <span class="priority-medium">Orta Ã–ncelik</span></h4>
                <p><strong>Konum:</strong> Modules/Blog/resources/views/themes/ixtif/partials/show-content.blade.php</p>
                <ul>
                    <li>SatÄ±r 389 civarÄ± BlogContentInjectorService::injectProducts() Ã§aÄŸrÄ±sÄ± ekle</li>
                    <li>Cache implementasyonu ekle</li>
                </ul>
                <p><strong>Beklenen SonuÃ§:</strong> Blog detay sayfasÄ±nda Ã¼rÃ¼nler otomatik gÃ¶sterilir</p>
            </div>

            <div class="card">
                <h4>AdÄ±m 5: Test & Optimizasyon <span class="priority-low">DÃ¼ÅŸÃ¼k Ã–ncelik</span></h4>
                <ul>
                    <li>5-10 blog yazÄ±sÄ± ile test et</li>
                    <li>Performans Ã¶lÃ§ (HTML parse sÃ¼resi)</li>
                    <li>Cache hit rate kontrol et</li>
                    <li>Mobile responsive kontrol et</li>
                </ul>
            </div>
        </section>

        <!-- GELÄ°ÅTÄ°RME NOTLARI -->
        <section>
            <h2>ğŸ’¡ GeliÅŸtiriciye Notlar</h2>

            <div class="warning-box">
                <strong>Dikkat Edilmesi Gerekenler:</strong>
                <ul>
                    <li>â— Blog body iÃ§eriÄŸi zaten widget shortcode parse ediliyor - bu parse SONRASINA Ã¼rÃ¼n enjekte et</li>
                    <li>â— H2 tag sayÄ±sÄ± az olan bloglarda (0-1 adet) Ã¼rÃ¼n gÃ¶sterme - UX kÃ¶tÃ¼ olur</li>
                    <li>â— MeiliSearch boÅŸ dÃ¶ndÃ¼ÄŸÃ¼nde fallback stratejisi olsun (random homepage products)</li>
                    <li>â— ÃœrÃ¼n kartlarÄ±nda lazy loading kullan (blog sayfasÄ± aÄŸÄ±rlaÅŸmasÄ±n)</li>
                    <li>â— show_on_homepage=1 olan Ã¼rÃ¼nler bitmiÅŸse gÃ¶sterme (boÅŸ kart gÃ¶sterme)</li>
                </ul>
            </div>

            <div class="success-box">
                <strong>âœ… Avantajlar:</strong>
                <ul>
                    <li>Ek database kolonu yok (CLAUDE.md kuralÄ±na uygun)</li>
                    <li>Otomatik iÃ§erik eÅŸleÅŸtirme (manuel yÃ¶netim minimum)</li>
                    <li>MeiliSearch sayesinde hÄ±zlÄ±</li>
                    <li>Multi-tenant uyumlu</li>
                    <li>Blog AI generate sistemi ile birlikte Ã§alÄ±ÅŸÄ±r</li>
                </ul>
            </div>
        </section>

        <footer>
            ğŸ¤– Claude AI tarafÄ±ndan oluÅŸturuldu â€¢ 2025-11-19
        </footer>
    </div>
</body>
</html>