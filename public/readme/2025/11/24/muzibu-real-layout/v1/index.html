<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Muzibu - Kurumsal M√ºzik Platformu</title>

    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- HLS.js -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@1.4.12/dist/hls.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Spotify Color Palette */
            --bg-base: #000000;
            --bg-elevated: #121212;
            --bg-highlight: #1a1a1a;
            --bg-press: #000000;
            --text-base: #ffffff;
            --text-subdued: #b3b3b3;
            --text-bright: #ffffff;
            --essential-base: #ffffff;
            --essential-subdued: #727272;
            --essential-bright: #ffffff;
            --decorative-base: #ffffff;
            --decorative-subdued: #292929;
            --accent-base: #1db954;
            --accent-hover: #1ed760;
            --accent-press: #169c46;

            /* Layout */
            --sidebar-width: 280px;
            --player-height: 90px;
            --topbar-height: 64px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: var(--bg-base);
            color: var(--text-base);
            overflow: hidden;
        }

        /* ============================================
           LAYOUT GRID
        ============================================ */
        .app-layout {
            display: grid;
            grid-template-areas:
                "sidebar main"
                "player player";
            grid-template-columns: var(--sidebar-width) 1fr;
            grid-template-rows: 1fr var(--player-height);
            height: 100vh;
            gap: 8px;
            padding: 8px;
        }

        /* ============================================
           SIDEBAR (Left Navigation)
        ============================================ */
        .sidebar {
            grid-area: sidebar;
            background: var(--bg-base);
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .sidebar__header {
            padding: 24px 24px 16px;
        }

        .sidebar__logo {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-base);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .sidebar__nav {
            display: flex;
            flex-direction: column;
            padding: 8px 12px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 12px 16px;
            color: var(--text-subdued);
            font-size: 14px;
            font-weight: 700;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.1s ease;
            text-decoration: none;
        }

        .nav-item:hover {
            color: var(--text-base);
        }

        .nav-item.active {
            color: var(--text-base);
            background: var(--bg-highlight);
        }

        .nav-item__icon {
            font-size: 24px;
            width: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sidebar__divider {
            height: 1px;
            background: var(--decorative-subdued);
            margin: 8px 12px;
        }

        .sidebar__library {
            flex: 1;
            overflow-y: auto;
            padding: 8px 12px;
        }

        .sidebar__library::-webkit-scrollbar {
            width: 12px;
        }

        .sidebar__library::-webkit-scrollbar-track {
            background: transparent;
        }

        .sidebar__library::-webkit-scrollbar-thumb {
            background: var(--essential-subdued);
            border-radius: 6px;
            border: 3px solid var(--bg-base);
        }

        .sidebar__library::-webkit-scrollbar-thumb:hover {
            background: var(--text-subdued);
        }

        .library-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 12px;
            color: var(--text-subdued);
            font-size: 14px;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.1s ease;
        }

        .library-item:hover {
            background: var(--bg-highlight);
        }

        .library-item__cover {
            width: 48px;
            height: 48px;
            background: var(--bg-highlight);
            border-radius: 4px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .library-item__info {
            flex: 1;
            min-width: 0;
        }

        .library-item__title {
            color: var(--text-base);
            font-size: 14px;
            font-weight: 400;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .library-item__subtitle {
            color: var(--text-subdued);
            font-size: 12px;
            margin-top: 2px;
        }

        /* ============================================
           MAIN CONTENT
        ============================================ */
        .main-content {
            grid-area: main;
            background: var(--bg-elevated);
            border-radius: 8px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .main-content__scrollable {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .main-content__scrollable::-webkit-scrollbar {
            width: 16px;
        }

        .main-content__scrollable::-webkit-scrollbar-track {
            background: transparent;
        }

        .main-content__scrollable::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            border: 4px solid var(--bg-elevated);
        }

        .main-content__scrollable::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.4);
        }

        .content-inner {
            padding: 24px 32px 32px;
        }

        .content-header {
            margin-bottom: 24px;
        }

        .content-title {
            font-size: 32px;
            font-weight: 900;
            color: var(--text-base);
            margin-bottom: 8px;
        }

        .content-subtitle {
            font-size: 14px;
            color: var(--text-subdued);
        }

        /* Placeholder Content */
        .placeholder {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-subdued);
        }

        .placeholder__icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .placeholder__text {
            font-size: 16px;
        }

        /* ============================================
           PLAYER (Bottom Bar - Spotify Style)
        ============================================ */
        .player {
            grid-area: player;
            background: var(--bg-base);
            border-radius: 8px;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            align-items: center;
            padding: 0 16px;
            gap: 16px;
        }

        /* Left: Now Playing */
        .player__now-playing {
            display: flex;
            align-items: center;
            gap: 14px;
            min-width: 180px;
        }

        .player__album-art {
            width: 56px;
            height: 56px;
            background: var(--bg-highlight);
            border-radius: 4px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
        }

        .player__track-info {
            min-width: 0;
            flex: 1;
        }

        .player__track-name {
            font-size: 14px;
            font-weight: 400;
            color: var(--text-base);
            cursor: pointer;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .player__track-name:hover {
            text-decoration: underline;
        }

        .player__track-artist {
            font-size: 11px;
            color: var(--text-subdued);
            cursor: pointer;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-top: 4px;
        }

        .player__track-artist:hover {
            text-decoration: underline;
            color: var(--text-base);
        }

        .player__like-btn {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-subdued);
            cursor: pointer;
            font-size: 16px;
            transition: all 0.1s ease;
        }

        .player__like-btn:hover {
            color: var(--text-base);
            transform: scale(1.1);
        }

        .player__like-btn.liked {
            color: var(--accent-base);
        }

        /* Center: Controls */
        .player__controls {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-width: 722px;
            justify-self: center;
            width: 100%;
        }

        .player__buttons {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
        }

        .player__btn {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-subdued);
            cursor: pointer;
            background: none;
            border: none;
            font-size: 16px;
            transition: all 0.1s ease;
        }

        .player__btn:hover {
            color: var(--text-base);
            transform: scale(1.06);
        }

        .player__btn:active {
            transform: scale(1);
        }

        .player__btn--play {
            width: 32px;
            height: 32px;
            background: var(--text-base);
            color: var(--bg-base);
            border-radius: 50%;
            font-size: 14px;
        }

        .player__btn--play:hover {
            transform: scale(1.06);
            background: var(--text-bright);
        }

        .player__progress-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .player__time {
            font-size: 11px;
            color: var(--text-subdued);
            min-width: 40px;
            text-align: right;
        }

        .player__time:first-child {
            text-align: left;
        }

        .player__progress-bar {
            flex: 1;
            height: 4px;
            background: var(--essential-subdued);
            border-radius: 2px;
            cursor: pointer;
            position: relative;
            transition: height 0.1s ease;
        }

        .player__progress-bar:hover {
            height: 6px;
        }

        .player__progress-bar:hover .player__progress-fill::after {
            opacity: 1;
        }

        .player__progress-fill {
            height: 100%;
            background: var(--text-base);
            border-radius: 2px;
            position: relative;
            width: 0%;
            transition: width 0.1s linear;
        }

        .player__progress-fill::after {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 12px;
            height: 12px;
            background: var(--text-base);
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.1s ease;
        }

        /* Right: Volume & Additional Controls */
        .player__extra-controls {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 8px;
        }

        .player__volume {
            display: flex;
            align-items: center;
            gap: 8px;
            max-width: 125px;
            flex: 1;
        }

        .player__volume-bar {
            flex: 1;
            height: 4px;
            background: var(--essential-subdued);
            border-radius: 2px;
            cursor: pointer;
            position: relative;
            transition: height 0.1s ease;
        }

        .player__volume-bar:hover {
            height: 6px;
        }

        .player__volume-bar:hover .player__volume-fill::after {
            opacity: 1;
        }

        .player__volume-fill {
            height: 100%;
            background: var(--text-base);
            border-radius: 2px;
            position: relative;
            width: 70%;
            transition: width 0.1s ease;
        }

        .player__volume-fill::after {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 12px;
            height: 12px;
            background: var(--text-base);
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.1s ease;
        }

        /* Hidden audio element */
        audio {
            display: none;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .app-layout {
                grid-template-columns: 1fr;
                grid-template-rows: auto 1fr var(--player-height);
                grid-template-areas:
                    "sidebar"
                    "main"
                    "player";
            }

            .sidebar {
                max-height: 200px;
            }

            .player {
                grid-template-columns: 1fr;
                gap: 8px;
                padding: 12px;
            }

            .player__extra-controls {
                justify-content: center;
            }
        }
    </style>
</head>
<body x-data="muzibuApp()" x-init="init()">
    <div class="app-layout">
        <!-- SIDEBAR (Left Navigation) -->
        <aside class="sidebar">
            <div class="sidebar__header">
                <div class="sidebar__logo">
                    üéµ Muzibu
                </div>
            </div>

            <nav class="sidebar__nav">
                <a href="#" class="nav-item active" @click.prevent="navigate('home')">
                    <span class="nav-item__icon">üè†</span>
                    <span>Ana Sayfa</span>
                </a>
                <a href="#" class="nav-item" @click.prevent="navigate('search')">
                    <span class="nav-item__icon">üîç</span>
                    <span>Ara</span>
                </a>
                <a href="#" class="nav-item" @click.prevent="navigate('library')">
                    <span class="nav-item__icon">üìö</span>
                    <span>K√ºt√ºphanem</span>
                </a>
            </nav>

            <div class="sidebar__divider"></div>

            <div class="sidebar__library">
                <!-- Playlist/Library items will be here -->
                <div class="library-item" @click="playSample('playlist-1')">
                    <div class="library-item__cover">üéµ</div>
                    <div class="library-item__info">
                        <div class="library-item__title">Workout Mix</div>
                        <div class="library-item__subtitle">Playlist ‚Ä¢ 50 ≈üarkƒ±</div>
                    </div>
                </div>
                <div class="library-item" @click="playSample('playlist-2')">
                    <div class="library-item__cover">‚òï</div>
                    <div class="library-item__info">
                        <div class="library-item__title">Cafe Vibes</div>
                        <div class="library-item__subtitle">Playlist ‚Ä¢ Sekt√∂r</div>
                    </div>
                </div>
                <div class="library-item" @click="playSample('playlist-3')">
                    <div class="library-item__cover">üé∏</div>
                    <div class="library-item__info">
                        <div class="library-item__title">Rock Classics</div>
                        <div class="library-item__subtitle">Playlist ‚Ä¢ 80 ≈üarkƒ±</div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <div class="main-content__scrollable">
                <div class="content-inner">
                    <!-- Content will be dynamically loaded here -->
                    <div class="placeholder">
                        <div class="placeholder__icon">üéµ</div>
                        <div class="placeholder__text">
                            ƒ∞√ßerik burada y√ºklenecek<br>
                            (SPA Routing hazƒ±r - sayfa deƒüi≈ümeden i√ßerik deƒüi≈üecek)
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- PLAYER (Bottom Bar) -->
        <div class="player">
            <!-- Left: Now Playing -->
            <div class="player__now-playing">
                <div class="player__album-art" x-show="currentTrack">
                    <span x-text="currentTrack?.emoji || 'üéµ'"></span>
                </div>
                <div class="player__track-info" x-show="currentTrack">
                    <div class="player__track-name" x-text="currentTrack?.title || '≈ûarkƒ± Adƒ±'"></div>
                    <div class="player__track-artist" x-text="currentTrack?.artist || 'Sanat√ßƒ±'"></div>
                </div>
                <button class="player__like-btn" :class="{ 'liked': isLiked }" @click="toggleLike()">
                    <span x-text="isLiked ? '‚ù§Ô∏è' : 'ü§ç'"></span>
                </button>
            </div>

            <!-- Center: Controls -->
            <div class="player__controls">
                <div class="player__buttons">
                    <button class="player__btn" @click="toggleShuffle()" :style="{ color: shuffle ? 'var(--accent-base)' : '' }">
                        üîÄ
                    </button>
                    <button class="player__btn" @click="previousTrack()">
                        ‚èÆÔ∏è
                    </button>
                    <button class="player__btn player__btn--play" @click="togglePlayPause()">
                        <span x-text="isPlaying ? '‚è∏' : '‚ñ∂'"></span>
                    </button>
                    <button class="player__btn" @click="nextTrack()">
                        ‚è≠Ô∏è
                    </button>
                    <button class="player__btn" @click="cycleRepeat()" :style="{ color: repeatMode !== 'off' ? 'var(--accent-base)' : '' }">
                        <span x-text="repeatMode === 'one' ? 'üîÇ' : 'üîÅ'"></span>
                    </button>
                </div>

                <div class="player__progress-container">
                    <span class="player__time" x-text="formatTime(currentTime)"></span>
                    <div class="player__progress-bar" @click="seek($event)" x-ref="progressBar">
                        <div class="player__progress-fill" :style="`width: ${progressPercent}%`"></div>
                    </div>
                    <span class="player__time" x-text="formatTime(duration)"></span>
                </div>
            </div>

            <!-- Right: Volume & Extra Controls -->
            <div class="player__extra-controls">
                <button class="player__btn" @click="toggleQueue()">
                    üìù
                </button>
                <div class="player__volume">
                    <button class="player__btn" @click="toggleMute()">
                        <span x-text="isMuted ? 'üîá' : (volume > 50 ? 'üîä' : 'üîâ')"></span>
                    </button>
                    <div class="player__volume-bar" @click="setVolume($event)" x-ref="volumeBar">
                        <div class="player__volume-fill" :style="`width: ${volume}%`"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden Audio Element -->
    <audio
        x-ref="audio"
        @timeupdate="updateProgress()"
        @loadedmetadata="onMetadataLoaded()"
        @ended="onTrackEnded()"
        @play="isPlaying = true"
        @pause="isPlaying = false"
    ></audio>

    <script>
        function muzibuApp() {
            return {
                // Current route
                currentRoute: 'home',

                // Player state
                currentTrack: null,
                isPlaying: false,
                isPaused: false,
                currentTime: 0,
                duration: 0,
                volume: 70,
                isMuted: false,
                shuffle: false,
                repeatMode: 'off', // off, all, one
                isLiked: false,
                queue: [],
                currentIndex: 0,

                // HLS
                hls: null,

                init() {
                    // Setup audio element
                    const audio = this.$refs.audio;

                    // Set initial volume
                    audio.volume = this.volume / 100;

                    // Load sample track (for demo)
                    this.loadSampleTrack();

                    // Listen to popstate for browser back/forward
                    window.addEventListener('popstate', () => {
                        // Handle route change
                    });
                },

                // Navigation
                navigate(route) {
                    this.currentRoute = route;
                    // Update URL without reload
                    history.pushState({ route }, '', `#${route}`);
                    // SPA: Load content for route (will implement later)
                },

                // Load sample track for demo
                loadSampleTrack() {
                    this.currentTrack = {
                        title: 'Demo ≈ûarkƒ±',
                        artist: 'Demo Sanat√ßƒ±',
                        emoji: 'üéµ',
                        url: null, // Will be set when real songs are loaded
                        duration: 240,
                        isHLS: false
                    };
                },

                // Play a sample playlist/song
                playSample(id) {
                    console.log('Playing:', id);
                    // This will be replaced with real API call
                    this.currentTrack = {
                        title: 'Playlist ≈ûarkƒ±sƒ±',
                        artist: 'Sanat√ßƒ± Adƒ±',
                        emoji: 'üéµ',
                        url: null,
                        duration: 240,
                        isHLS: false
                    };
                },

                // Player controls
                togglePlayPause() {
                    const audio = this.$refs.audio;

                    if (!this.currentTrack?.url) {
                        console.log('No track URL - this will work when connected to API');
                        // Simulate play for demo
                        this.isPlaying = !this.isPlaying;
                        return;
                    }

                    if (audio.paused) {
                        audio.play();
                    } else {
                        audio.pause();
                    }
                },

                previousTrack() {
                    console.log('Previous track');
                    // Will implement with queue system
                },

                nextTrack() {
                    console.log('Next track');
                    // Will implement with queue system
                },

                toggleShuffle() {
                    this.shuffle = !this.shuffle;
                },

                cycleRepeat() {
                    const modes = ['off', 'all', 'one'];
                    const currentIndex = modes.indexOf(this.repeatMode);
                    this.repeatMode = modes[(currentIndex + 1) % modes.length];
                },

                toggleLike() {
                    this.isLiked = !this.isLiked;
                    // API call to save favorite
                },

                toggleQueue() {
                    console.log('Toggle queue panel');
                    // Will implement queue sidebar
                },

                toggleMute() {
                    const audio = this.$refs.audio;
                    this.isMuted = !this.isMuted;
                    audio.muted = this.isMuted;
                },

                // Progress & Time
                updateProgress() {
                    const audio = this.$refs.audio;
                    this.currentTime = audio.currentTime;
                    this.duration = audio.duration || 240;
                },

                seek(event) {
                    const bar = this.$refs.progressBar;
                    const rect = bar.getBoundingClientRect();
                    const percent = (event.clientX - rect.left) / rect.width;
                    const audio = this.$refs.audio;

                    if (audio.duration) {
                        audio.currentTime = audio.duration * percent;
                    }
                },

                setVolume(event) {
                    const bar = this.$refs.volumeBar;
                    const rect = bar.getBoundingClientRect();
                    const percent = (event.clientX - rect.left) / rect.width;
                    this.volume = Math.max(0, Math.min(100, percent * 100));

                    const audio = this.$refs.audio;
                    audio.volume = this.volume / 100;

                    if (this.isMuted && this.volume > 0) {
                        this.isMuted = false;
                        audio.muted = false;
                    }
                },

                onMetadataLoaded() {
                    const audio = this.$refs.audio;
                    this.duration = audio.duration;
                },

                onTrackEnded() {
                    if (this.repeatMode === 'one') {
                        this.$refs.audio.play();
                    } else {
                        this.nextTrack();
                    }
                },

                // Computed
                get progressPercent() {
                    if (!this.duration) return 0;
                    return (this.currentTime / this.duration) * 100;
                },

                // Helpers
                formatTime(seconds) {
                    if (!seconds || isNaN(seconds)) return '0:00';
                    const mins = Math.floor(seconds / 60);
                    const secs = Math.floor(seconds % 60);
                    return `${mins}:${secs.toString().padStart(2, '0')}`;
                },

                // Load track (HLS or normal)
                loadTrack(track) {
                    const audio = this.$refs.audio;

                    // Stop current playback
                    audio.pause();

                    // Destroy existing HLS instance
                    if (this.hls) {
                        this.hls.destroy();
                        this.hls = null;
                    }

                    // Check if HLS
                    if (track.isHLS && Hls.isSupported()) {
                        // Use HLS.js
                        this.hls = new Hls({
                            maxBufferLength: 30,
                            maxMaxBufferLength: 60,
                            enableWorker: true,
                        });

                        this.hls.loadSource(track.url);
                        this.hls.attachMedia(audio);

                        this.hls.on(Hls.Events.MANIFEST_PARSED, () => {
                            audio.play();
                        });

                        this.hls.on(Hls.Events.ERROR, (event, data) => {
                            console.error('HLS Error:', data);
                        });
                    } else {
                        // Use native audio
                        audio.src = track.url;
                        audio.load();
                        audio.play();
                    }

                    this.currentTrack = track;
                }
            }
        }
    </script>
</body>
</html>