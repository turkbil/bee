<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page & Portfolio Modulu Log Kayitlari Analizi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-slate-900 text-slate-100 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-6xl">

        <!-- Header -->
        <header class="mb-8 text-center">
            <div class="inline-flex items-center gap-2 bg-blue-600/20 border border-blue-500 rounded-full px-4 py-1 mb-4">
                <i class="fas fa-search text-blue-400"></i>
                <span class="text-blue-300 text-sm font-medium">Teknik Analiz</span>
            </div>
            <h1 class="text-3xl md:text-4xl font-bold mb-2">Page & Portfolio Modulu</h1>
            <h2 class="text-xl text-slate-400">Log Kayitlari Ekleme Bolumu Analizi</h2>
            <p class="text-slate-500 mt-2">
                <i class="fas fa-calendar-alt me-1"></i> 1 Ocak 2026
            </p>
        </header>

        <!-- Basit Anlatim -->
        <div class="bg-green-900/20 border border-green-700 rounded-xl p-6 mb-6">
            <h3 class="text-xl font-bold text-green-400 mb-4">
                <i class="fas fa-lightbulb me-2"></i>Basit Anlatim (Herkes Icin)
            </h3>
            <div class="space-y-3 text-slate-300">
                <p>
                    <strong>Ne yapiliyor?</strong> Sayfa (Page) ve Portfolyo modullerinde yapilan tum islemler
                    (ekleme, guncelleme, silme) otomatik olarak kaydediliyor.
                </p>
                <p>
                    <strong>Neden onemli?</strong> Kim, ne zaman, hangi sayfayi degistirdi?
                    Bu bilgiler sistem yoneticileri icin cok degerli. Hata durumunda geri donebilirsiniz.
                </p>
                <p>
                    <strong>Nasil calisir?</strong> Her kayit isleminde arka planda otomatik log tutulur.
                    Loglar merkezi bir yerden (Kullanici Yonetimi > Etkinlik Loglari) goruntulenebilir.
                </p>
            </div>
        </div>

        <!-- Teknik Detaylar -->
        <div class="bg-blue-900/20 border border-blue-700 rounded-xl p-6 mb-6">
            <h3 class="text-xl font-bold text-blue-400 mb-4">
                <i class="fas fa-cogs me-2"></i>Teknik Detaylar (Gelistiriciler Icin)
            </h3>

            <div class="space-y-4">
                <!-- Mimari -->
                <div class="bg-slate-800/50 rounded-lg p-4">
                    <h4 class="font-semibold text-slate-200 mb-2">
                        <i class="fas fa-sitemap text-purple-400 me-2"></i>Mimari Yapi
                    </h4>
                    <ul class="text-sm text-slate-400 space-y-1 ml-6 list-disc">
                        <li><strong>Spatie ActivityLog</strong> paketi kullaniliyor</li>
                        <li><strong>Observer Pattern</strong> ile otomatik loglama</li>
                        <li><strong>Helper Function</strong> ile manuel loglama destegi</li>
                        <li>Multi-tenant uyumlu (tenant database'e kaydedilir)</li>
                    </ul>
                </div>

                <!-- Dosyalar -->
                <div class="bg-slate-800/50 rounded-lg p-4">
                    <h4 class="font-semibold text-slate-200 mb-2">
                        <i class="fas fa-folder-tree text-yellow-400 me-2"></i>Ilgili Dosyalar
                    </h4>
                    <div class="text-sm font-mono text-slate-400 space-y-1">
                        <div class="flex items-start gap-2">
                            <span class="text-green-400">Helper:</span>
                            <span>app/Helpers/Functions.php:331-382</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="text-blue-400">Observer:</span>
                            <span>Modules/Page/app/Observers/PageObserver.php</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="text-purple-400">Component:</span>
                            <span>Modules/Page/app/Http/Livewire/Admin/PageManageComponent.php</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="text-orange-400">Log Gorunumu:</span>
                            <span>Modules/UserManagement/resources/views/livewire/activity-log-component.blade.php</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ana Bilesenler -->
        <h3 class="text-2xl font-bold mb-4 flex items-center gap-2">
            <i class="fas fa-puzzle-piece text-indigo-400"></i>
            Ana Bilesenler
        </h3>

        <div class="grid md:grid-cols-2 gap-4 mb-6">

            <!-- log_activity Helper -->
            <div class="bg-slate-800 rounded-xl p-5 border border-slate-700">
                <div class="flex items-center gap-3 mb-3">
                    <div class="w-10 h-10 bg-green-600/20 rounded-lg flex items-center justify-center">
                        <i class="fas fa-code text-green-400"></i>
                    </div>
                    <h4 class="font-bold text-lg">log_activity() Helper</h4>
                </div>
                <p class="text-slate-400 text-sm mb-3">
                    Global helper fonksiyon. Herhangi bir modelden log kaydi olusturur.
                </p>
                <div class="bg-slate-900 rounded p-3 text-xs font-mono text-slate-300 overflow-x-auto">
                    <pre>log_activity($model, 'eklendi');
log_activity($model, 'guncellendi', ['changed_fields' => [...]]);</pre>
                </div>
                <div class="mt-3 text-xs text-slate-500">
                    <i class="fas fa-map-marker-alt me-1"></i>
                    app/Helpers/Functions.php:331
                </div>
            </div>

            <!-- PageObserver -->
            <div class="bg-slate-800 rounded-xl p-5 border border-slate-700">
                <div class="flex items-center gap-3 mb-3">
                    <div class="w-10 h-10 bg-blue-600/20 rounded-lg flex items-center justify-center">
                        <i class="fas fa-eye text-blue-400"></i>
                    </div>
                    <h4 class="font-bold text-lg">PageObserver</h4>
                </div>
                <p class="text-slate-400 text-sm mb-3">
                    Model lifecycle event'lerinde otomatik log kaydeder.
                </p>
                <ul class="text-sm text-slate-400 space-y-1 ml-4 list-disc">
                    <li><code class="text-green-400">created()</code> - Sayfa olusturuldu</li>
                    <li><code class="text-yellow-400">updated()</code> - Sayfa guncellendi</li>
                    <li><code class="text-red-400">deleted()</code> - Sayfa silindi</li>
                    <li><code class="text-purple-400">restored()</code> - Sayfa geri yuklendi</li>
                </ul>
                <div class="mt-3 text-xs text-slate-500">
                    <i class="fas fa-map-marker-alt me-1"></i>
                    Modules/Page/app/Observers/PageObserver.php
                </div>
            </div>

            <!-- PageManageComponent -->
            <div class="bg-slate-800 rounded-xl p-5 border border-slate-700">
                <div class="flex items-center gap-3 mb-3">
                    <div class="w-10 h-10 bg-purple-600/20 rounded-lg flex items-center justify-center">
                        <i class="fas fa-save text-purple-400"></i>
                    </div>
                    <h4 class="font-bold text-lg">PageManageComponent</h4>
                </div>
                <p class="text-slate-400 text-sm mb-3">
                    save() metodunda manuel log_activity() cagrisi var.
                </p>
                <div class="bg-slate-900 rounded p-3 text-xs font-mono text-slate-300">
                    <pre>// Satir 477 ve 488
log_activity($page, 'guncellendi');
log_activity($page, 'eklendi');</pre>
                </div>
                <div class="mt-3 text-xs text-slate-500">
                    <i class="fas fa-map-marker-alt me-1"></i>
                    Modules/Page/app/Http/Livewire/Admin/PageManageComponent.php:477
                </div>
            </div>

            <!-- ActivityLogComponent -->
            <div class="bg-slate-800 rounded-xl p-5 border border-slate-700">
                <div class="flex items-center gap-3 mb-3">
                    <div class="w-10 h-10 bg-orange-600/20 rounded-lg flex items-center justify-center">
                        <i class="fas fa-list text-orange-400"></i>
                    </div>
                    <h4 class="font-bold text-lg">ActivityLogComponent</h4>
                </div>
                <p class="text-slate-400 text-sm mb-3">
                    Merkezi log goruntuleme bile≈üeni. Tum modullerin loglarini listeler.
                </p>
                <ul class="text-sm text-slate-400 space-y-1 ml-4 list-disc">
                    <li>Kullanici, modul, tarih filtreleme</li>
                    <li>Degisen alanlari gorme</li>
                    <li>Toplu silme (root icin)</li>
                    <li>Detay modal penceresi</li>
                </ul>
                <div class="mt-3 text-xs text-slate-500">
                    <i class="fas fa-map-marker-alt me-1"></i>
                    Modules/UserManagement/app/Http/Livewire/ActivityLogComponent.php
                </div>
            </div>
        </div>

        <!-- Onemli Tespit: Cakisma -->
        <div class="bg-amber-900/30 border border-amber-600 rounded-xl p-6 mb-6">
            <h3 class="text-xl font-bold text-amber-400 mb-4">
                <i class="fas fa-exclamation-triangle me-2"></i>Onemli Tespit: Potansiyel Cakisma
            </h3>
            <div class="space-y-3 text-slate-300">
                <p>
                    <strong>Sorun:</strong> PageManageComponent'ta <code class="text-amber-400">log_activity()</code>
                    manuel olarak cagriliyor, AYNI ZAMANDA PageObserver'da da otomatik log kaydediliyor.
                </p>
                <p>
                    <strong>Sonuc:</strong> Ayni islem icin <span class="text-red-400 font-bold">CIFT LOG</span>
                    olusabilir!
                </p>
                <div class="bg-slate-800 rounded-lg p-4 mt-3">
                    <h5 class="text-sm font-semibold text-slate-300 mb-2">Kontrol Edilmesi Gereken:</h5>
                    <ul class="text-sm text-slate-400 space-y-1 ml-4 list-disc">
                        <li>Observer'da created/updated event'lerinde zaten log kaydediliyor</li>
                        <li>Component'ta save() metodunda da log_activity() cagriliyor</li>
                        <li>Bu iki mekanizma ayni anda calisiyor olabilir</li>
                    </ul>
                </div>
                <div class="bg-green-900/30 rounded-lg p-4 mt-3">
                    <h5 class="text-sm font-semibold text-green-400 mb-2">
                        <i class="fas fa-lightbulb me-1"></i>Oneri:
                    </h5>
                    <p class="text-sm text-slate-400">
                        Ya Observer'dan ya da Component'tan log_activity() kaldirilmali.
                        Observer tercih edilir cunku daha tutarli ve merkezi.
                    </p>
                </div>
            </div>
        </div>

        <!-- Veri Akisi -->
        <div class="bg-slate-800 rounded-xl p-6 mb-6 border border-slate-700">
            <h3 class="text-xl font-bold mb-4">
                <i class="fas fa-stream text-cyan-400 me-2"></i>Log Kayit Akisi
            </h3>

            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <div class="flex-1 text-center p-4 bg-slate-700/50 rounded-lg">
                    <div class="w-12 h-12 bg-blue-600/30 rounded-full flex items-center justify-center mx-auto mb-2">
                        <i class="fas fa-user text-blue-400"></i>
                    </div>
                    <div class="text-sm font-medium">Kullanici</div>
                    <div class="text-xs text-slate-500">Sayfa kaydet</div>
                </div>

                <i class="fas fa-arrow-right text-slate-600 hidden md:block"></i>
                <i class="fas fa-arrow-down text-slate-600 md:hidden"></i>

                <div class="flex-1 text-center p-4 bg-slate-700/50 rounded-lg">
                    <div class="w-12 h-12 bg-purple-600/30 rounded-full flex items-center justify-center mx-auto mb-2">
                        <i class="fas fa-cog text-purple-400"></i>
                    </div>
                    <div class="text-sm font-medium">Livewire</div>
                    <div class="text-xs text-slate-500">save() metodu</div>
                </div>

                <i class="fas fa-arrow-right text-slate-600 hidden md:block"></i>
                <i class="fas fa-arrow-down text-slate-600 md:hidden"></i>

                <div class="flex-1 text-center p-4 bg-slate-700/50 rounded-lg">
                    <div class="w-12 h-12 bg-green-600/30 rounded-full flex items-center justify-center mx-auto mb-2">
                        <i class="fas fa-database text-green-400"></i>
                    </div>
                    <div class="text-sm font-medium">Eloquent</div>
                    <div class="text-xs text-slate-500">create/update</div>
                </div>

                <i class="fas fa-arrow-right text-slate-600 hidden md:block"></i>
                <i class="fas fa-arrow-down text-slate-600 md:hidden"></i>

                <div class="flex-1 text-center p-4 bg-slate-700/50 rounded-lg">
                    <div class="w-12 h-12 bg-orange-600/30 rounded-full flex items-center justify-center mx-auto mb-2">
                        <i class="fas fa-eye text-orange-400"></i>
                    </div>
                    <div class="text-sm font-medium">Observer</div>
                    <div class="text-xs text-slate-500">log_activity()</div>
                </div>

                <i class="fas fa-arrow-right text-slate-600 hidden md:block"></i>
                <i class="fas fa-arrow-down text-slate-600 md:hidden"></i>

                <div class="flex-1 text-center p-4 bg-slate-700/50 rounded-lg">
                    <div class="w-12 h-12 bg-red-600/30 rounded-full flex items-center justify-center mx-auto mb-2">
                        <i class="fas fa-history text-red-400"></i>
                    </div>
                    <div class="text-sm font-medium">activity_log</div>
                    <div class="text-xs text-slate-500">Veritabani</div>
                </div>
            </div>
        </div>

        <!-- View Durumu -->
        <div class="bg-slate-800 rounded-xl p-6 mb-6 border border-slate-700">
            <h3 class="text-xl font-bold mb-4">
                <i class="fas fa-desktop text-teal-400 me-2"></i>View Durumu
            </h3>

            <div class="grid md:grid-cols-2 gap-4">
                <div class="bg-red-900/20 border border-red-700/50 rounded-lg p-4">
                    <h4 class="font-semibold text-red-400 mb-2">
                        <i class="fas fa-times-circle me-1"></i>Page Manage View
                    </h4>
                    <p class="text-sm text-slate-400">
                        <code>page-manage-component.blade.php</code> dosyasinda
                        log goruntuleme bolumu <strong class="text-red-400">YOK</strong>.
                    </p>
                </div>

                <div class="bg-red-900/20 border border-red-700/50 rounded-lg p-4">
                    <h4 class="font-semibold text-red-400 mb-2">
                        <i class="fas fa-times-circle me-1"></i>Portfolio Manage View
                    </h4>
                    <p class="text-sm text-slate-400">
                        <code>portfolio-manage-component.blade.php</code> dosyasinda
                        log goruntuleme bolumu <strong class="text-red-400">YOK</strong>.
                    </p>
                </div>

                <div class="bg-green-900/20 border border-green-700/50 rounded-lg p-4 md:col-span-2">
                    <h4 class="font-semibold text-green-400 mb-2">
                        <i class="fas fa-check-circle me-1"></i>Merkezi Log Goruntuleme
                    </h4>
                    <p class="text-sm text-slate-400">
                        Tum loglar <strong>Kullanici Yonetimi > Etkinlik Loglari</strong>
                        sayfasindan goruntulenebilir. UserManagement modulunde.
                    </p>
                    <div class="mt-2 text-xs text-slate-500">
                        Route: <code>/admin/usermanagement/activity-logs</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- Kayit Edilen Bilgiler -->
        <div class="bg-slate-800 rounded-xl p-6 mb-6 border border-slate-700">
            <h3 class="text-xl font-bold mb-4">
                <i class="fas fa-database text-pink-400 me-2"></i>Kayit Edilen Bilgiler
            </h3>

            <div class="overflow-x-auto">
                <table class="w-full text-sm">
                    <thead>
                        <tr class="border-b border-slate-700">
                            <th class="text-left py-2 px-3 text-slate-400">Alan</th>
                            <th class="text-left py-2 px-3 text-slate-400">Aciklama</th>
                            <th class="text-left py-2 px-3 text-slate-400">Ornek</th>
                        </tr>
                    </thead>
                    <tbody class="text-slate-300">
                        <tr class="border-b border-slate-700/50">
                            <td class="py-2 px-3 font-mono text-blue-400">log_name</td>
                            <td class="py-2 px-3">Model adi</td>
                            <td class="py-2 px-3 text-slate-500">Page, Portfolio, Blog</td>
                        </tr>
                        <tr class="border-b border-slate-700/50">
                            <td class="py-2 px-3 font-mono text-blue-400">description</td>
                            <td class="py-2 px-3">Islem aciklamasi</td>
                            <td class="py-2 px-3 text-slate-500">"Hakkimizda guncellendi"</td>
                        </tr>
                        <tr class="border-b border-slate-700/50">
                            <td class="py-2 px-3 font-mono text-blue-400">event</td>
                            <td class="py-2 px-3">Event key</td>
                            <td class="py-2 px-3 text-slate-500">eklendi, guncellendi, silindi</td>
                        </tr>
                        <tr class="border-b border-slate-700/50">
                            <td class="py-2 px-3 font-mono text-blue-400">subject_type</td>
                            <td class="py-2 px-3">Model class</td>
                            <td class="py-2 px-3 text-slate-500">Modules\Page\App\Models\Page</td>
                        </tr>
                        <tr class="border-b border-slate-700/50">
                            <td class="py-2 px-3 font-mono text-blue-400">subject_id</td>
                            <td class="py-2 px-3">Model ID</td>
                            <td class="py-2 px-3 text-slate-500">42</td>
                        </tr>
                        <tr class="border-b border-slate-700/50">
                            <td class="py-2 px-3 font-mono text-blue-400">causer_type</td>
                            <td class="py-2 px-3">Islemi yapan model</td>
                            <td class="py-2 px-3 text-slate-500">App\Models\User</td>
                        </tr>
                        <tr class="border-b border-slate-700/50">
                            <td class="py-2 px-3 font-mono text-blue-400">causer_id</td>
                            <td class="py-2 px-3">Kullanici ID</td>
                            <td class="py-2 px-3 text-slate-500">1</td>
                        </tr>
                        <tr class="border-b border-slate-700/50">
                            <td class="py-2 px-3 font-mono text-blue-400">properties</td>
                            <td class="py-2 px-3">Ek bilgiler (JSON)</td>
                            <td class="py-2 px-3 text-slate-500">{baslik, modul, degisenler}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Ozet -->
        <div class="bg-gradient-to-r from-indigo-900/50 to-purple-900/50 rounded-xl p-6 border border-indigo-700">
            <h3 class="text-xl font-bold mb-4">
                <i class="fas fa-clipboard-list text-indigo-400 me-2"></i>Ozet
            </h3>
            <ul class="space-y-2 text-slate-300">
                <li class="flex items-start gap-2">
                    <i class="fas fa-check text-green-400 mt-1"></i>
                    <span>Spatie ActivityLog ile profesyonel log sistemi mevcut</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-check text-green-400 mt-1"></i>
                    <span>Observer pattern ile otomatik loglama aktif</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-check text-green-400 mt-1"></i>
                    <span>Merkezi log goruntuleme sayfasi mevcut (UserManagement)</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-exclamation text-amber-400 mt-1"></i>
                    <span>Component + Observer cift loglama riski var</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-info text-blue-400 mt-1"></i>
                    <span>Page/Portfolio manage sayfalarinda inline log goruntuleme yok</span>
                </li>
            </ul>
        </div>

        <!-- Footer -->
        <footer class="mt-8 text-center text-slate-600 text-sm">
            <p>
                <i class="fas fa-robot me-1"></i>
                Claude AI tarafindan olusturuldu
            </p>
        </footer>
    </div>
</body>
</html>
