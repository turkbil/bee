<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shuffle (KarÄ±ÅŸÄ±k Ã‡alma) - Fisher-Yates AlgoritmasÄ±</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: linear-gradient(135deg, #0a0e1a 0%, #1a1f35 100%);
            color: #e2e8f0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            line-height: 1.8;
            padding: 40px 20px;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { font-size: 3rem; color: #1DB954; margin-bottom: 30px; }
        h2 { font-size: 2rem; color: #60a5fa; margin: 40px 0 20px 0; }
        h3 { font-size: 1.5rem; color: #a78bfa; margin: 30px 0 15px 0; }
        .code-block {
            background: #0f172a;
            border: 1px solid #334155;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            overflow-x: auto;
        }
        pre { color: #cbd5e1; font-size: 0.95rem; line-height: 1.6; }
        .highlight { background: rgba(29, 185, 84, 0.2); padding: 2px 6px; border-radius: 4px; color: #1ed760; }
        .critical { background: rgba(239, 68, 68, 0.2); padding: 20px; border-left: 4px solid #ef4444; border-radius: 8px; margin: 20px 0; }
        .success { background: rgba(29, 185, 84, 0.2); padding: 20px; border-left: 4px solid #1DB954; border-radius: 8px; margin: 20px 0; }
        .info { background: rgba(59, 130, 246, 0.2); padding: 20px; border-left: 4px solid #3b82f6; border-radius: 8px; margin: 20px 0; }
        ul, ol { margin: 20px 0; padding-left: 30px; }
        li { margin: 12px 0; }
        .back { display: inline-block; padding: 12px 24px; background: #1DB954; color: #000; text-decoration: none; border-radius: 8px; font-weight: 700; margin-bottom: 30px; }
        .back:hover { background: #1ed760; }
        .demo-box {
            background: #1e293b;
            border: 1px solid #334155;
            padding: 30px;
            border-radius: 12px;
            margin: 30px 0;
        }
        .song-list {
            display: grid;
            gap: 10px;
            margin: 20px 0;
        }
        .song-item {
            background: #0f172a;
            padding: 15px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-left: 3px solid #3b82f6;
        }
        .song-index {
            font-weight: 700;
            color: #60a5fa;
            font-size: 1.2rem;
            min-width: 30px;
        }
        .song-info { flex: 1; }
        .song-title { font-weight: 600; color: white; }
        .song-artist { color: #94a3b8; font-size: 0.9rem; }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back">â† TÃ¼m Ã–zelliklere DÃ¶n</a>

        <h1>ğŸ”€ Shuffle (KarÄ±ÅŸÄ±k Ã‡alma)</h1>

        <div class="critical">
            <h3>ğŸ”´ MEVCUT DURUM: Shuffle Butonu Ã‡alÄ±ÅŸmÄ±yor!</h3>
            <p>Kod satÄ±r 98: <code>shuffle: false</code> state var.</p>
            <p>Kod satÄ±r 237: <code>@click="shuffle = !shuffle"</code> butonu var.</p>
            <p><strong>AMA:</strong> Shuffle toggle olduÄŸunda queue'yu karÄ±ÅŸtÄ±ran FONKSÄ°YON YOK!</p>
        </div>

        <div class="success">
            <h3>âœ… Ã‡Ã–ZÃœM: Fisher-Yates Shuffle AlgoritmasÄ±</h3>
            <p>Modern, etkili ve adil karÄ±ÅŸtÄ±rma algoritmasÄ±. O(n) complexity.</p>
        </div>

        <h2>ğŸ¯ NasÄ±l Ã‡alÄ±ÅŸÄ±r?</h2>

        <div class="info">
            <h3>Fisher-Yates MantÄ±ÄŸÄ±:</h3>
            <ol>
                <li>Queue'nun sonundan baÅŸla</li>
                <li>Rastgele bir index seÃ§ (0 ile ÅŸu anki index arasÄ±)</li>
                <li>Ä°ki elemanÄ±n yerini deÄŸiÅŸtir</li>
                <li>Bir Ã¶nceki elemana geÃ§ ve tekrarla</li>
                <li>Queue baÅŸÄ±na gelene kadar devam et</li>
            </ol>
        </div>

        <h2>ğŸ’» Ä°mplementasyon</h2>

        <h3>1. Shuffle Fonksiyonu (Fisher-Yates)</h3>
        <div class="code-block">
<pre>// Fisher-Yates shuffle algorithm
shuffleArray(array) {
    const arr = [...array]; // Shallow copy (orijinali korur)

    for (let i = arr.length - 1; i > 0; i--) {
        // 0 ile i arasÄ±nda rastgele index
        const j = Math.floor(Math.random() * (i + 1));

        // Swap (yer deÄŸiÅŸtir)
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }

    return arr;
}</pre>
        </div>

        <h3>2. Toggle Shuffle (Aktif/Pasif)</h3>
        <div class="code-block">
<pre>// Shuffle toggle fonksiyonu
toggleShuffle() {
    this.shuffle = !this.shuffle;

    if (this.shuffle) {
        // Shuffle AÃ‡ILDI - Queue'yu karÄ±ÅŸtÄ±r

        // 1. Åu an Ã§alan ÅŸarkÄ±yÄ± kaydet
        const currentSong = this.queue[this.queueIndex];

        // 2. Åu an Ã§alan ÅŸarkÄ±yÄ± queue'dan Ã§Ä±kar
        const restOfQueue = [
            ...this.queue.slice(0, this.queueIndex),
            ...this.queue.slice(this.queueIndex + 1)
        ];

        // 3. Geri kalanlarÄ± karÄ±ÅŸtÄ±r
        const shuffled = this.shuffleArray(restOfQueue);

        // 4. Åu an Ã§alan ÅŸarkÄ±yÄ± baÅŸa koy
        this.queue = [currentSong, ...shuffled];

        // 5. Index'i 0'a Ã§ek (Ã§alan ÅŸarkÄ± baÅŸta)
        this.queueIndex = 0;

        // 6. Orijinal sÄ±rayÄ± sakla (kapatÄ±nca geri dÃ¶ner)
        this.originalQueue = [...this.queue];

        console.log('ğŸ”€ Shuffle ON: Queue karÄ±ÅŸtÄ±rÄ±ldÄ±');
        this.showToast('KarÄ±ÅŸÄ±k Ã§alma aÃ§Ä±k', 'success');
    } else {
        // Shuffle KAPANDI - Orijinal sÄ±raya dÃ¶n

        if (this.originalQueue && this.originalQueue.length > 0) {
            // Orijinal sÄ±ra varsa geri yÃ¼kle
            this.queue = [...this.originalQueue];
            this.originalQueue = null;

            console.log('ğŸ”€ Shuffle OFF: Orijinal sÄ±ra geri yÃ¼klendi');
            this.showToast('KarÄ±ÅŸÄ±k Ã§alma kapalÄ±', 'info');
        }
    }
}</pre>
        </div>

        <h3>3. State Eklemeleri</h3>
        <div class="code-block">
<pre>// Alpine.js data() iÃ§ine ekle
data() {
    return {
        // ... mevcut state'ler

        shuffle: false,              // Shuffle aktif mi?
        originalQueue: null,         // Orijinal queue sÄ±rasÄ± (shuffle iÃ§in)

        // ... diÄŸer state'ler
    };
}</pre>
        </div>

        <h2>ğŸ“Š GÃ¶rsel Ã–rnek</h2>

        <div class="demo-box">
            <h3>Ã–NCE (Orijinal SÄ±ra):</h3>
            <div class="song-list">
                <div class="song-item">
                    <div class="song-index">1</div>
                    <div class="song-info">
                        <div class="song-title">Smooth Jazz Morning</div>
                        <div class="song-artist">Jazz Ensemble</div>
                    </div>
                </div>
                <div class="song-item">
                    <div class="song-index">2</div>
                    <div class="song-info">
                        <div class="song-title">Coffee Break Blues</div>
                        <div class="song-artist">Blue Notes</div>
                    </div>
                </div>
                <div class="song-item">
                    <div class="song-index">3</div>
                    <div class="song-info">
                        <div class="song-title">Sunset Serenade</div>
                        <div class="song-artist">Evening Jazz</div>
                    </div>
                </div>
                <div class="song-item">
                    <div class="song-index">4</div>
                    <div class="song-info">
                        <div class="song-title">Midnight Groove</div>
                        <div class="song-artist">Late Night Band</div>
                    </div>
                </div>
                <div class="song-item">
                    <div class="song-index">5</div>
                    <div class="song-info">
                        <div class="song-title">Urban Vibes</div>
                        <div class="song-artist">City Jazz</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="demo-box">
            <h3>ğŸ”€ SONRA (Shuffle Aktif - ÅarkÄ± 2 Ã§alÄ±yordu):</h3>
            <div class="song-list">
                <div class="song-item" style="border-left-color: #1DB954; background: rgba(29, 185, 84, 0.1);">
                    <div class="song-index" style="color: #1DB954;">â–º</div>
                    <div class="song-info">
                        <div class="song-title">Coffee Break Blues</div>
                        <div class="song-artist">Blue Notes</div>
                    </div>
                </div>
                <div class="song-item">
                    <div class="song-index">2</div>
                    <div class="song-info">
                        <div class="song-title">Midnight Groove</div>
                        <div class="song-artist">Late Night Band</div>
                    </div>
                </div>
                <div class="song-item">
                    <div class="song-index">3</div>
                    <div class="song-info">
                        <div class="song-title">Smooth Jazz Morning</div>
                        <div class="song-artist">Jazz Ensemble</div>
                    </div>
                </div>
                <div class="song-item">
                    <div class="song-index">4</div>
                    <div class="song-info">
                        <div class="song-title">Urban Vibes</div>
                        <div class="song-artist">City Jazz</div>
                    </div>
                </div>
                <div class="song-item">
                    <div class="song-index">5</div>
                    <div class="song-info">
                        <div class="song-title">Sunset Serenade</div>
                        <div class="song-artist">Evening Jazz</div>
                    </div>
                </div>
            </div>
            <p style="color: #1DB954; margin-top: 15px;">
                âœ… Ã‡alan ÅŸarkÄ± baÅŸa alÄ±ndÄ±, geri kalanlar karÄ±ÅŸtÄ±rÄ±ldÄ±!
            </p>
        </div>

        <h2>ğŸ›ï¸ KullanÄ±cÄ± SenaryolarÄ±</h2>

        <div class="info">
            <h3>Senaryo 1: Shuffle Aktif Ederken</h3>
            <ul>
                <li><strong>Durum:</strong> Playlist Ã§alÄ±yor, 12. ÅŸarkÄ±dasÄ±n</li>
                <li><strong>Eylem:</strong> Shuffle butonuna tÄ±kladÄ±n</li>
                <li><strong>SonuÃ§:</strong>
                    <ul>
                        <li>12. ÅŸarkÄ± baÅŸa alÄ±ndÄ± (index 0)</li>
                        <li>Geri kalan ÅŸarkÄ±lar karÄ±ÅŸtÄ±rÄ±ldÄ±</li>
                        <li>Ã‡alma kesintisiz devam ediyor</li>
                    </ul>
                </li>
            </ul>
        </div>

        <div class="info">
            <h3>Senaryo 2: Shuffle KapatÄ±rken</h3>
            <ul>
                <li><strong>Durum:</strong> Shuffle aÃ§Ä±k, karÄ±ÅŸÄ±k sÄ±rada Ã§alÄ±yorsun</li>
                <li><strong>Eylem:</strong> Shuffle butonuna tekrar tÄ±kladÄ±n</li>
                <li><strong>SonuÃ§:</strong>
                    <ul>
                        <li>Orijinal sÄ±ra geri yÃ¼klendi</li>
                        <li>Åu an Ã§alan ÅŸarkÄ±nÄ±n orijinal konumu bulundu</li>
                        <li>Queue orijinal sÄ±rasÄ±na dÃ¶ndÃ¼</li>
                    </ul>
                </li>
            </ul>
        </div>

        <h2>ğŸ’¡ GeliÅŸmiÅŸ Ã–zellikler (Opsiyonel)</h2>

        <div class="code-block">
<pre>// Smart Shuffle (aynÄ± sanatÃ§Ä± peÅŸ peÅŸe gelmez)
smartShuffle(array) {
    let shuffled = this.shuffleArray(array);

    // AynÄ± sanatÃ§Ä± peÅŸ peÅŸe gelirse yeniden karÄ±ÅŸtÄ±r
    for (let i = 0; i < shuffled.length - 1; i++) {
        if (shuffled[i].artist_id === shuffled[i + 1].artist_id) {
            // Sonraki farklÄ± sanatÃ§Ä±yÄ± bul
            for (let j = i + 2; j < shuffled.length; j++) {
                if (shuffled[j].artist_id !== shuffled[i].artist_id) {
                    // Swap
                    [shuffled[i + 1], shuffled[j]] = [shuffled[j], shuffled[i + 1]];
                    break;
                }
            }
        }
    }

    return shuffled;
}</pre>
        </div>

        <h2>âœ… Avantajlar</h2>
        <ul>
            <li>âœ… <span class="highlight">Adil KarÄ±ÅŸtÄ±rma:</span> Her permÃ¼tasyon eÅŸit olasÄ±lÄ±kla seÃ§ilir</li>
            <li>âœ… <span class="highlight">PerformanslÄ±:</span> O(n) complexity, hÄ±zlÄ± Ã§alÄ±ÅŸÄ±r</li>
            <li>âœ… <span class="highlight">Kesintisiz:</span> Ã‡alan ÅŸarkÄ± durmadan shuffle olur</li>
            <li>âœ… <span class="highlight">Geri DÃ¶nebilir:</span> Orijinal sÄ±ra saklanÄ±r</li>
            <li>âœ… <span class="highlight">B2B Uyumlu:</span> Queue persistence ile birlikte Ã§alÄ±ÅŸÄ±r</li>
        </ul>

        <h2>ğŸ”§ Test Senaryosu</h2>
        <div class="code-block">
<pre>// Console'da test et
console.log('Orijinal queue:', this.queue.map(s => s.song_title));

// Shuffle aÃ§
this.toggleShuffle();
console.log('Shuffled queue:', this.queue.map(s => s.song_title));

// Shuffle kapat
this.toggleShuffle();
console.log('Restored queue:', this.queue.map(s => s.song_title));

// AynÄ± mÄ± kontrol et
console.log('Orijinal sÄ±ra geri dÃ¶ndÃ¼ mÃ¼?', /* karÅŸÄ±laÅŸtÄ±rma */);</pre>
        </div>

        <p style="margin-top: 40px; text-align: center; color: #64748b;">
            <a href="index.html" class="back">â† TÃ¼m Ã–zelliklere DÃ¶n</a>
        </p>
    </div>
</body>
</html>
