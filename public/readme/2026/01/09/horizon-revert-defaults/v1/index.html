<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horizon VarsayÄ±lan AyarlarÄ±na DÃ¶ndÃ¼rme KÄ±lavuzu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        slate: {
                            850: '#1a202e',
                            950: '#0f1419'
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-slate-900 text-white min-h-screen">
    <div class="max-w-6xl mx-auto p-6 md:p-8">
        <!-- Header -->
        <header class="mb-8 pb-6 border-b border-slate-700">
            <div class="flex items-center gap-3 mb-4">
                <span class="px-3 py-1 bg-yellow-900/30 text-yellow-400 text-sm font-medium rounded-full border border-yellow-800">
                    âš™ï¸ KonfigÃ¼rasyon
                </span>
                <span class="text-slate-500">â€¢</span>
                <span class="text-slate-400 text-sm">9 Ocak 2026 - 11:05</span>
            </div>
            <h1 class="text-4xl font-bold mb-3 text-white">Horizon VarsayÄ±lan AyarlarÄ±na DÃ¶ndÃ¼rme</h1>
            <p class="text-slate-400 text-lg">Kuyruk kapasitesini yÃ¼ksek ayarlara Ã§Ä±kardÄ±ktan sonra geri alma rehberi</p>
        </header>

        <!-- Basit AnlatÄ±m -->
        <div class="bg-green-900/20 border border-green-800 rounded-lg p-6 mb-6">
            <h3 class="text-xl font-semibold mb-4 text-green-400">ğŸ“ Basit AnlatÄ±m (Herkes Ä°Ã§in)</h3>
            <div class="space-y-3 text-slate-300">
                <p>
                    <strong>Ne YaptÄ±k?</strong><br>
                    Horizon kuyruk sisteminin kapasitesini Ã§ok yÃ¼kseÄŸe Ã§Ä±kardÄ±k:
                </p>
                <ul class="list-disc list-inside space-y-2 ml-4">
                    <li>Worker sayÄ±sÄ±: 2-6 â†’ 6-20 (En az 6, en fazla 20 iÅŸÃ§i Ã§alÄ±ÅŸÄ±yor)</li>
                    <li>Ä°ÅŸ limiti: 200-300 â†’ 2000 (Her iÅŸÃ§i 2000 iÅŸ yapabilir)</li>
                    <li>AmaÃ§: 184 AI gÃ¶rseli + HLS dÃ¶nÃ¼ÅŸÃ¼mleri hÄ±zlÄ± yapmak</li>
                </ul>
                <p class="mt-4">
                    <strong>Ne Zaman Geri AlmalÄ±yÄ±m?</strong>
                </p>
                <ul class="list-disc list-inside space-y-2 ml-4">
                    <li>Sunucu CPU kullanÄ±mÄ± Ã§ok yÃ¼ksekse (%80-100)</li>
                    <li>HafÄ±za (RAM) doluyorsa</li>
                    <li>Site yavaÅŸlamaya baÅŸladÄ±ysa</li>
                    <li>YoÄŸun iÅŸler bittiyse (AI gÃ¶rselleri tamamlandÄ±)</li>
                </ul>
                <p class="mt-4 text-green-300 font-medium">
                    âœ… Geri alma iÅŸlemi 2 dakika sÃ¼rer ve tamamen gÃ¼venlidir.
                </p>
            </div>
        </div>

        <!-- Teknik Detaylar -->
        <div class="bg-blue-900/20 border border-blue-800 rounded-lg p-6 mb-6">
            <h3 class="text-xl font-semibold mb-4 text-blue-400">ğŸ”§ Teknik Detaylar (GeliÅŸtiriciler Ä°Ã§in)</h3>
            <div class="space-y-4 text-slate-300">
                <div>
                    <h4 class="font-semibold text-white mb-2">ğŸ“ Dosya:</h4>
                    <code class="text-sm text-blue-300">config/horizon.php</code>
                </div>

                <div>
                    <h4 class="font-semibold text-white mb-2">ğŸ“Š DeÄŸiÅŸiklik Tablosu:</h4>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm border border-slate-700 rounded">
                            <thead class="bg-slate-800">
                                <tr>
                                    <th class="px-4 py-2 text-left border-b border-slate-700">Parametre</th>
                                    <th class="px-4 py-2 text-left border-b border-slate-700">Eski (VarsayÄ±lan)</th>
                                    <th class="px-4 py-2 text-left border-b border-slate-700">Yeni (YÃ¼ksek Kapasite)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b border-slate-700">
                                    <td class="px-4 py-2 font-mono text-yellow-400">minProcesses</td>
                                    <td class="px-4 py-2">2</td>
                                    <td class="px-4 py-2 text-green-400 font-bold">6</td>
                                </tr>
                                <tr class="border-b border-slate-700">
                                    <td class="px-4 py-2 font-mono text-yellow-400">maxProcesses</td>
                                    <td class="px-4 py-2">6</td>
                                    <td class="px-4 py-2 text-green-400 font-bold">20</td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-2 font-mono text-yellow-400">maxJobs</td>
                                    <td class="px-4 py-2">200</td>
                                    <td class="px-4 py-2 text-green-400 font-bold">2000</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div>
                    <h4 class="font-semibold text-white mb-2">ğŸ¯ Etkilenen Supervisor:</h4>
                    <code class="text-sm text-blue-300">muzibu-supervisor</code>
                    <p class="text-slate-400 text-sm mt-1">
                        (muzibu_my_playlist, muzibu_hls, muzibu_seo kuyruklarÄ±)
                    </p>
                </div>

                <div>
                    <h4 class="font-semibold text-white mb-2">âš ï¸ Yan Etkiler:</h4>
                    <ul class="list-disc list-inside space-y-1 ml-4 text-sm text-slate-400">
                        <li>YÃ¼ksek CPU kullanÄ±mÄ± (20 worker eÅŸ zamanlÄ± Ã§alÄ±ÅŸabilir)</li>
                        <li>YÃ¼ksek RAM kullanÄ±mÄ± (her worker ~256-512MB)</li>
                        <li>YÃ¼ksek Redis baÄŸlantÄ± sayÄ±sÄ±</li>
                        <li>YÃ¼ksek API Ã§aÄŸrÄ± hÄ±zÄ± (Leonardo AI, OpenAI)</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Geri Alma AdÄ±mlarÄ± -->
        <div class="bg-slate-800 rounded-lg p-6 mb-6">
            <h3 class="text-2xl font-semibold mb-6 text-white">ğŸ“‹ Geri Alma AdÄ±mlarÄ±</h3>

            <!-- AdÄ±m 1 -->
            <div class="mb-6 p-5 bg-slate-850 rounded-lg border border-slate-700">
                <div class="flex items-start gap-3 mb-3">
                    <span class="flex-shrink-0 w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center font-bold text-sm">1</span>
                    <h4 class="text-lg font-semibold text-white">Config DosyasÄ±nÄ± DÃ¼zenle</h4>
                </div>
                <div class="ml-11 space-y-3">
                    <p class="text-slate-300">DosyayÄ± aÃ§:</p>
                    <pre class="bg-slate-950 text-blue-300 p-3 rounded text-sm overflow-x-auto">nano /var/www/vhosts/muzibu.com.tr/httpdocs/config/horizon.php</pre>

                    <p class="text-slate-300 mt-3">SatÄ±r 230-233'Ã¼ bul ve deÄŸiÅŸtir:</p>
                    <div class="grid md:grid-cols-2 gap-3 mt-2">
                        <div>
                            <p class="text-red-400 text-xs mb-1">âŒ Åu anki (YÃ¼ksek):</p>
                            <pre class="bg-slate-950 text-red-300 p-3 rounded text-xs">minProcesses => 6
maxProcesses => 20
maxJobs => 2000</pre>
                        </div>
                        <div>
                            <p class="text-green-400 text-xs mb-1">âœ… VarsayÄ±lan (Normal):</p>
                            <pre class="bg-slate-950 text-green-300 p-3 rounded text-xs">minProcesses => 2
maxProcesses => 6
maxJobs => 200</pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AdÄ±m 2 -->
            <div class="mb-6 p-5 bg-slate-850 rounded-lg border border-slate-700">
                <div class="flex items-start gap-3 mb-3">
                    <span class="flex-shrink-0 w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center font-bold text-sm">2</span>
                    <h4 class="text-lg font-semibold text-white">Ä°zinleri DÃ¼zelt</h4>
                </div>
                <div class="ml-11 space-y-3">
                    <p class="text-slate-300">Dosya kaydedildikten sonra izinleri dÃ¼zelt:</p>
                    <pre class="bg-slate-950 text-blue-300 p-3 rounded text-sm overflow-x-auto">sudo chown tuufi.com_:psaserv /var/www/vhosts/muzibu.com.tr/httpdocs/config/horizon.php
sudo chmod 644 /var/www/vhosts/muzibu.com.tr/httpdocs/config/horizon.php</pre>
                </div>
            </div>

            <!-- AdÄ±m 3 -->
            <div class="mb-6 p-5 bg-slate-850 rounded-lg border border-slate-700">
                <div class="flex items-start gap-3 mb-3">
                    <span class="flex-shrink-0 w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center font-bold text-sm">3</span>
                    <h4 class="text-lg font-semibold text-white">Cache Temizle</h4>
                </div>
                <div class="ml-11 space-y-3">
                    <p class="text-slate-300">Config cache'i temizle:</p>
                    <pre class="bg-slate-950 text-blue-300 p-3 rounded text-sm overflow-x-auto">/opt/plesk/php/8.5/bin/php artisan config:clear</pre>
                </div>
            </div>

            <!-- AdÄ±m 4 -->
            <div class="mb-6 p-5 bg-slate-850 rounded-lg border border-slate-700">
                <div class="flex items-start gap-3 mb-3">
                    <span class="flex-shrink-0 w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center font-bold text-sm">4</span>
                    <h4 class="text-lg font-semibold text-white">Horizon'u Restart Et</h4>
                </div>
                <div class="ml-11 space-y-3">
                    <p class="text-slate-300">Horizon'u durdur (otomatik baÅŸlayacak):</p>
                    <pre class="bg-slate-950 text-blue-300 p-3 rounded text-sm overflow-x-auto">/opt/plesk/php/8.5/bin/php artisan horizon:terminate</pre>
                    <p class="text-slate-400 text-sm mt-2">
                        â„¹ï¸ horizon-keeper.sh scripti 30 saniye iÃ§inde otomatik baÅŸlatacak.
                    </p>
                </div>
            </div>

            <!-- AdÄ±m 5 -->
            <div class="p-5 bg-slate-850 rounded-lg border border-slate-700">
                <div class="flex items-start gap-3 mb-3">
                    <span class="flex-shrink-0 w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center font-bold text-sm">5</span>
                    <h4 class="text-lg font-semibold text-white">DoÄŸrulama</h4>
                </div>
                <div class="ml-11 space-y-3">
                    <p class="text-slate-300">Worker sayÄ±sÄ±nÄ± kontrol et:</p>
                    <pre class="bg-slate-950 text-blue-300 p-3 rounded text-sm overflow-x-auto">ps aux | grep "horizon:work" | grep -v grep | wc -l</pre>
                    <p class="text-slate-400 text-sm mt-2">
                        Beklenen sonuÃ§: 6-10 worker (varsayÄ±lan ayarlarda)
                    </p>
                    <p class="text-slate-300 mt-3">DetaylÄ± kontrol (ilk 3 worker):</p>
                    <pre class="bg-slate-950 text-blue-300 p-3 rounded text-sm overflow-x-auto">ps aux | grep "horizon:work" | grep -v grep | head -3</pre>
                    <p class="text-slate-400 text-sm mt-2">
                        Kontrol: <code class="text-yellow-400">--max-jobs=200</code> olmalÄ± (2000 deÄŸil!)
                    </p>
                </div>
            </div>
        </div>

        <!-- Tek Komutla Geri Alma -->
        <div class="bg-purple-900/20 border border-purple-800 rounded-lg p-6 mb-6">
            <h3 class="text-xl font-semibold mb-4 text-purple-400">âš¡ Tek Komutla Geri Alma (Ä°leri Seviye)</h3>
            <div class="space-y-3 text-slate-300">
                <p>TÃ¼m adÄ±mlarÄ± tek komutla yapabilirsiniz:</p>
                <pre class="bg-slate-950 text-purple-300 p-4 rounded text-sm overflow-x-auto whitespace-pre-wrap">sed -i "s/'minProcesses' => 6/'minProcesses' => 2/g" /var/www/vhosts/muzibu.com.tr/httpdocs/config/horizon.php && \
sed -i "s/'maxProcesses' => 20/'maxProcesses' => 6/g" /var/www/vhosts/muzibu.com.tr/httpdocs/config/horizon.php && \
sed -i "s/'maxJobs' => 2000/'maxJobs' => 200/g" /var/www/vhosts/muzibu.com.tr/httpdocs/config/horizon.php && \
sudo chown tuufi.com_:psaserv /var/www/vhosts/muzibu.com.tr/httpdocs/config/horizon.php && \
/opt/plesk/php/8.5/bin/php artisan config:clear && \
/opt/plesk/php/8.5/bin/php artisan horizon:terminate && \
echo "âœ… Horizon varsayÄ±lan ayarlara dÃ¶ndÃ¼rÃ¼ldÃ¼! 30 saniye iÃ§inde yeniden baÅŸlayacak."</pre>
                <p class="text-yellow-300 text-sm mt-3">
                    âš ï¸ Bu komut tÃ¼m deÄŸiÅŸiklikleri geri alÄ±r. Dikkatli kullanÄ±n!
                </p>
            </div>
        </div>

        <!-- YÃ¼ksek Kapasite Ne Zaman Gerekli? -->
        <div class="bg-orange-900/20 border border-orange-800 rounded-lg p-6 mb-6">
            <h3 class="text-xl font-semibold mb-4 text-orange-400">ğŸ¯ YÃ¼ksek Kapasite Ne Zaman Gerekli?</h3>
            <div class="space-y-3 text-slate-300">
                <p class="font-medium text-white">YÃ¼ksek kapasiteyi (2000 maxJobs) ÅŸu durumlarda kullanÄ±n:</p>
                <ul class="list-disc list-inside space-y-2 ml-4">
                    <li>Toplu AI gÃ¶rsel Ã¼retimi (100+ resim)</li>
                    <li>Toplu HLS dÃ¶nÃ¼ÅŸÃ¼mÃ¼ (50+ ÅŸarkÄ±)</li>
                    <li>Toplu SEO oluÅŸturma (100+ sayfa)</li>
                    <li>Migration sonrasÄ± data iÅŸleme</li>
                    <li>BÃ¼yÃ¼k import iÅŸlemleri</li>
                </ul>
                <p class="font-medium text-white mt-4">VarsayÄ±lan ayarlara (200 maxJobs) dÃ¶nÃ¼n:</p>
                <ul class="list-disc list-inside space-y-2 ml-4">
                    <li>YoÄŸun iÅŸler tamamlandÄ±ÄŸÄ±nda</li>
                    <li>Normal iÅŸletme modunda (gÃ¼nlÃ¼k site kullanÄ±mÄ±)</li>
                    <li>Sunucu kaynaklarÄ±nÄ± korumak iÃ§in</li>
                    <li>CPU/RAM kullanÄ±mÄ± yÃ¼ksekse</li>
                </ul>
            </div>
        </div>

        <!-- Sorun Giderme -->
        <div class="bg-red-900/20 border border-red-800 rounded-lg p-6 mb-6">
            <h3 class="text-xl font-semibold mb-4 text-red-400">ğŸ”§ Sorun Giderme</h3>
            <div class="space-y-4 text-slate-300">
                <div>
                    <h4 class="font-semibold text-white mb-2">Horizon baÅŸlamÄ±yor:</h4>
                    <pre class="bg-slate-950 text-red-300 p-3 rounded text-sm overflow-x-auto">tail -n 50 /tmp/horizon-output.log</pre>
                    <p class="text-slate-400 text-sm mt-1">Log dosyasÄ±nÄ± kontrol edin, hata varsa gÃ¶receksiniz.</p>
                </div>

                <div>
                    <h4 class="font-semibold text-white mb-2">Worker sayÄ±sÄ± hala yÃ¼ksek:</h4>
                    <pre class="bg-slate-950 text-red-300 p-3 rounded text-sm overflow-x-auto">php artisan config:cache</pre>
                    <p class="text-slate-400 text-sm mt-1">Config'i yeniden cache'leyin ve Horizon'u tekrar restart edin.</p>
                </div>

                <div>
                    <h4 class="font-semibold text-white mb-2">horizon-keeper scripti Ã§alÄ±ÅŸmÄ±yor:</h4>
                    <pre class="bg-slate-950 text-red-300 p-3 rounded text-sm overflow-x-auto">nohup /bin/bash /tmp/horizon-keeper.sh &</pre>
                    <p class="text-slate-400 text-sm mt-1">Scripti manuel baÅŸlatÄ±n.</p>
                </div>

                <div>
                    <h4 class="font-semibold text-white mb-2">Manuel restart gerekiyorsa:</h4>
                    <pre class="bg-slate-950 text-red-300 p-3 rounded text-sm overflow-x-auto">nohup /opt/plesk/php/8.5/bin/php artisan horizon >> /tmp/horizon-output.log 2>&1 &</pre>
                </div>
            </div>
        </div>

        <!-- Ã–zet -->
        <div class="bg-slate-800 rounded-lg p-6">
            <h3 class="text-xl font-semibold mb-4 text-white">ğŸ“Œ Ã–zet</h3>
            <div class="space-y-3 text-slate-300">
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="bg-green-900/20 border border-green-800 rounded p-4">
                        <h4 class="font-semibold text-green-400 mb-2">âœ… YÃ¼ksek Kapasite</h4>
                        <ul class="text-sm space-y-1">
                            <li>6-20 worker</li>
                            <li>2000 iÅŸ/worker</li>
                            <li>HÄ±zlÄ± toplu iÅŸlemler</li>
                            <li>YÃ¼ksek kaynak kullanÄ±mÄ±</li>
                        </ul>
                    </div>
                    <div class="bg-blue-900/20 border border-blue-800 rounded p-4">
                        <h4 class="font-semibold text-blue-400 mb-2">âœ… VarsayÄ±lan (Normal)</h4>
                        <ul class="text-sm space-y-1">
                            <li>2-6 worker</li>
                            <li>200 iÅŸ/worker</li>
                            <li>Dengeli performans</li>
                            <li>DÃ¼ÅŸÃ¼k kaynak kullanÄ±mÄ±</li>
                        </ul>
                    </div>
                </div>
                <p class="text-center text-slate-400 text-sm mt-4">
                    ğŸ’¡ Ä°pucu: YoÄŸun iÅŸler iÃ§in yÃ¼ksek kapasiteyi kullanÄ±n, normal iÅŸletmede varsayÄ±lana dÃ¶nÃ¼n.
                </p>
            </div>
        </div>

        <!-- Footer -->
        <footer class="mt-12 pt-6 border-t border-slate-700 text-center text-slate-500 text-sm">
            <p>ğŸ¤– Claude AI tarafÄ±ndan oluÅŸturuldu</p>
            <p class="mt-1">Muzibu Platform - Horizon Queue Management</p>
        </footer>
    </div>
</body>
</html>