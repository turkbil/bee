<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Temizleme PlanÄ± - 14 Ocak ve Ã–ncesi | Muzibu</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-slate-100 min-h-screen">
    <div class="max-w-6xl mx-auto p-6 space-y-6">
        <!-- Header -->
        <header class="bg-gradient-to-r from-red-600 to-orange-600 rounded-lg p-8 shadow-xl">
            <div class="flex items-start gap-4">
                <div class="text-6xl">ğŸ—‘ï¸</div>
                <div class="flex-1">
                    <h1 class="text-4xl font-bold mb-2">Payment Temizleme PlanÄ±</h1>
                    <p class="text-red-100 text-lg">14 Ocak 2026 ve Ã¶ncesi payment verilerinin analizi ve silme planÄ±</p>
                    <div class="bg-red-900/30 rounded-lg p-3 mt-3">
                        <p class="text-sm text-red-200">âš ï¸ HARD DELETE - Veriler kalÄ±cÄ± olarak silinecek. Geri getirilemez!</p>
                    </div>
                </div>
            </div>
        </header>

        <!-- Ã–ZET Ä°STATÄ°STÄ°K -->
        <div class="bg-gradient-to-r from-yellow-600 to-red-600 rounded-lg p-6 shadow-xl">
            <h2 class="text-2xl font-bold mb-4">ğŸ“Š Ã–ZET Ä°STATÄ°STÄ°K</h2>
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="bg-white/10 rounded-lg p-4 text-center">
                    <div class="text-4xl font-bold text-yellow-300">366</div>
                    <div class="text-sm text-slate-200 mt-1">Toplam Payment</div>
                </div>
                <div class="bg-white/10 rounded-lg p-4 text-center">
                    <div class="text-4xl font-bold text-green-300">359</div>
                    <div class="text-sm text-slate-200 mt-1">Completed</div>
                </div>
                <div class="bg-white/10 rounded-lg p-4 text-center">
                    <div class="text-4xl font-bold text-yellow-300">7</div>
                    <div class="text-sm text-slate-200 mt-1">Pending</div>
                </div>
                <div class="bg-white/10 rounded-lg p-4 text-center">
                    <div class="text-4xl font-bold text-red-300">611,702.60 â‚º</div>
                    <div class="text-sm text-slate-200 mt-1">Toplam Tutar</div>
                </div>
            </div>
        </div>

        <!-- TARÄ°H ARALIKLARI -->
        <div class="bg-slate-800 rounded-lg p-6">
            <h2 class="text-2xl font-bold mb-4 text-blue-400">ğŸ“… Tarih AralÄ±ÄŸÄ±</h2>
            <div class="grid md:grid-cols-2 gap-4">
                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-bold mb-2 text-green-300">âœ… Kalacak Veriler</h3>
                    <p class="text-slate-300">15 Ocak 2026 ve sonrasÄ±</p>
                    <p class="text-xs text-slate-400 mt-2">Sistem canlÄ±ya alÄ±ndÄ±ktan sonraki gerÃ§ek veriler</p>
                </div>
                <div class="bg-red-900/20 border border-red-500 rounded-lg p-4">
                    <h3 class="font-bold mb-2 text-red-300">ğŸ—‘ï¸ Silinecek Veriler</h3>
                    <p class="text-slate-300">14 Ocak 2026 DAHÄ°L ve Ã¶ncesi</p>
                    <p class="text-xs text-slate-400 mt-2">Test verisi, migration verisi, eksik veriler</p>
                </div>
            </div>
        </div>

        <!-- SÄ°LÄ°NECEK VERÄ°LERÄ°N DETAYI -->
        <div class="bg-slate-800 rounded-lg p-6">
            <h2 class="text-2xl font-bold mb-4 text-red-400">ğŸ—‘ï¸ Silinecek Veriler - Detay</h2>

            <!-- Payment Tiplerine GÃ¶re -->
            <div class="mb-6">
                <h3 class="font-bold text-lg mb-3 text-yellow-300">Payment DurumlarÄ±na GÃ¶re DaÄŸÄ±lÄ±m</h3>
                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-3">
                    <div class="bg-slate-700 rounded p-3">
                        <div class="text-2xl font-bold text-green-400">359</div>
                        <div class="text-sm text-slate-300">Completed (TamamlanmÄ±ÅŸ)</div>
                        <div class="text-xs text-slate-400 mt-1">Ã–deme baÅŸarÄ±lÄ±, iÅŸlem tamamlandÄ±</div>
                    </div>
                    <div class="bg-slate-700 rounded p-3">
                        <div class="text-2xl font-bold text-yellow-400">7</div>
                        <div class="text-sm text-slate-300">Pending (Beklemede)</div>
                        <div class="text-xs text-slate-400 mt-1">Ã–deme baÅŸlatÄ±ldÄ±, tamamlanmadÄ±</div>
                    </div>
                    <div class="bg-slate-700 rounded p-3">
                        <div class="text-2xl font-bold text-gray-400">0</div>
                        <div class="text-sm text-slate-300">Failed (BaÅŸarÄ±sÄ±z)</div>
                        <div class="text-xs text-slate-400 mt-1">Ã–deme baÅŸarÄ±sÄ±z oldu</div>
                    </div>
                    <div class="bg-slate-700 rounded p-3">
                        <div class="text-2xl font-bold text-gray-400">0</div>
                        <div class="text-sm text-slate-300">Cancelled (Ä°ptal)</div>
                        <div class="text-xs text-slate-400 mt-1">Ã–deme iptal edildi</div>
                    </div>
                </div>
            </div>

            <!-- Payable Type'a GÃ¶re -->
            <div class="mb-6">
                <h3 class="font-bold text-lg mb-3 text-purple-300">Ä°liÅŸkili KayÄ±t TÃ¼rleri</h3>
                <div class="bg-slate-700 rounded p-4">
                    <p class="text-sm text-slate-300 mb-2">Bu payment'lar ÅŸu kayÄ±tlara baÄŸlÄ±:</p>
                    <ul class="space-y-1 text-sm text-slate-400">
                        <li>â€¢ <strong class="text-blue-400">Order:</strong> SipariÅŸ kayÄ±tlarÄ± (cart_orders tablosu)</li>
                        <li>â€¢ <strong class="text-purple-400">Subscription:</strong> Abonelik kayÄ±tlarÄ± (subscriptions tablosu)</li>
                    </ul>
                    <div class="bg-yellow-900/30 p-3 rounded mt-3 border border-yellow-500">
                        <p class="text-xs text-yellow-200">âš ï¸ <strong>DÄ°KKAT:</strong> Payment silindiÄŸinde iliÅŸkili Order kayÄ±tlarÄ± yetim kalabilir (orphaned records). Bu order'larÄ± da silmek gerekebilir.</p>
                    </div>
                </div>
            </div>

            <!-- Ã–ne Ã‡Ä±kan Ã–rnekler -->
            <div>
                <h3 class="font-bold text-lg mb-3 text-blue-300">ğŸ“‹ Ã–ne Ã‡Ä±kan Ã–rnekler (Son 10 KayÄ±t)</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="bg-slate-700">
                            <tr>
                                <th class="p-2 text-left">ID</th>
                                <th class="p-2 text-left">Payment Number</th>
                                <th class="p-2 text-left">Tutar</th>
                                <th class="p-2 text-left">Durum</th>
                                <th class="p-2 text-left">Order</th>
                                <th class="p-2 text-left">User</th>
                                <th class="p-2 text-left">Tarih</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-700">
                            <tr class="hover:bg-slate-700/50">
                                <td class="p-2 font-mono text-blue-400">51</td>
                                <td class="p-2 font-mono text-xs">PAY-20260114223750-E1847E</td>
                                <td class="p-2">720.00 â‚º</td>
                                <td class="p-2"><span class="bg-green-500 text-white px-2 py-1 rounded text-xs">completed</span></td>
                                <td class="p-2 font-mono text-xs">ORD20260114E15CDE</td>
                                <td class="p-2 text-slate-400">NULL</td>
                                <td class="p-2 text-xs">14.01.2026 22:37</td>
                            </tr>
                            <tr class="hover:bg-slate-700/50">
                                <td class="p-2 font-mono text-blue-400">50</td>
                                <td class="p-2 font-mono text-xs">PAY-20260114211928-0B9897</td>
                                <td class="p-2">720.00 â‚º</td>
                                <td class="p-2"><span class="bg-green-500 text-white px-2 py-1 rounded text-xs">completed</span></td>
                                <td class="p-2 font-mono text-xs">ORD202601140B7791</td>
                                <td class="p-2 text-slate-400">NULL</td>
                                <td class="p-2 text-xs">14.01.2026 21:19</td>
                            </tr>
                            <tr class="hover:bg-slate-700/50 bg-purple-900/20">
                                <td class="p-2 font-mono text-blue-400">400</td>
                                <td class="p-2 font-mono text-xs">PAY-MIGRATED-1272</td>
                                <td class="p-2">720.00 â‚º</td>
                                <td class="p-2"><span class="bg-green-500 text-white px-2 py-1 rounded text-xs">completed</span></td>
                                <td class="p-2 font-mono text-xs text-purple-400">Subscription #973</td>
                                <td class="p-2 text-slate-400">NULL</td>
                                <td class="p-2 text-xs">14.01.2026 18:10</td>
                            </tr>
                            <tr class="hover:bg-slate-700/50">
                                <td class="p-2 font-mono text-blue-400">49</td>
                                <td class="p-2 font-mono text-xs">PAY-20260114150312-070EA3</td>
                                <td class="p-2">720.00 â‚º</td>
                                <td class="p-2"><span class="bg-green-500 text-white px-2 py-1 rounded text-xs">completed</span></td>
                                <td class="p-2 font-mono text-xs">ORD2026011406EB51</td>
                                <td class="p-2 text-slate-400">NULL</td>
                                <td class="p-2 text-xs">14.01.2026 15:03</td>
                            </tr>
                            <tr class="hover:bg-slate-700/50 bg-yellow-900/20">
                                <td class="p-2 font-mono text-blue-400">45</td>
                                <td class="p-2 font-mono text-xs">PAY-20260114140228-48767A</td>
                                <td class="p-2">720.00 â‚º</td>
                                <td class="p-2"><span class="bg-yellow-500 text-black px-2 py-1 rounded text-xs">pending</span></td>
                                <td class="p-2 font-mono text-xs">ORD202601144851D7</td>
                                <td class="p-2 text-slate-400">NULL</td>
                                <td class="p-2 text-xs">14.01.2026 14:02</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="text-xs text-slate-400 mt-3">ğŸ’¾ <strong>Tam liste:</strong> <code>payment-old-data-report.json</code> dosyasÄ±nda 366 kayÄ±t mevcut</p>
            </div>
        </div>

        <!-- Ä°LÄ°ÅKÄ°LÄ° KAYITLAR -->
        <div class="bg-slate-800 rounded-lg p-6">
            <h2 class="text-2xl font-bold mb-4 text-purple-400">ğŸ”— Ä°liÅŸkili KayÄ±tlar</h2>

            <div class="space-y-4">
                <!-- Orders -->
                <div class="bg-purple-900/20 border border-purple-500 rounded-lg p-4">
                    <h3 class="font-bold mb-2 text-purple-300">ğŸ“¦ Cart Orders (SipariÅŸler)</h3>
                    <p class="text-sm text-slate-300 mb-2">Bu payment'larÄ±n Ã§oÄŸu <code>cart_orders</code> tablosundaki sipariÅŸlere baÄŸlÄ±.</p>
                    <div class="bg-slate-900 p-3 rounded text-xs space-y-1">
                        <p class="text-slate-400"><strong>Ä°liÅŸki:</strong> payments.payable_type = 'Modules\Cart\App\Models\Order'</p>
                        <p class="text-slate-400"><strong>Foreign Key:</strong> payments.payable_id â†’ cart_orders.order_id</p>
                    </div>
                    <div class="bg-red-900/30 p-3 rounded mt-3 border border-red-500">
                        <p class="text-xs text-red-200">âš ï¸ <strong>SORUMLU SÄ°LME:</strong> Payment silinirse iliÅŸkili order'Ä± da silmek mantÄ±klÄ± (yoksa yetim kalÄ±r)</p>
                    </div>
                </div>

                <!-- Subscriptions -->
                <div class="bg-purple-900/20 border border-purple-500 rounded-lg p-4">
                    <h3 class="font-bold mb-2 text-purple-300">ğŸ« Subscriptions (Abonelikler)</h3>
                    <p class="text-sm text-slate-300 mb-2">BazÄ± payment'lar (PAY-MIGRATED-*) doÄŸrudan subscription'lara baÄŸlÄ±.</p>
                    <div class="bg-slate-900 p-3 rounded text-xs space-y-1">
                        <p class="text-slate-400"><strong>Ä°liÅŸki:</strong> payments.payable_type = 'Modules\Subscription\App\Models\Subscription'</p>
                        <p class="text-slate-400"><strong>Foreign Key:</strong> payments.payable_id â†’ subscriptions.subscription_id</p>
                    </div>
                    <div class="bg-yellow-900/30 p-3 rounded mt-3 border border-yellow-500">
                        <p class="text-xs text-yellow-200">ğŸ’¡ <strong>NOT:</strong> Migration subscription'larÄ± zaten kullanÄ±mda olabilir. Payment silinse bile subscription'Ä±n kendisi kalmalÄ±.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SÄ°LME PLANI -->
        <div class="bg-slate-800 rounded-lg p-6">
            <h2 class="text-2xl font-bold mb-4 text-red-400">ğŸ—‘ï¸ Silme PlanÄ±</h2>

            <div class="space-y-4">
                <!-- AdÄ±m 1: Yedek -->
                <div class="bg-green-900/20 border border-green-500 rounded-lg p-4">
                    <div class="flex items-start gap-3">
                        <div class="bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center flex-shrink-0 font-bold">1</div>
                        <div class="flex-1">
                            <h3 class="font-bold text-green-300 mb-2">VeritabanÄ± YedeÄŸi Al</h3>
                            <div class="bg-slate-900 p-3 rounded text-xs">
                                <p class="text-slate-400 mb-2"><strong>Yedeklenecek Tablolar:</strong></p>
                                <code class="text-green-400 block">â€¢ payments (366 kayÄ±t - 14 Ocak ve Ã¶ncesi)</code>
                                <code class="text-green-400 block">â€¢ cart_orders (iliÅŸkili order'lar)</code>
                                <p class="text-yellow-300 mt-2">ğŸ’¾ Yedek konumu: /var/www/vhosts/muzibu.com/backups/2026-01-16-payment-cleanup/</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AdÄ±m 2: KullanÄ±cÄ± OnayÄ± -->
                <div class="bg-yellow-900/20 border border-yellow-500 rounded-lg p-4">
                    <div class="flex items-start gap-3">
                        <div class="bg-yellow-500 text-black rounded-full w-8 h-8 flex items-center justify-center flex-shrink-0 font-bold">2</div>
                        <div class="flex-1">
                            <h3 class="font-bold text-yellow-300 mb-2">KullanÄ±cÄ± OnayÄ±</h3>
                            <p class="text-sm text-slate-300">Bu raporu inceleyip onay verdikten sonra silme iÅŸlemi baÅŸlatÄ±lacak.</p>
                            <div class="bg-red-900/30 p-3 rounded mt-2 border border-red-500">
                                <p class="text-xs text-red-200">âš ï¸ HARD DELETE seÃ§ildi - Veriler KALICI olarak silinecek, SOFT DELETE deÄŸil!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AdÄ±m 3: Ä°liÅŸkili Order'larÄ± Sil -->
                <div class="bg-red-900/20 border border-red-500 rounded-lg p-4">
                    <div class="flex items-start gap-3">
                        <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center flex-shrink-0 font-bold">3</div>
                        <div class="flex-1">
                            <h3 class="font-bold text-red-300 mb-2">Ä°liÅŸkili Order'larÄ± Sil</h3>
                            <div class="bg-slate-900 p-3 rounded text-xs">
                                <code class="text-red-400 block">DELETE FROM cart_orders</code>
                                <code class="text-red-400 block">WHERE DATE(created_at) <= '2026-01-14'</code>
                                <code class="text-red-400 block">AND order_id IN (SELECT payable_id FROM payments WHERE ...);</code>
                            </div>
                            <p class="text-xs text-slate-400 mt-2">Ã–nce order'lar silinmeli (foreign key constraint)</p>
                        </div>
                    </div>
                </div>

                <!-- AdÄ±m 4: Payment'larÄ± Sil -->
                <div class="bg-red-900/20 border border-red-500 rounded-lg p-4">
                    <div class="flex items-start gap-3">
                        <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center flex-shrink-0 font-bold">4</div>
                        <div class="flex-1">
                            <h3 class="font-bold text-red-300 mb-2">Payment KayÄ±tlarÄ±nÄ± Sil</h3>
                            <div class="bg-slate-900 p-3 rounded text-xs">
                                <code class="text-red-400 block">DELETE FROM payments</code>
                                <code class="text-red-400 block">WHERE DATE(created_at) <= '2026-01-14';</code>
                            </div>
                            <p class="text-xs text-red-200 mt-2">âš ï¸ 366 kayÄ±t kalÄ±cÄ± olarak silinecek</p>
                        </div>
                    </div>
                </div>

                <!-- AdÄ±m 5: DoÄŸrulama -->
                <div class="bg-blue-900/20 border border-blue-500 rounded-lg p-4">
                    <div class="flex items-start gap-3">
                        <div class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center flex-shrink-0 font-bold">5</div>
                        <div class="flex-1">
                            <h3 class="font-bold text-blue-300 mb-2">DoÄŸrulama ve Rapor</h3>
                            <p class="text-sm text-slate-300">Silme iÅŸlemi sonrasÄ± kontrol:</p>
                            <ul class="text-xs text-slate-400 mt-2 space-y-1">
                                <li>â€¢ Admin panelde payment listesi temiz mi?</li>
                                <li>â€¢ 15 Ocak ve sonrasÄ± veriler etkilenmemiÅŸ mi?</li>
                                <li>â€¢ Silme raporu oluÅŸtur (kaÃ§ kayÄ±t silindi)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- RÄ°SKLER VE DÄ°KKAT EDÄ°LECEKLER -->
        <div class="bg-gradient-to-r from-red-600 to-orange-600 rounded-lg p-6">
            <h2 class="text-2xl font-bold mb-4">âš ï¸ RÄ°SKLER VE DÄ°KKAT EDÄ°LECEKLER</h2>

            <div class="space-y-3 text-slate-100">
                <div class="flex items-start gap-3">
                    <span class="text-2xl">ğŸ”´</span>
                    <div>
                        <p class="font-semibold">HARD DELETE - Geri Getirilemez!</p>
                        <p class="text-sm text-slate-200">Soft delete deÄŸil, kalÄ±cÄ± silme. Yedek olmadan GERÄ° ALINAMAZ!</p>
                    </div>
                </div>

                <div class="flex items-start gap-3">
                    <span class="text-2xl">âš ï¸</span>
                    <div>
                        <p class="font-semibold">Foreign Key Constraints</p>
                        <p class="text-sm text-slate-200">Order'larÄ± payment'tan Ã¶nce silmek gerekebilir (foreign key hatasÄ± olabilir)</p>
                    </div>
                </div>

                <div class="flex items-start gap-3">
                    <span class="text-2xl">ğŸ”</span>
                    <div>
                        <p class="font-semibold">User ID NULL</p>
                        <p class="text-sm text-slate-200">Ã‡oÄŸu payment'Ä±n user_id'si NULL - test verisi veya eksik migration</p>
                    </div>
                </div>

                <div class="flex items-start gap-3">
                    <span class="text-2xl">ğŸ’°</span>
                    <div>
                        <p class="font-semibold">611,702.60 â‚º Tutar</p>
                        <p class="text-sm text-slate-200">Test verisi olsa bile bÃ¼yÃ¼k tutar - gerÃ§ek Ã¶deme deÄŸil mi kontrol et!</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ONAY CHECKBOX -->
        <div class="bg-slate-800 rounded-lg p-6 border-2 border-yellow-500">
            <h2 class="text-2xl font-bold mb-4 text-yellow-400">âœ… Onay Listesi</h2>
            <div class="space-y-3">
                <label class="flex items-start gap-3 cursor-pointer">
                    <input type="checkbox" class="mt-1 w-5 h-5">
                    <span class="text-slate-300">366 adet payment kaydÄ±nÄ±n silineceÄŸini anladÄ±m</span>
                </label>
                <label class="flex items-start gap-3 cursor-pointer">
                    <input type="checkbox" class="mt-1 w-5 h-5">
                    <span class="text-slate-300">Ä°liÅŸkili order kayÄ±tlarÄ±nÄ±n da silineceÄŸini anladÄ±m</span>
                </label>
                <label class="flex items-start gap-3 cursor-pointer">
                    <input type="checkbox" class="mt-1 w-5 h-5">
                    <span class="text-slate-300">HARD DELETE olduÄŸunu ve geri getirilemeyeceÄŸini anladÄ±m</span>
                </label>
                <label class="flex items-start gap-3 cursor-pointer">
                    <input type="checkbox" class="mt-1 w-5 h-5">
                    <span class="text-slate-300">VeritabanÄ± yedÄŸi alÄ±ndÄ±ÄŸÄ±nÄ± doÄŸruladÄ±m</span>
                </label>
                <label class="flex items-start gap-3 cursor-pointer">
                    <input type="checkbox" class="mt-1 w-5 h-5">
                    <span class="text-slate-300">15 Ocak ve sonrasÄ± verilerin etkilenmeyeceÄŸini teyit ettim</span>
                </label>
            </div>

            <div class="bg-red-900/30 p-4 rounded mt-4 border border-red-500">
                <p class="text-sm text-red-200 font-semibold">âš ï¸ TÃ¼m onaylarÄ± verdikten sonra silme iÅŸlemini baÅŸlatmak iÃ§in Claude'a bildirebilirsin.</p>
            </div>
        </div>

        <!-- DOSYALAR -->
        <div class="bg-slate-800 rounded-lg p-6">
            <h2 class="text-2xl font-bold mb-4 text-slate-400">ğŸ“ OluÅŸturulan Dosyalar</h2>
            <div class="space-y-2 text-sm">
                <div class="bg-slate-700 p-3 rounded">
                    <p class="font-mono text-blue-400">payment-analyze-old-data.php</p>
                    <p class="text-xs text-slate-400">Analiz scripti (tekrar Ã§alÄ±ÅŸtÄ±rÄ±labilir)</p>
                </div>
                <div class="bg-slate-700 p-3 rounded">
                    <p class="font-mono text-blue-400">payment-old-data-report.json</p>
                    <p class="text-xs text-slate-400">Tam veri raporu (366 kayÄ±t detaylÄ±)</p>
                </div>
                <div class="bg-slate-700 p-3 rounded">
                    <p class="font-mono text-blue-400">public/readme/2026/01/16/payment-cleanup-plan/</p>
                    <p class="text-xs text-slate-400">Bu HTML rapor</p>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="text-center text-slate-400 text-sm py-4 border-t border-slate-700">
            <p>16 Ocak 2026 â€¢ Muzibu.com</p>
            <p class="text-xs mt-1">âš ï¸ HARD DELETE planÄ± - LÃ¼tfen dikkatli incele!</p>
        </footer>
    </div>
</body>
</html>
