<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Device Limit Hierarchy - FINAL</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 text-slate-100 min-h-screen">
    <div class="max-w-6xl mx-auto px-6 py-12">
        <!-- Header -->
        <header class="mb-16 pb-8 border-b-2 border-blue-500">
            <div class="flex items-center gap-4 mb-4">
                <h1 class="text-5xl font-bold bg-gradient-to-r from-blue-400 via-cyan-400 to-purple-400 bg-clip-text text-transparent">
                    ğŸ“± Device Limit Hierarchy
                </h1>
                <span class="px-4 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 text-white font-bold rounded-full">
                    FINAL
                </span>
            </div>
            <p class="text-slate-300 text-xl">User â†’ Plan â†’ Setting (3 KatmanlÄ± Sistem)</p>
            <div class="mt-4 flex gap-4 text-sm text-slate-400">
                <span>ğŸ“… 2025-12-05</span>
                <span>ğŸ¯ users.device_limit Zaten Var!</span>
                <span>âœ… Fallback Stratejisi</span>
            </div>
        </header>

        <!-- HÄ°YERARÅÄ° -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-blue-400">ğŸ¯ 3 KatmanlÄ± HiyerarÅŸi</h2>
            
            <div class="space-y-6">
                <!-- Katman 1: USER -->
                <div class="bg-gradient-to-r from-green-900/40 to-emerald-900/40 border-2 border-green-500 rounded-xl p-8">
                    <div class="flex items-start gap-4 mb-6">
                        <span class="w-12 h-12 bg-green-600 text-white rounded-full flex items-center justify-center font-bold text-xl flex-shrink-0">1</span>
                        <div class="flex-1">
                            <h3 class="text-3xl font-bold text-green-400 mb-3">users.device_limit</h3>
                            <p class="text-slate-300 text-lg">KullanÄ±cÄ±ya Ã¶zel cihaz limiti (EN Ã–NCELÄ°KLÄ°)</p>
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="bg-slate-900/50 rounded-lg p-6">
                            <h4 class="text-white font-bold mb-4">ğŸ“‹ Ne Zaman KullanÄ±lÄ±r?</h4>
                            <ul class="space-y-2 text-slate-300 text-sm">
                                <li>âœ… VIP kullanÄ±cÄ±ya <strong class="text-green-400">Ã¶zel limit</strong> vermek</li>
                                <li>âœ… Problematic kullanÄ±cÄ±yÄ± <strong class="text-red-400">kÄ±sÄ±tlamak</strong> (1 cihaz)</li>
                                <li>âœ… Test kullanÄ±cÄ±sÄ± <strong class="text-blue-400">sÄ±nÄ±rsÄ±z</strong> (999)</li>
                                <li>âœ… Ã–zel anlaÅŸmalar (kurumsal)</li>
                            </ul>
                        </div>

                        <div class="bg-slate-900/50 rounded-lg p-6">
                            <h4 class="text-white font-bold mb-4">ğŸ” Teknik</h4>
                            <div class="bg-slate-800/50 rounded p-4 font-mono text-xs text-green-400">
// Ã–nce user'a bak<br>
if ($user->device_limit !== null) {<br>
&nbsp;&nbsp;return $user->device_limit;<br>
}
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 bg-green-900/30 rounded-lg p-4 border border-green-700/50">
                        <p class="text-green-400 font-bold mb-2">âœ… Default DeÄŸer:</p>
                        <p class="text-slate-300"><code class="bg-slate-800 px-2 py-1 rounded">NULL</code> â†’ Yani normalde boÅŸ, Ã¶zel durumda set edilir</p>
                    </div>

                    <div class="mt-4 bg-blue-900/30 rounded-lg p-4 border border-blue-700/50">
                        <p class="text-blue-400 font-bold mb-2">ğŸ’¡ Ã–rnek Senaryolar:</p>
                        <ul class="text-slate-300 text-sm space-y-1">
                            <li>â€¢ VIP Ã¼ye: <code class="bg-slate-800 px-2 py-1 rounded">device_limit = 5</code></li>
                            <li>â€¢ Problematic: <code class="bg-slate-800 px-2 py-1 rounded">device_limit = 1</code></li>
                            <li>â€¢ Test user: <code class="bg-slate-800 px-2 py-1 rounded">device_limit = 999</code></li>
                            <li>â€¢ Normal user: <code class="bg-slate-800 px-2 py-1 rounded">device_limit = NULL</code> â†’ Plan'a bak</li>
                        </ul>
                    </div>
                </div>

                <!-- Katman 2: PLAN -->
                <div class="bg-gradient-to-r from-blue-900/40 to-cyan-900/40 border-2 border-blue-500 rounded-xl p-8">
                    <div class="flex items-start gap-4 mb-6">
                        <span class="w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-xl flex-shrink-0">2</span>
                        <div class="flex-1">
                            <h3 class="text-3xl font-bold text-blue-400 mb-3">subscription_plans.device_limit</h3>
                            <p class="text-slate-300 text-lg">Plan bazlÄ± cihaz limiti (ORTA Ã–NCELÄ°K)</p>
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="bg-slate-900/50 rounded-lg p-6">
                            <h4 class="text-white font-bold mb-4">ğŸ“‹ Ne Zaman KullanÄ±lÄ±r?</h4>
                            <ul class="space-y-2 text-slate-300 text-sm">
                                <li>âœ… <strong class="text-blue-400">Trial Plan:</strong> 1 cihaz</li>
                                <li>âœ… <strong class="text-purple-400">Basic Plan:</strong> 2 cihaz</li>
                                <li>âœ… <strong class="text-yellow-400">Premium Plan:</strong> 3 cihaz</li>
                                <li>âœ… <strong class="text-green-400">Family Plan:</strong> 5 cihaz</li>
                            </ul>
                        </div>

                        <div class="bg-slate-900/50 rounded-lg p-6">
                            <h4 class="text-white font-bold mb-4">ğŸ” Teknik</h4>
                            <div class="bg-slate-800/50 rounded p-4 font-mono text-xs text-blue-400">
// User'da yoksa plan'a bak<br>
if ($user->activeSubscription) {<br>
&nbsp;&nbsp;$plan = $user->activeSubscription->plan;<br>
&nbsp;&nbsp;if ($plan->device_limit) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;return $plan->device_limit;<br>
&nbsp;&nbsp;}<br>
}
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 bg-blue-900/30 rounded-lg p-4 border border-blue-700/50">
                        <p class="text-blue-400 font-bold mb-2">ğŸ’¡ Ã–rnek Plan YapÄ±sÄ±:</p>
                        <div class="bg-slate-900/50 rounded p-4 font-mono text-xs text-slate-400">
Trial Plan: device_limit = 1<br>
Basic Plan: device_limit = 2<br>
Premium Plan: device_limit = 3<br>
Family Plan: device_limit = 5
                        </div>
                    </div>
                </div>

                <!-- Katman 3: SETTING -->
                <div class="bg-gradient-to-r from-purple-900/40 to-pink-900/40 border-2 border-purple-500 rounded-xl p-8">
                    <div class="flex items-start gap-4 mb-6">
                        <span class="w-12 h-12 bg-purple-600 text-white rounded-full flex items-center justify-center font-bold text-xl flex-shrink-0">3</span>
                        <div class="flex-1">
                            <h3 class="text-3xl font-bold text-purple-400 mb-3">auth_device_limit (Setting)</h3>
                            <p class="text-slate-300 text-lg">Global fallback (EN SON Ã–NCELÄ°K)</p>
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="bg-slate-900/50 rounded-lg p-6">
                            <h4 class="text-white font-bold mb-4">ğŸ“‹ Ne Zaman KullanÄ±lÄ±r?</h4>
                            <ul class="space-y-2 text-slate-300 text-sm">
                                <li>âœ… User'da <code class="bg-slate-800 px-1 rounded">NULL</code></li>
                                <li>âœ… Plan'da <code class="bg-slate-800 px-1 rounded">NULL</code> veya subscription yok</li>
                                <li>âœ… <strong class="text-purple-400">Son Ã§are fallback</strong></li>
                                <li>âœ… Tenant bazÄ±nda global ayar</li>
                            </ul>
                        </div>

                        <div class="bg-slate-900/50 rounded-lg p-6">
                            <h4 class="text-white font-bold mb-4">ğŸ” Teknik</h4>
                            <div class="bg-slate-800/50 rounded p-4 font-mono text-xs text-purple-400">
// Son olarak setting'e bak<br>
return setting('auth_device_limit', 1);
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 bg-purple-900/30 rounded-lg p-4 border border-purple-700/50">
                        <p class="text-purple-400 font-bold mb-2">ğŸ’¡ Default:</p>
                        <p class="text-slate-300">Muzibu iÃ§in: <code class="bg-slate-800 px-2 py-1 rounded">1 cihaz</code> (gÃ¼venli baÅŸlangÄ±Ã§)</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- FALLBACK AKIÅI -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-cyan-400">ğŸ”„ Fallback AkÄ±ÅŸÄ±</h2>
            
            <div class="bg-slate-900/50 rounded-xl p-8 border border-cyan-700/50">
                <div class="space-y-6">
                    <div class="flex items-center gap-4">
                        <div class="px-6 py-3 bg-green-600 text-white rounded-lg font-bold min-w-[200px] text-center">1ï¸âƒ£ user.device_limit</div>
                        <span class="text-2xl">â†’</span>
                        <div class="flex-1 text-slate-300">NULL deÄŸil mi? â†’ <strong class="text-green-400">KULLAN!</strong></div>
                    </div>

                    <div class="flex items-center gap-4">
                        <div class="px-6 py-3 bg-blue-600 text-white rounded-lg font-bold min-w-[200px] text-center">2ï¸âƒ£ plan.device_limit</div>
                        <span class="text-2xl">â†’</span>
                        <div class="flex-1 text-slate-300">User NULL ise plan'a bak â†’ <strong class="text-blue-400">KULLAN!</strong></div>
                    </div>

                    <div class="flex items-center gap-4">
                        <div class="px-6 py-3 bg-purple-600 text-white rounded-lg font-bold min-w-[200px] text-center">3ï¸âƒ£ auth_device_limit</div>
                        <span class="text-2xl">â†’</span>
                        <div class="flex-1 text-slate-300">Ä°kisi de NULL ise setting â†’ <strong class="text-purple-400">KULLAN!</strong></div>
                    </div>
                </div>

                <div class="mt-8 bg-yellow-900/30 rounded-lg p-6 border border-yellow-700/50">
                    <p class="text-yellow-400 font-bold mb-4">ğŸ’¡ Kod Ä°mplementasyonu:</p>
                    <div class="bg-slate-900 rounded-lg p-4 font-mono text-sm text-green-400">
public function getDeviceLimit(User $user): int<br>
{<br>
&nbsp;&nbsp;// 1. User override<br>
&nbsp;&nbsp;if ($user->device_limit !== null) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;return $user->device_limit;<br>
&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;// 2. Plan default<br>
&nbsp;&nbsp;$subscription = $user->activeSubscription();<br>
&nbsp;&nbsp;if ($subscription && $subscription->plan->device_limit) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;return $subscription->plan->device_limit;<br>
&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;// 3. Global fallback<br>
&nbsp;&nbsp;return setting('auth_device_limit', 1);<br>
}
                    </div>
                </div>
            </div>
        </section>

        <!-- Ã–RNEK SENARYOLAR -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-emerald-400">ğŸ¯ Ã–rnek Senaryolar</h2>
            
            <div class="space-y-6">
                <!-- Senaryo 1 -->
                <div class="bg-slate-900/50 rounded-xl p-8 border border-emerald-700/50">
                    <h3 class="text-xl font-bold text-emerald-400 mb-4">Senaryo 1: Normal KullanÄ±cÄ±</h3>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-slate-800/50 rounded p-4">
                            <p class="text-xs text-slate-400 mb-2">user.device_limit</p>
                            <p class="text-red-400 font-bold">NULL</p>
                        </div>
                        <div class="bg-slate-800/50 rounded p-4">
                            <p class="text-xs text-slate-400 mb-2">plan.device_limit</p>
                            <p class="text-green-400 font-bold">3</p>
                        </div>
                        <div class="bg-slate-800/50 rounded p-4">
                            <p class="text-xs text-slate-400 mb-2">SONUÃ‡</p>
                            <p class="text-white font-bold">3 cihaz âœ…</p>
                        </div>
                    </div>
                </div>

                <!-- Senaryo 2 -->
                <div class="bg-slate-900/50 rounded-xl p-8 border border-blue-700/50">
                    <h3 class="text-xl font-bold text-blue-400 mb-4">Senaryo 2: VIP KullanÄ±cÄ±</h3>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-slate-800/50 rounded p-4">
                            <p class="text-xs text-slate-400 mb-2">user.device_limit</p>
                            <p class="text-green-400 font-bold">5 (VIP)</p>
                        </div>
                        <div class="bg-slate-800/50 rounded p-4">
                            <p class="text-xs text-slate-400 mb-2">plan.device_limit</p>
                            <p class="text-slate-400 font-bold">3 (ignored)</p>
                        </div>
                        <div class="bg-slate-800/50 rounded p-4">
                            <p class="text-xs text-slate-400 mb-2">SONUÃ‡</p>
                            <p class="text-white font-bold">5 cihaz âœ…</p>
                        </div>
                    </div>
                </div>

                <!-- Senaryo 3 -->
                <div class="bg-slate-900/50 rounded-xl p-8 border border-purple-700/50">
                    <h3 class="text-xl font-bold text-purple-400 mb-4">Senaryo 3: AboneliÄŸi Olmayan</h3>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-slate-800/50 rounded p-4">
                            <p class="text-xs text-slate-400 mb-2">user.device_limit</p>
                            <p class="text-red-400 font-bold">NULL</p>
                        </div>
                        <div class="bg-slate-800/50 rounded p-4">
                            <p class="text-xs text-slate-400 mb-2">plan.device_limit</p>
                            <p class="text-red-400 font-bold">NULL (no sub)</p>
                        </div>
                        <div class="bg-slate-800/50 rounded p-4">
                            <p class="text-xs text-slate-400 mb-2">SONUÃ‡</p>
                            <p class="text-white font-bold">1 cihaz (setting) âœ…</p>
                        </div>
                    </div>
                </div>

                <!-- Senaryo 4 -->
                <div class="bg-slate-900/50 rounded-xl p-8 border border-red-700/50">
                    <h3 class="text-xl font-bold text-red-400 mb-4">Senaryo 4: Problematic KullanÄ±cÄ±</h3>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-slate-800/50 rounded p-4">
                            <p class="text-xs text-slate-400 mb-2">user.device_limit</p>
                            <p class="text-red-400 font-bold">1 (BANNED)</p>
                        </div>
                        <div class="bg-slate-800/50 rounded p-4">
                            <p class="text-xs text-slate-400 mb-2">plan.device_limit</p>
                            <p class="text-slate-400 font-bold">5 (ignored)</p>
                        </div>
                        <div class="bg-slate-800/50 rounded p-4">
                            <p class="text-xs text-slate-400 mb-2">SONUÃ‡</p>
                            <p class="text-white font-bold">1 cihaz (kÄ±sÄ±tlÄ±) âœ…</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Ã–ZET -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-emerald-400">ğŸ“Š Ã–zet</h2>
            
            <div class="bg-gradient-to-r from-emerald-900/40 to-green-900/40 border-2 border-emerald-500 rounded-xl p-8">
                <div class="grid md:grid-cols-3 gap-6">
                    <div class="bg-slate-900/50 rounded-lg p-6">
                        <h3 class="text-lg font-bold text-green-400 mb-4">1ï¸âƒ£ User Level</h3>
                        <ul class="space-y-2 text-sm text-slate-300">
                            <li>â€¢ <strong>Field:</strong> users.device_limit</li>
                            <li>â€¢ <strong>Default:</strong> NULL</li>
                            <li>â€¢ <strong>Use:</strong> Ã–zel durumlar</li>
                            <li>â€¢ <strong>Ã–rnek:</strong> VIP, Test, Ban</li>
                        </ul>
                    </div>

                    <div class="bg-slate-900/50 rounded-lg p-6">
                        <h3 class="text-lg font-bold text-blue-400 mb-4">2ï¸âƒ£ Plan Level</h3>
                        <ul class="space-y-2 text-sm text-slate-300">
                            <li>â€¢ <strong>Field:</strong> plans.device_limit</li>
                            <li>â€¢ <strong>Default:</strong> Plan'a gÃ¶re</li>
                            <li>â€¢ <strong>Use:</strong> Normal akÄ±ÅŸ</li>
                            <li>â€¢ <strong>Ã–rnek:</strong> Trial=1, Premium=3</li>
                        </ul>
                    </div>

                    <div class="bg-slate-900/50 rounded-lg p-6">
                        <h3 class="text-lg font-bold text-purple-400 mb-4">3ï¸âƒ£ Setting Level</h3>
                        <ul class="space-y-2 text-sm text-slate-300">
                            <li>â€¢ <strong>Key:</strong> auth_device_limit</li>
                            <li>â€¢ <strong>Default:</strong> 1</li>
                            <li>â€¢ <strong>Use:</strong> Fallback</li>
                            <li>â€¢ <strong>Ã–rnek:</strong> Abonelik yok</li>
                        </ul>
                    </div>
                </div>

                <div class="mt-6 bg-yellow-900/30 rounded-lg p-6 border border-yellow-700/50">
                    <p class="text-yellow-400 font-bold mb-3">ğŸ’¡ AltÄ±n Kural:</p>
                    <p class="text-slate-300 text-lg"><strong>User â†’ Plan â†’ Setting</strong> sÄ±rasÄ±yla kontrol et, ilk bulduÄŸunu kullan!</p>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="mt-20 pt-8 border-t border-slate-700 text-center text-slate-500 text-sm">
            <p>ğŸ¤– Claude AI - Tailwind CSS</p>
            <p class="mt-2">Tarih: 2025-12-05 | Device Limit Hierarchy FINAL</p>
        </footer>
    </div>
</body>
</html>
