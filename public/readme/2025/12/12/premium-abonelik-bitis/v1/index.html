<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Premium Abonelik BitiÅŸ Senaryosu - Muzibu.com.tr</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-slate-100 min-h-screen">
    <div class="max-w-6xl mx-auto px-4 py-12">
        <!-- Header -->
        <header class="mb-16 pb-8 border-b border-slate-700">
            <h1 class="text-4xl font-bold mb-4 bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent">
                ğŸ” Premium Abonelik BitiÅŸ Senaryosu
            </h1>
            <div class="text-slate-400 text-lg">
                Muzibu.com.tr'de premium abonelik sÃ¼resi dolduÄŸunda otomatik gerÃ§ekleÅŸen olaylar
            </div>
            <div class="mt-4 flex gap-4 text-sm text-slate-500">
                <span>ğŸ“… 12 AralÄ±k 2025</span>
                <span>ğŸ¯ Tenant: muzibu.com.tr (Tenant 1001)</span>
                <span>ğŸ‘¤ Subscription Expire Flow Analizi</span>
            </div>
        </header>

        <!-- Genel BakÄ±ÅŸ -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-purple-400">ğŸ“Š Genel BakÄ±ÅŸ</h2>

            <div class="bg-slate-800/50 rounded-lg p-8 border border-slate-700">
                <p class="text-slate-300 leading-relaxed mb-6">
                    KullanÄ±cÄ±nÄ±n premium aboneliÄŸi sona erdiÄŸinde sistem <span class="text-purple-400 font-semibold">tamamen otomatik</span> olarak devreye girer.
                    HiÃ§bir manuel iÅŸlem gerektirmeden 5 farklÄ± katman senkronize Ã§alÄ±ÅŸÄ±r:
                </p>

                <div class="grid md:grid-cols-3 gap-4">
                    <div class="bg-slate-900/50 rounded-lg p-4 border-l-4 border-red-500">
                        <div class="text-2xl font-bold text-red-400 mb-2">06:00</div>
                        <div class="text-sm text-slate-400">Otomatik kontrol baÅŸlar</div>
                    </div>
                    <div class="bg-slate-900/50 rounded-lg p-4 border-l-4 border-yellow-500">
                        <div class="text-2xl font-bold text-yellow-400 mb-2">1 Saniye</div>
                        <div class="text-sm text-slate-400">TÃ¼m deÄŸiÅŸiklikler uygulanÄ±r</div>
                    </div>
                    <div class="bg-slate-900/50 rounded-lg p-4 border-l-4 border-green-500">
                        <div class="text-2xl font-bold text-green-400 mb-2">30 Sn</div>
                        <div class="text-sm text-slate-400">Yeni dinleme limiti</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Otomatik Flow -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-blue-400">ğŸ”„ Otomatik Ã‡alÄ±ÅŸma AkÄ±ÅŸÄ±</h2>

            <!-- AdÄ±m 1: Cron Job -->
            <div class="bg-slate-800/50 border-l-4 border-blue-500 rounded-lg p-6 mb-4">
                <div class="flex items-start gap-4">
                    <div class="bg-blue-500 text-white font-bold rounded-full w-12 h-12 flex items-center justify-center flex-shrink-0 text-lg">1</div>
                    <div class="flex-1">
                        <h3 class="text-xl font-bold text-blue-300 mb-2">
                            Otomatik Kontrol BaÅŸlar
                            <span class="ml-3 px-3 py-1 bg-blue-600 text-white text-xs rounded-full">Her GÃ¼n 06:00</span>
                        </h3>
                        <p class="text-slate-300 leading-relaxed mb-3">
                            Laravel <span class="text-yellow-300 font-semibold">Cron Scheduler</span>
                            <span class="text-slate-400 text-sm">(ZamanlanmÄ±ÅŸ gÃ¶rev sistemi)</span>
                            otomatik olarak <span class="text-blue-300 font-mono text-sm">subscription:check-expired</span> komutunu Ã§alÄ±ÅŸtÄ±rÄ±r.
                        </p>
                        <div class="bg-slate-900/50 rounded p-4 border border-slate-700">
                            <div class="text-sm text-slate-400 mb-2">Kontrol Edilen:</div>
                            <ul class="text-sm text-slate-300 space-y-1">
                                <li>âœ… Status = <span class="text-green-400 font-mono">active</span> VEYA <span class="text-blue-400 font-mono">trial</span></li>
                                <li>âœ… BitiÅŸ tarihi (<span class="text-yellow-300">current_period_end</span>) geÃ§miÅŸ mi?</li>
                                <li>âœ… Deneme sÃ¼resi (<span class="text-purple-300">trial_ends_at</span>) bitmiÅŸ mi?</li>
                            </ul>
                        </div>
                        <p class="mt-3 text-slate-400">
                            <strong class="text-white">SonuÃ§:</strong>
                            EÄŸer sÃ¼re dolmuÅŸsa, subscription status otomatik <span class="text-red-400 font-mono">expired</span> olarak gÃ¼ncellenir.
                        </p>
                        <div class="mt-3 text-xs text-slate-500">
                            ğŸ“ Kod: <span class="font-mono">app/Console/Kernel.php:208</span><br>
                            ğŸ“ Command: <span class="font-mono">Modules/Subscription/app/Console/Commands/CheckExpiredSubscriptions.php:39</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AdÄ±m 2: Observer Tetikleniyor -->
            <div class="bg-slate-800/50 border-l-4 border-purple-500 rounded-lg p-6 mb-4">
                <div class="flex items-start gap-4">
                    <div class="bg-purple-500 text-white font-bold rounded-full w-12 h-12 flex items-center justify-center flex-shrink-0 text-lg">2</div>
                    <div class="flex-1">
                        <h3 class="text-xl font-bold text-purple-300 mb-2">
                            Observer Sistemi Devreye Girer
                            <span class="ml-3 px-3 py-1 bg-purple-600 text-white text-xs rounded-full">Otomatik</span>
                        </h3>
                        <p class="text-slate-300 leading-relaxed mb-3">
                            Subscription status deÄŸiÅŸtiÄŸi iÃ§in <span class="text-purple-400 font-semibold">SubscriptionObserver</span>
                            <span class="text-slate-400 text-sm">(VeritabanÄ± deÄŸiÅŸikliklerini izleyen sistem)</span>
                            otomatik tetiklenir ve iki kritik iÅŸlem yapar:
                        </p>

                        <div class="space-y-4">
                            <!-- Premium Cache Temizleme -->
                            <div class="bg-slate-900/50 rounded p-4 border border-slate-700">
                                <div class="font-semibold text-yellow-300 mb-2">ğŸ”¥ Premium Cache Temizleme</div>
                                <p class="text-sm text-slate-300 mb-2">
                                    KullanÄ±cÄ±nÄ±n "premium mi?" bilgisi cache'de saklanÄ±r. Bu cache hemen silinir ki sistem artÄ±k kullanÄ±cÄ±yÄ± premium olarak gÃ¶rmez.
                                </p>
                                <div class="text-xs text-slate-400 font-mono bg-slate-950 p-2 rounded">
                                    Cache Key: user_<span class="text-blue-300">{user_id}</span>_is_premium_tenant_<span class="text-purple-300">1001</span>
                                </div>
                            </div>

                            <!-- Device Limit Enforcement -->
                            <div class="bg-slate-900/50 rounded p-4 border border-red-700">
                                <div class="font-semibold text-red-300 mb-2">ğŸ” Cihaz Limiti Zorunlu UygulanÄ±r</div>
                                <p class="text-sm text-slate-300 mb-3">
                                    Premium kullanÄ±cÄ± 5 cihazdan dinleme yapÄ±yordu. Abonelik bitince <span class="text-red-400 font-semibold">ANINDA</span>
                                    varsayÄ±lan limite (1 cihaz) dÃ¼ÅŸer.
                                </p>
                                <div class="grid md:grid-cols-2 gap-3">
                                    <div>
                                        <div class="text-xs text-slate-500 mb-1">Premium Aktifken:</div>
                                        <div class="bg-green-900/30 border border-green-700 rounded p-2 text-sm">
                                            <div class="text-green-300 font-semibold">5 Cihaz</div>
                                            <div class="text-xs text-slate-400">Plan device_limit</div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="text-xs text-slate-500 mb-1">Premium Bittikten Sonra:</div>
                                        <div class="bg-red-900/30 border border-red-700 rounded p-2 text-sm">
                                            <div class="text-red-300 font-semibold">1 Cihaz</div>
                                            <div class="text-xs text-slate-400">Global default limit</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <p class="mt-3 text-slate-400">
                            <strong class="text-white">SonuÃ§:</strong>
                            KullanÄ±cÄ±nÄ±n 5 cihazÄ±ndan 4'Ã¼ otomatik kapatÄ±lÄ±r (en eski 4 cihaz logout). Sadece en son login olan cihaz aktif kalÄ±r.
                        </p>
                        <div class="mt-3 text-xs text-slate-500">
                            ğŸ“ Kod: <span class="font-mono">app/Observers/SubscriptionObserver.php:70-124</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AdÄ±m 3: Device Service -->
            <div class="bg-slate-800/50 border-l-4 border-red-500 rounded-lg p-6 mb-4">
                <div class="flex items-start gap-4">
                    <div class="bg-red-500 text-white font-bold rounded-full w-12 h-12 flex items-center justify-center flex-shrink-0 text-lg">3</div>
                    <div class="flex-1">
                        <h3 class="text-xl font-bold text-red-300 mb-2">
                            Fazla Cihazlar KapatÄ±lÄ±r
                            <span class="ml-3 px-3 py-1 bg-red-600 text-white text-xs rounded-full">LIFO MantÄ±ÄŸÄ±</span>
                        </h3>
                        <p class="text-slate-300 leading-relaxed mb-3">
                            <span class="text-red-400 font-semibold">DeviceService</span>
                            <span class="text-slate-400 text-sm">(Cihaz yÃ¶netim servisi)</span>
                            limit aÅŸÄ±mÄ±nÄ± tespit eder ve <span class="text-yellow-300 font-semibold">LIFO</span>
                            <span class="text-slate-400 text-sm">(Last In, First Out - En yeni kalÄ±r)</span> mantÄ±ÄŸÄ±yla hareket eder.
                        </p>

                        <div class="bg-slate-900/50 rounded p-4 border border-slate-700 mb-3">
                            <div class="text-sm text-slate-400 mb-3">Ã–rnek Senaryo:</div>
                            <div class="space-y-2">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 rounded-full bg-green-600 flex items-center justify-center text-white text-xs font-bold">âœ“</div>
                                    <div class="flex-1">
                                        <div class="text-sm text-green-300">iPhone 13 - 2 saat Ã¶nce login</div>
                                        <div class="text-xs text-slate-500">En son login â†’ AKTÄ°F KALIR</div>
                                    </div>
                                </div>
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 rounded-full bg-red-600 flex items-center justify-center text-white text-xs font-bold">âœ—</div>
                                    <div class="flex-1">
                                        <div class="text-sm text-red-300 line-through">MacBook Pro - 1 gÃ¼n Ã¶nce login</div>
                                        <div class="text-xs text-slate-500">Otomatik logout</div>
                                    </div>
                                </div>
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 rounded-full bg-red-600 flex items-center justify-center text-white text-xs font-bold">âœ—</div>
                                    <div class="flex-1">
                                        <div class="text-sm text-red-300 line-through">iPad Air - 3 gÃ¼n Ã¶nce login</div>
                                        <div class="text-xs text-slate-500">Otomatik logout</div>
                                    </div>
                                </div>
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 rounded-full bg-red-600 flex items-center justify-center text-white text-xs font-bold">âœ—</div>
                                    <div class="flex-1">
                                        <div class="text-sm text-red-300 line-through">Samsung S23 - 5 gÃ¼n Ã¶nce login</div>
                                        <div class="text-xs text-slate-500">Otomatik logout</div>
                                    </div>
                                </div>
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 rounded-full bg-red-600 flex items-center justify-center text-white text-xs font-bold">âœ—</div>
                                    <div class="flex-1">
                                        <div class="text-sm text-red-300 line-through">Windows PC - 7 gÃ¼n Ã¶nce login</div>
                                        <div class="text-xs text-slate-500">Otomatik logout</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <p class="mt-3 text-slate-400">
                            <strong class="text-white">Teknik Detay:</strong>
                            Login token'larÄ± <span class="text-yellow-300">revoked_at</span> timestamp'i alÄ±r. KullanÄ±cÄ± diÄŸer cihazlarda yeni istek yaptÄ±ÄŸÄ±nda session geÃ§ersiz olur.
                        </p>
                        <div class="mt-3 text-xs text-slate-500">
                            ğŸ“ Kod: <span class="font-mono">app/Observers/SubscriptionObserver.php:100-106</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AdÄ±m 4: Access Control -->
            <div class="bg-slate-800/50 border-l-4 border-yellow-500 rounded-lg p-6 mb-4">
                <div class="flex items-start gap-4">
                    <div class="bg-yellow-500 text-white font-bold rounded-full w-12 h-12 flex items-center justify-center flex-shrink-0 text-lg">4</div>
                    <div class="flex-1">
                        <h3 class="text-xl font-bold text-yellow-300 mb-2">
                            MÃ¼zik Dinleme KÄ±sÄ±tlanÄ±r
                            <span class="ml-3 px-3 py-1 bg-yellow-600 text-white text-xs rounded-full">30 Saniye</span>
                        </h3>
                        <p class="text-slate-300 leading-relaxed mb-3">
                            <span class="text-yellow-400 font-semibold">SubscriptionService::checkUserAccess()</span>
                            <span class="text-slate-400 text-sm">(EriÅŸim kontrol sistemi)</span>
                            metodunun dÃ¶nÃ¼ÅŸ deÄŸeri deÄŸiÅŸir. ArtÄ±k sÄ±nÄ±rsÄ±z dinleme yerine Ã¶nizleme moduna dÃ¼ÅŸer.
                        </p>

                        <div class="grid md:grid-cols-2 gap-4">
                            <!-- Premium Aktifken -->
                            <div class="bg-green-900/20 border border-green-700 rounded-lg p-4">
                                <div class="text-sm font-semibold text-green-400 mb-3">Premium Aktifken</div>
                                <div class="space-y-2 text-sm">
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 rounded-full bg-green-400"></div>
                                        <div class="text-slate-300">Status: <span class="text-green-300 font-mono">unlimited</span></div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 rounded-full bg-green-400"></div>
                                        <div class="text-slate-300">SÃ¼re: <span class="text-green-300 font-semibold">SÄ±nÄ±rsÄ±z</span></div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 rounded-full bg-green-400"></div>
                                        <div class="text-slate-300">Kalite: <span class="text-green-300">320kbps</span></div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 rounded-full bg-green-400"></div>
                                        <div class="text-slate-300">Reklam: <span class="text-green-300">Yok</span></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Premium Bittikten Sonra -->
                            <div class="bg-red-900/20 border border-red-700 rounded-lg p-4">
                                <div class="text-sm font-semibold text-red-400 mb-3">Premium Bittikten Sonra</div>
                                <div class="space-y-2 text-sm">
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 rounded-full bg-red-400"></div>
                                        <div class="text-slate-300">Status: <span class="text-red-300 font-mono">preview</span></div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 rounded-full bg-red-400"></div>
                                        <div class="text-slate-300">SÃ¼re: <span class="text-red-300 font-semibold">30 saniye</span></div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 rounded-full bg-red-400"></div>
                                        <div class="text-slate-300">Kalite: <span class="text-red-300">128kbps</span></div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 rounded-full bg-red-400"></div>
                                        <div class="text-slate-300">Reklam: <span class="text-red-300">Var</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mt-4 bg-slate-900/50 rounded p-4 border border-slate-700">
                            <div class="text-sm text-slate-400 mb-2">KullanÄ±cÄ± Deneyimi:</div>
                            <p class="text-sm text-slate-300">
                                KullanÄ±cÄ± ÅŸarkÄ±ya tÄ±kladÄ±ÄŸÄ±nda player aÃ§Ä±lÄ±r, ancak 30 saniye sonra otomatik durur.
                                Ekranda "Premium aboneliÄŸiniz sona erdi. SÄ±nÄ±rsÄ±z dinleme iÃ§in yenileyin" mesajÄ± gÃ¶sterilir.
                            </p>
                        </div>

                        <div class="mt-3 text-xs text-slate-500">
                            ğŸ“ Kod: <span class="font-mono">Modules/Subscription/app/Services/SubscriptionService.php:278-299</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AdÄ±m 5: Event & Notification -->
            <div class="bg-slate-800/50 border-l-4 border-green-500 rounded-lg p-6 mb-4">
                <div class="flex items-start gap-4">
                    <div class="bg-green-500 text-white font-bold rounded-full w-12 h-12 flex items-center justify-center flex-shrink-0 text-lg">5</div>
                    <div class="flex-1">
                        <h3 class="text-xl font-bold text-green-300 mb-2">
                            Bildirim Sistemi
                            <span class="ml-3 px-3 py-1 bg-orange-600 text-white text-xs rounded-full">PlanlÄ±</span>
                        </h3>
                        <p class="text-slate-300 leading-relaxed mb-3">
                            <span class="text-green-400 font-semibold">SubscriptionExpired Event</span>
                            <span class="text-slate-400 text-sm">(Abonelik bitti olayÄ±)</span>
                            tetiklenir. Listener sistemi bu olayÄ± yakalar.
                        </p>

                        <div class="bg-slate-900/50 rounded p-4 border border-slate-700 mb-3">
                            <div class="text-sm text-slate-400 mb-2">Åu An Aktif:</div>
                            <ul class="text-sm text-slate-300 space-y-1">
                                <li>âœ… Log kaydÄ± yapÄ±lÄ±yor (kullanÄ±cÄ± ID, subscription ID, plan adÄ±)</li>
                                <li>âœ… Event sistemi Ã§alÄ±ÅŸÄ±yor</li>
                            </ul>
                        </div>

                        <div class="bg-orange-900/20 rounded p-4 border border-orange-700">
                            <div class="text-sm text-orange-400 mb-2">ğŸš§ TODO (Gelecekte Eklenecek):</div>
                            <ul class="text-sm text-slate-300 space-y-1">
                                <li>ğŸ“§ E-posta gÃ¶nderilecek: "Premium aboneliÄŸiniz sona erdi"</li>
                                <li>ğŸ”” Push notification: Mobil uygulama bildirimi</li>
                                <li>ğŸ’¬ SMS: Ä°steÄŸe baÄŸlÄ± SMS bildirimi</li>
                                <li>ğŸ“Š Analytics: Churn analizi iÃ§in veri kaydÄ±</li>
                            </ul>
                        </div>

                        <div class="mt-3 text-xs text-slate-500">
                            ğŸ“ Kod: <span class="font-mono">Modules/Subscription/app/Listeners/SendSubscriptionExpiredNotification.php:10</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Timeline -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-pink-400">â±ï¸ Zaman Ã‡izelgesi</h2>

            <div class="relative">
                <!-- Timeline Line -->
                <div class="absolute left-8 top-0 bottom-0 w-1 bg-gradient-to-b from-blue-500 via-purple-500 to-pink-500"></div>

                <!-- Timeline Items -->
                <div class="space-y-8 relative">
                    <!-- T-0 (BitiÅŸ AnÄ±) -->
                    <div class="flex items-start gap-6">
                        <div class="w-16 h-16 rounded-full bg-red-600 border-4 border-slate-900 flex items-center justify-center flex-shrink-0 relative z-10">
                            <div class="text-white font-bold">T-0</div>
                        </div>
                        <div class="bg-slate-800/50 rounded-lg p-4 flex-1 border border-slate-700">
                            <div class="font-semibold text-red-400 mb-1">Abonelik BitiÅŸ AnÄ±</div>
                            <div class="text-sm text-slate-400">Subscription current_period_end tarihi geÃ§ti</div>
                        </div>
                    </div>

                    <!-- T+1 (Cron Ã‡alÄ±ÅŸma) -->
                    <div class="flex items-start gap-6">
                        <div class="w-16 h-16 rounded-full bg-blue-600 border-4 border-slate-900 flex items-center justify-center flex-shrink-0 relative z-10">
                            <div class="text-white font-bold text-xs">06:00</div>
                        </div>
                        <div class="bg-slate-800/50 rounded-lg p-4 flex-1 border border-slate-700">
                            <div class="font-semibold text-blue-400 mb-1">Otomatik Kontrol (Cron)</div>
                            <div class="text-sm text-slate-400">subscription:check-expired komutu Ã§alÄ±ÅŸÄ±r</div>
                        </div>
                    </div>

                    <!-- T+2 (Observer) -->
                    <div class="flex items-start gap-6">
                        <div class="w-16 h-16 rounded-full bg-purple-600 border-4 border-slate-900 flex items-center justify-center flex-shrink-0 relative z-10">
                            <div class="text-white font-bold text-xs">~1sn</div>
                        </div>
                        <div class="bg-slate-800/50 rounded-lg p-4 flex-1 border border-slate-700">
                            <div class="font-semibold text-purple-400 mb-1">Observer Tetiklenir</div>
                            <div class="text-sm text-slate-400">Status = expired â†’ Cache temizle, device limit enforce</div>
                        </div>
                    </div>

                    <!-- T+3 (Device Logout) -->
                    <div class="flex items-start gap-6">
                        <div class="w-16 h-16 rounded-full bg-red-600 border-4 border-slate-900 flex items-center justify-center flex-shrink-0 relative z-10">
                            <div class="text-white font-bold text-xs">~2sn</div>
                        </div>
                        <div class="bg-slate-800/50 rounded-lg p-4 flex-1 border border-slate-700">
                            <div class="font-semibold text-red-400 mb-1">Cihazlar KapatÄ±lÄ±r</div>
                            <div class="text-sm text-slate-400">4 cihaz otomatik logout (LIFO mantÄ±ÄŸÄ±)</div>
                        </div>
                    </div>

                    <!-- T+4 (Access Changed) -->
                    <div class="flex items-start gap-6">
                        <div class="w-16 h-16 rounded-full bg-yellow-600 border-4 border-slate-900 flex items-center justify-center flex-shrink-0 relative z-10">
                            <div class="text-white font-bold text-xs">ANINDA</div>
                        </div>
                        <div class="bg-slate-800/50 rounded-lg p-4 flex-1 border border-slate-700">
                            <div class="font-semibold text-yellow-400 mb-1">EriÅŸim KÄ±sÄ±tlanÄ±r</div>
                            <div class="text-sm text-slate-400">Sonraki mÃ¼zik isteÄŸinde: 30 saniye preview mode</div>
                        </div>
                    </div>

                    <!-- T+5 (Notification) -->
                    <div class="flex items-start gap-6">
                        <div class="w-16 h-16 rounded-full bg-green-600 border-4 border-slate-900 flex items-center justify-center flex-shrink-0 relative z-10">
                            <div class="text-white font-bold text-xs">~3sn</div>
                        </div>
                        <div class="bg-slate-800/50 rounded-lg p-4 flex-1 border border-slate-700">
                            <div class="font-semibold text-green-400 mb-1">Event Tetiklenir</div>
                            <div class="text-sm text-slate-400">Log kaydÄ± + bildirim hazÄ±rlÄ±ÄŸÄ± (TODO: email)</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Teknik Detaylar -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-cyan-400">ğŸ”§ Teknik Detaylar</h2>

            <div class="grid md:grid-cols-2 gap-6">
                <!-- Database DeÄŸiÅŸiklikleri -->
                <div class="bg-slate-800/50 rounded-lg p-6 border border-slate-700">
                    <h3 class="text-xl font-bold text-cyan-300 mb-4">Database DeÄŸiÅŸiklikleri</h3>
                    <div class="space-y-3 text-sm">
                        <div>
                            <div class="text-slate-400 mb-1">subscriptions tablosu:</div>
                            <div class="bg-slate-900/50 p-2 rounded font-mono text-xs text-slate-300">
                                status: 'active' â†’ 'expired'
                            </div>
                        </div>
                        <div>
                            <div class="text-slate-400 mb-1">login_tokens tablosu:</div>
                            <div class="bg-slate-900/50 p-2 rounded font-mono text-xs text-slate-300">
                                revoked_at: NULL â†’ timestamp
                            </div>
                            <div class="text-xs text-slate-500 mt-1">4 token revoke edilir (en eski 4)</div>
                        </div>
                    </div>
                </div>

                <!-- Cache DeÄŸiÅŸiklikleri -->
                <div class="bg-slate-800/50 rounded-lg p-6 border border-slate-700">
                    <h3 class="text-xl font-bold text-cyan-300 mb-4">Cache DeÄŸiÅŸiklikleri</h3>
                    <div class="space-y-3 text-sm">
                        <div>
                            <div class="text-slate-400 mb-1">Premium cache silinir:</div>
                            <div class="bg-slate-900/50 p-2 rounded font-mono text-xs text-slate-300">
                                user_{id}_is_premium_tenant_1001
                            </div>
                        </div>
                        <div>
                            <div class="text-slate-400 mb-1">Sonraki sorgu:</div>
                            <div class="bg-slate-900/50 p-2 rounded text-xs text-red-300">
                                isPremium() â†’ <span class="text-red-400 font-bold">false</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Kod AkÄ±ÅŸÄ± -->
                <div class="bg-slate-800/50 rounded-lg p-6 border border-slate-700">
                    <h3 class="text-xl font-bold text-cyan-300 mb-4">Kod AkÄ±ÅŸ SÄ±rasÄ±</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full bg-blue-600 text-white flex items-center justify-center text-xs font-bold">1</div>
                            <div class="text-slate-300 font-mono text-xs">Command::handle()</div>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full bg-purple-600 text-white flex items-center justify-center text-xs font-bold">2</div>
                            <div class="text-slate-300 font-mono text-xs">Subscription::update()</div>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full bg-red-600 text-white flex items-center justify-center text-xs font-bold">3</div>
                            <div class="text-slate-300 font-mono text-xs">Observer::updated()</div>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full bg-yellow-600 text-white flex items-center justify-center text-xs font-bold">4</div>
                            <div class="text-slate-300 font-mono text-xs">DeviceService::enforce()</div>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full bg-green-600 text-white flex items-center justify-center text-xs font-bold">5</div>
                            <div class="text-slate-300 font-mono text-xs">Event::dispatch()</div>
                        </div>
                    </div>
                </div>

                <!-- Sistem Garantileri -->
                <div class="bg-slate-800/50 rounded-lg p-6 border border-slate-700">
                    <h3 class="text-xl font-bold text-cyan-300 mb-4">Sistem Garantileri</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex items-start gap-2">
                            <div class="text-green-400 mt-1">âœ“</div>
                            <div class="text-slate-300">Atomik iÅŸlem (transaction)</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <div class="text-green-400 mt-1">âœ“</div>
                            <div class="text-slate-300">Idempotent (tekrar Ã§alÄ±ÅŸtÄ±rÄ±labilir)</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <div class="text-green-400 mt-1">âœ“</div>
                            <div class="text-slate-300">Race condition korumalÄ±</div>
                        </div>
                        <div class="flex items-start gap-2">
                            <div class="text-green-400 mt-1">âœ“</div>
                            <div class="text-slate-300">Otomatik rollback (hata durumunda)</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- KullanÄ±cÄ± SenaryolarÄ± -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-orange-400">ğŸ‘¤ KullanÄ±cÄ± SenaryolarÄ±</h2>

            <div class="space-y-6">
                <!-- Senaryo 1 -->
                <div class="bg-slate-800/50 rounded-lg p-6 border border-slate-700">
                    <div class="flex items-start gap-4 mb-4">
                        <div class="w-12 h-12 rounded-full bg-orange-600 flex items-center justify-center text-2xl">ğŸ§</div>
                        <div>
                            <h3 class="text-lg font-bold text-orange-300">Senaryo 1: Aktif Dinlerken Abonelik Biter</h3>
                            <div class="text-sm text-slate-400">KullanÄ±cÄ± iPhone'da mÃ¼zik dinliyor, gece 03:00'te abonelik bitiyor</div>
                        </div>
                    </div>
                    <div class="bg-slate-900/50 rounded p-4 space-y-2 text-sm">
                        <div class="text-slate-300">
                            <span class="text-red-400 font-semibold">03:00:</span> Subscription current_period_end geÃ§ti
                        </div>
                        <div class="text-slate-300">
                            <span class="text-blue-400 font-semibold">06:00:</span> Cron Ã§alÄ±ÅŸÄ±r, status=expired olur
                        </div>
                        <div class="text-slate-300">
                            <span class="text-purple-400 font-semibold">06:00:</span> Observer: Cache temizlenir, fazla cihazlar kapatÄ±lÄ±r
                        </div>
                        <div class="text-slate-300">
                            <span class="text-yellow-400 font-semibold">KullanÄ±cÄ± deneyimi:</span>
                            Åu an Ã§alan ÅŸarkÄ± devam eder (kesintisiz), ancak SONRAK Ä° ÅŸarkÄ± 30 saniye preview olur
                        </div>
                    </div>
                </div>

                <!-- Senaryo 2 -->
                <div class="bg-slate-800/50 rounded-lg p-6 border border-slate-700">
                    <div class="flex items-start gap-4 mb-4">
                        <div class="w-12 h-12 rounded-full bg-pink-600 flex items-center justify-center text-2xl">ğŸ“±</div>
                        <div>
                            <h3 class="text-lg font-bold text-pink-300">Senaryo 2: Ã‡oklu Cihaz KullanÄ±cÄ±sÄ±</h3>
                            <div class="text-sm text-slate-400">5 cihazda login, abonelik bitiyor</div>
                        </div>
                    </div>
                    <div class="bg-slate-900/50 rounded p-4 space-y-2 text-sm">
                        <div class="text-slate-300">
                            <span class="text-green-400 font-semibold">iPhone:</span> 2 saat Ã¶nce login â†’ AKTÄ°F KALIR âœ“
                        </div>
                        <div class="text-slate-300">
                            <span class="text-red-400 font-semibold">MacBook:</span> 1 gÃ¼n Ã¶nce login â†’ LOGOUT âœ—
                        </div>
                        <div class="text-slate-300">
                            <span class="text-red-400 font-semibold">iPad:</span> 3 gÃ¼n Ã¶nce login â†’ LOGOUT âœ—
                        </div>
                        <div class="text-slate-300">
                            <span class="text-red-400 font-semibold">Samsung:</span> 5 gÃ¼n Ã¶nce login â†’ LOGOUT âœ—
                        </div>
                        <div class="text-slate-300">
                            <span class="text-red-400 font-semibold">Windows:</span> 7 gÃ¼n Ã¶nce login â†’ LOGOUT âœ—
                        </div>
                        <div class="mt-3 text-slate-400 border-t border-slate-700 pt-2">
                            KapatÄ±lan cihazlar tekrar login yapabilir, ancak aynÄ± anda sadece 1 cihaz aktif kalabilir (yeni login â†’ eski logout)
                        </div>
                    </div>
                </div>

                <!-- Senaryo 3 -->
                <div class="bg-slate-800/50 rounded-lg p-6 border border-slate-700">
                    <div class="flex items-start gap-4 mb-4">
                        <div class="w-12 h-12 rounded-full bg-blue-600 flex items-center justify-center text-2xl">ğŸ”„</div>
                        <div>
                            <h3 class="text-lg font-bold text-blue-300">Senaryo 3: Abonelik Yenileme</h3>
                            <div class="text-sm text-slate-400">KullanÄ±cÄ± expire olduktan sonra yeniden premium alÄ±yor</div>
                        </div>
                    </div>
                    <div class="bg-slate-900/50 rounded p-4 space-y-2 text-sm">
                        <div class="text-slate-300">
                            <span class="text-red-400 font-semibold">AdÄ±m 1:</span> Status = expired, preview mode aktif, 1 cihaz limiti
                        </div>
                        <div class="text-slate-300">
                            <span class="text-green-400 font-semibold">AdÄ±m 2:</span> KullanÄ±cÄ± yeni subscription satÄ±n alÄ±r
                        </div>
                        <div class="text-slate-300">
                            <span class="text-blue-400 font-semibold">AdÄ±m 3:</span> Observer tetiklenir, cache temizlenir
                        </div>
                        <div class="text-slate-300">
                            <span class="text-purple-400 font-semibold">AdÄ±m 4:</span> Device limit: 1 â†’ 5 cihaz (plan limiti)
                        </div>
                        <div class="text-slate-300">
                            <span class="text-yellow-400 font-semibold">SonuÃ§:</span> AnÄ±nda unlimited access + 5 cihaz hakkÄ±
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Ã–zet -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-emerald-400">ğŸ“Œ Ã–zet</h2>

            <div class="bg-gradient-to-r from-emerald-900/30 to-teal-900/30 border-l-4 border-emerald-500 rounded-lg p-8">
                <div class="space-y-4 text-slate-300">
                    <p class="text-lg leading-relaxed">
                        Premium abonelik bittiÄŸinde sistem <span class="text-emerald-400 font-semibold">tamamen otomatik</span> ve
                        <span class="text-teal-400 font-semibold">kesintisiz</span> Ã§alÄ±ÅŸÄ±r. KullanÄ±cÄ± hiÃ§bir ÅŸey yapmadan:
                    </p>
                    <ul class="space-y-2 ml-6">
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-400 mt-1">âœ“</span>
                            <span>Her gÃ¼n sabah 06:00'da otomatik kontrol</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-400 mt-1">âœ“</span>
                            <span>Subscription status gÃ¼ncellemesi (1 saniye iÃ§inde)</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-400 mt-1">âœ“</span>
                            <span>Premium cache temizliÄŸi (anÄ±nda)</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-400 mt-1">âœ“</span>
                            <span>Fazla cihazlarÄ±n otomatik logout'u (LIFO mantÄ±ÄŸÄ±)</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-400 mt-1">âœ“</span>
                            <span>MÃ¼zik dinleme kÄ±sÄ±tlamasÄ± (30 saniye preview)</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-400 mt-1">âœ“</span>
                            <span>Event sistemi ve bildirim hazÄ±rlÄ±ÄŸÄ±</span>
                        </li>
                    </ul>
                    <p class="text-lg leading-relaxed pt-4 border-t border-slate-700">
                        TÃ¼m bu iÅŸlemler <span class="text-yellow-400 font-semibold">race condition korumalÄ±</span>,
                        <span class="text-purple-400 font-semibold">idempotent</span> (tekrar Ã§alÄ±ÅŸtÄ±rÄ±labilir) ve
                        <span class="text-pink-400 font-semibold">atomik</span> (ya hepsi baÅŸarÄ±lÄ±, ya hiÃ§biri).
                    </p>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="mt-20 pt-8 border-t border-slate-700 text-center text-slate-500 text-sm">
            <p>ğŸ¤– Claude AI tarafÄ±ndan oluÅŸturuldu - Tailwind CSS</p>
            <p class="mt-2">ğŸ“Š Sistem akÄ±ÅŸÄ± analizi - Muzibu.com.tr Premium Subscription</p>
        </footer>
    </div>
</body>
</html>
