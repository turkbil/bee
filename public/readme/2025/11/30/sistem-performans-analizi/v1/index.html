<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Performans Analizi Raporu - Analiz & Plan</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            line-height: 1.7;
            padding: 40px 20px;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        header {
            margin-bottom: 50px;
            padding-bottom: 30px;
            border-bottom: 2px solid #334155;
        }
        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #60a5fa, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .meta { color: #94a3b8; font-size: 0.95rem; }
        section { margin-bottom: 40px; }
        h2 {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: #60a5fa;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .plan-item {
            background: rgba(30, 41, 59, 0.5);
            padding: 25px;
            margin-bottom: 20px;
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        .plan-item:hover { transform: translateY(-2px); background: rgba(30, 41, 59, 0.7); }
        .plan-item h3 { color: #93c5fd; margin-bottom: 12px; font-size: 1.4rem; }
        .plan-item p { color: #cbd5e1; line-height: 1.8; margin-bottom: 10px; }
        .tech-term { color: #fbbf24; font-weight: 600; font-family: 'Fira Code', monospace; }
        .explanation { display: block; margin-top: 5px; color: #94a3b8; font-size: 0.9rem; border-left: 2px solid #475569; padding-left: 15px; }
        .priority { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: 600; margin-left: 10px; }
        .priority-critical { background: #dc2626; color: white; }
        .priority-high { background: #f59e0b; color: white; }
        .recommendation { background: rgba(16, 185, 129, 0.1); border-left-color: #10b981; padding: 20px; margin-top: 20px; border-radius: 8px; }
        .recommendation h4 { color: #34d399; margin-bottom: 10px; font-size: 1.1rem; }
        .code-block { background: #020617; padding: 15px; border-radius: 8px; font-family: 'Fira Code', monospace; font-size: 0.9rem; margin-top: 10px; border: 1px solid #1e293b; }
        footer { margin-top: 60px; padding-top: 30px; border-top: 1px solid #334155; color: #64748b; font-size: 0.9rem; text-align: center; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“Š Sistem Performans Analizi Raporu</h1>
            <div class="meta">
                ğŸ“… Tarih: 2025-11-30 |
                ğŸ¯ Tenant: ixtif.com |
                ğŸ‘¤ Talep: Sistem aÅŸÄ±rÄ± yavaÅŸ, sorunun analizi ve raporlanmasÄ±.
            </div>
        </header>

        <section>
            <h2>ğŸ“ Genel DeÄŸerlendirme</h2>
            <div class="plan-item" style="border-left-color: #fbbf24;">
                <p>
                    YapÄ±lan detaylÄ± analiz sonucunda, sistemdeki aÅŸÄ±rÄ± yavaÅŸlÄ±ÄŸÄ±n donanÄ±msal bir yetersizlikten deÄŸil, birbiriyle iliÅŸkili **iki kritik yazÄ±lÄ±m mimarisi ve yapÄ±landÄ±rma sorunundan** kaynaklandÄ±ÄŸÄ± tespit edilmiÅŸtir. Sorunlar, hem tÃ¼m sistemi etkileyen genel bir yavaÅŸlÄ±ÄŸa hem de Ã¶zellikle `ixtif.com` gibi tenant'larda yaÅŸanan aÅŸÄ±rÄ± yavaÅŸlamalara neden olmaktadÄ±r.
                </p>
                <p>AÅŸaÄŸÄ±da bu iki ana sorun ve Ã§Ã¶zÃ¼m Ã¶nerileri detaylandÄ±rÄ±lmÄ±ÅŸtÄ±r.</p>
            </div>
        </section>

        <section>
            <h2>ğŸ¯ Tespit Edilen Sorunlar ve Ã‡Ã¶zÃ¼m Ã–nerileri</h2>

            <div class="plan-item">
                <h3>1. Arka Plan Ä°ÅŸlem DarboÄŸazÄ± <span class="priority priority-critical">Kritik Ã–ncelik</span></h3>
                <p>
                    <strong>Bulgu:</strong> `ixtif.com` tenant'Ä±nda yaÅŸanan aÅŸÄ±rÄ± yavaÅŸlÄ±ÄŸÄ±n **ana nedeni budur**. Arka plan iÅŸlemlerini (mail gÃ¶nderme, rapor oluÅŸturma vb.) yÃ¼rÃ¼ten sistemde ciddi bir yapÄ±landÄ±rma hatasÄ± ve darboÄŸaz mevcuttur.
                </p>
                <p>
                    <span class="tech-term">docker-compose.yml</span> dosyasÄ±nda, birbiriyle Ã§akÄ±ÅŸan iki farklÄ± kuyruk (queue) yÃ¶netim sistemi aynÄ± anda Ã§alÄ±ÅŸmaktadÄ±r: Hem modern olan <span class="tech-term">Horizon</span> hem de eski tip <span class="tech-term">queue:work</span> container'larÄ± (`queue-general`, `queue-tenant`).
                </p>
                <p>
                    Daha da Ã¶nemlisi, <span class="tech-term">config/horizon.php</span> dosyasÄ±nda, tÃ¼m tenant'larÄ±n iÅŸlerini yÃ¼rÃ¼ten `tenant-supervisor` iÃ§in iÅŸlem limiti (`maxProcesses`) bilinÃ§li olarak **sadece 2'ye** dÃ¼ÅŸÃ¼rÃ¼lmÃ¼ÅŸtÃ¼r. Bu durum, `ixtif.com`'dan gelen en ufak bir toplu iÅŸlem talebinde bile kuyruÄŸun anÄ±nda ÅŸiÅŸmesine ve sistemin yanÄ±t veremez hale gelmesine yol aÃ§maktadÄ±r.
                </p>
                <div class="explanation">
                    <strong>Etkisi:</strong> Tenant'a Ã¶zel iÅŸlemler (sipariÅŸ onayÄ±, mail gÃ¶nderimi vb.) dakikalarca, hatta saatlerce beklemede kalÄ±r. KullanÄ±cÄ± aÃ§Ä±sÄ±ndan sistem "donmuÅŸ" veya "Ã§Ã¶kmÃ¼ÅŸ" gibi gÃ¶rÃ¼nÃ¼r.
                </div>
                <div class="recommendation">
                    <h4>ğŸ’¡ Ã‡Ã¶zÃ¼m Ã–nerisi</h4>
                    <p>1. Ã‡akÄ±ÅŸan kuyruk iÅŸÃ§ileri temizlenmelidir. `docker-compose.yml` dosyasÄ±ndan `queue-general` ve `queue-tenant` servisleri **tamamen kaldÄ±rÄ±lmalÄ±dÄ±r**.</p>
                    <p>2. TÃ¼m arka plan iÅŸlemleri sadece `horizon` servisi tarafÄ±ndan yÃ¶netilmelidir.</p>
                    <p>3. `config/horizon.php` dosyasÄ±ndaki `tenant-supervisor` iÃ§in `maxProcesses` deÄŸeri, sunucu kaynaklarÄ± gÃ¶z Ã¶nÃ¼nde bulundurularak dikkatlice ve kademeli olarak **daha makul bir seviyeye (Ã¶rneÄŸin, 8 veya 10)** yÃ¼kseltilmelidir.</p>
                </div>
            </div>

            <div class="plan-item">
                <h3>2. Laravel Optimizasyon HatasÄ± <span class="priority priority-high">YÃ¼ksek Ã–ncelik</span></h3>
                <p>
                    <strong>Bulgu:</strong> TÃ¼m sistemi etkileyen genel bir yavaÅŸlÄ±k mevcuttur. Bunun sebebi, Laravel'in en temel performans optimizasyonlarÄ± olan <span class="tech-term">config:cache</span> ve <span class="tech-term">route:cache</span> komutlarÄ±nÄ±n **baÅŸarÄ±sÄ±z olmasÄ±dÄ±r**.
                </p>
                <p>
                    <span class="tech-term">docker-compose.yml</span> dosyasÄ±nda tanÄ±mlanan birden fazla `app` container'Ä± (`app1`, `app2`, `app3`), aynÄ± anda ve paylaÅŸÄ±lmÄ±ÅŸ bir `bootstrap/cache` dizinine yazmaya Ã§alÄ±ÅŸarak bir "race condition" (yarÄ±ÅŸ durumu) yaratmaktadÄ±r. Bu Ã§akÄ±ÅŸma, cache dosyalarÄ±nÄ±n dÃ¼zgÃ¼n oluÅŸturulmasÄ±nÄ± engellemektedir.
                </p>
                <div class="explanation">
                    <strong>Etkisi:</strong> Cacheleme yapÄ±lamadÄ±ÄŸÄ± iÃ§in, sistem her bir sayfa isteÄŸinde onlarca yapÄ±landÄ±rma ve rota dosyasÄ±nÄ± yeniden okumak, iÅŸlemek ve yorumlamak zorunda kalÄ±r. Bu durum, her istekte yÃ¼zlerce milisaniyelik ek bir yÃ¼k bindirerek sitenin genelinde hissedilir bir yavaÅŸlÄ±ÄŸa neden olur.
                </div>
                <div class="recommendation">
                    <h4>ğŸ’¡ Ã‡Ã¶zÃ¼m Ã–nerisi</h4>
                    <p>Container baÅŸlatma sÃ¼reci yeniden dÃ¼zenlenmelidir. Sadece **tek bir ana uygulama container'Ä±** (`app1` gibi) `config:cache`, `route:cache` ve `migrate` gibi baÅŸlangÄ±Ã§ iÅŸlemlerini Ã§alÄ±ÅŸtÄ±rmaktan sorumlu olmalÄ±dÄ±r. DiÄŸer container'lar bu iÅŸlemlerin tamamlanmasÄ±nÄ± bekleyip daha sonra sadece web servisini (PHP-FPM) baÅŸlatmalÄ±dÄ±r. Bu, `docker-compose.yml` iÃ§inde `depends_on` ve Ã¶zel saÄŸlÄ±k kontrolÃ¼ (healthcheck) script'leri ile saÄŸlanabilir.</p>
                </div>
            </div>
        </section>

        <footer>
            ğŸ¤– Gemini AI tarafÄ±ndan oluÅŸturuldu. Bu rapor, sistemde herhangi bir deÄŸiÅŸiklik yapmadan, sadece mevcut durumun analizini iÃ§ermektedir.
        </footer>
    </div>
</body>
</html>
