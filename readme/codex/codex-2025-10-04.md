# Announcement – Page – Portfolio Master Pattern Raporu

Hazırlayan: Codex • Tarih: 04.10.2025

---

## 1. Yönetişim Özeti
- Üç modül de repository → service → Livewire zinciriyle ilerliyor; AI içerik üretimi, SEO sekmesi ve medya yöneticisi aynı bileşenleri paylaşıyor.
- Page modülü “gelişmiş” varyant (homepage mantığı + CSS/JS editörü); Announcement medya/duyuru senaryolarını, Portfolio ise kategori bazlı vitrin akışlarını hedefliyor.
- Portfolio’daki ilişki ve servis dönüş bug’ları çözülmeden bu pattern’i çoğaltmak riskli; ana referans dosyası olarak Page + Announcement ikilisi tercih edilmeli.

---

## 2. Modül Fotoğrafı

| Modül | Yönetim Formu | Medya & Tema | SEO / Slug Davranışı | Öne Çıkan Nokta |
|-------|----------------|---------------|----------------------|-----------------|
| **Page** | İçerik + AI + CSS/JS sekmeleri, homepage toggle, güvenlikli sanitizer | Opsiyonel medya; içerik içi görseller | Locale-aware slug, canonical redirect, homepage yönlendirmesi | “Ana pattern” şablonu; tüm varyantlar için en güvenli temel |
| **Announcement** | İçerik + AI + medya + SEO; sade `is_active` akışı | `featured_image` + `gallery`, otomatik medya tetikleme | Locale-aware slug + fallback; API uçlarıyla uyumlu | Medya ağırlıklı içerik modülleri için hazır blueprint |
| **Portfolio** | İçerik + AI + medya + kategori seçimi (bug’lı) | `featured_image` + `gallery`, drag-drop | Locale-aware slug; kategori bazlı routing | Kategori hiyerarşisi güçlü fakat bug’lar nedeniyle stabil değil |

---

## 3. Güçlü Noktalar
1. **Tekil Kod Kalıpları** – Slug üretimi, SEO fallback’leri, cache temizliği service katmanına alınmış; yeni modüllerde tekrar kullanılabilir.
2. **Birleşik Admin Deneyimi** – Dil switcher, tab sistemi, toast/AI eventleri aynı şekilde çalışıyor; kullanıcı eğitimi kolay.
3. **Tema & SEO Entegrasyonu** – Front controller’lar tema fallback, canonical redirect ve locale fallback’leri kapsıyor.

---

## 4. Kritik Riskler

| ID | Başlık | Risk | Etki | Konum | Yapılması Gereken |
|----|--------|------|------|-------|-------------------|
| **K1** | Kategori ilişkisi persist edilmiyor | Yüksek | Portföy kayıtları kategorisiz kalıyor, listeler bozuluyor | `Modules/Portfolio/app/Http/Livewire/Admin/PortfolioManageComponent.php:216, 423` | Form yükleme + kaydetme aşamasında `inputs['category_id']` → `portfolio_category_id` eşlemesini yapın, mevcut veriyi migrate edin. |
| **K2** | Servis–bileşen dönüş uyumsuzluğu | Yüksek | Kategori CRUD Livewire’da hata veriyor | `PortfolioCategoryComponent.php:197`, `PortfolioCategoryService.php:60`, `PortfolioCategoryManageComponent.php:257` | Servis cevaplarını tek tip DTO/array haline getirin veya bileşenleri modele göre revize edin. |
| **K3** | Yanlış enum bağımlılığı | Orta | Portfolio Page modülüne bağımlı; olası enum değişikliğinde kırılır | `Modules/Portfolio/app/Repositories/PortfolioCategoryRepository.php:14` | Portfolio modülü için ayrı `CacheStrategy` enum’u kullanın. |
| **K4** | Kategori listesi her render’da sorgulanıyor | Düşük | Büyük kataloglarda gereksiz DB yükü oluşur | `Modules/Portfolio/resources/views/admin/livewire/portfolio-manage-component.blade.php:45` | Kategori listesini Livewire tarafında cache’leyin veya eager load + memoization uygulayın. |

> **Not:** K1 ve K2 çözülmeden bu pattern başka modüllere kopyalanmamalıdır; aynı hatalar zincirleme üretilecektir.

---

## 5. Önerilen Yol Haritası
1. **Portfolio Yönetim Formunu Onarmak**
   - `inputs['category_id']` okumasını `mount()` ve `loadPageData()` içinde set edin.
   - `save()` içerisinde `portfolio_category_id` alanını açıkça doldurun.
   - Canlı veriyi SQL script’iyle güncelleyip eski kayıtları kategoriyle eşleştirin.
2. **Kategori Servis Sözleşmesini Netleştirmek**
   - `PortfolioCategoryService` tüm CRUD metodlarından tutarlı bir response (ör. DTO) döndürsün.
   - Livewire bileşenleri yalnızca bu sözleşmeye göre çalışsın; UI hataları ortadan kalksın.
3. **CacheStrategy’yi Dekuple Etmek**
   - Repository’de Page enum’una olan bağımlılığı kaldırın; portföye özel enum kullanın.
   - Bu adım yeni modüllerin bağımsızlığını garantiler.
4. **Admin Pattern’ini Belgelerle Desteklemek**
   - Page modülünden alınan checklist’i (slug, SEO, medya, AI) reposun README’sine ekleyin.
   - Yeni modül geliştirmeye başlayacak ekipler için referans döküman hazırlayın.

---

## 6. Sonraki Adımlar
- 🚧 **K1 + K2 düzeltmesi** için mini sprint planlayın; tamamlanmadan yeni modül üretimi ertelenmeli.
- ✅ Page & Announcement kodları “golden source” olarak etiketlenip referans gösterilsin.
- 📄 Bu raporun bulunduğu dosya (`README/codex/codex-2025-10-04.md`) düzenli aralıklarla güncellensin; yeni keşifler eklensin.

Kibarca özetlemek gerekirse: Page + Announcement ikilisi örnek alınmaya hazır; Portfolio’nun bug’ları giderildiğinde üçlü set sağlam bir master pattern oluşturacak.
