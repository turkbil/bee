<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abuse Timeline Chart Karşılaştırma - Gerçek Veri</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- ApexCharts -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>

    <!-- vis-timeline -->
    <script src="https://unpkg.com/vis-timeline@7.7.3/standalone/umd/vis-timeline-graph2d.min.js"></script>
    <link href="https://unpkg.com/vis-timeline@7.7.3/styles/vis-timeline-graph2d.min.css" rel="stylesheet">

    <!-- Frappe Gantt -->
    <script src="https://cdn.jsdelivr.net/npm/frappe-gantt/dist/frappe-gantt.umd.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/frappe-gantt/dist/frappe-gantt.css">

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        body { background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); }
        .chart-card { background: rgba(30, 41, 59, 0.8); border: 1px solid rgba(71, 85, 105, 0.5); }

        /* vis-timeline dark theme */
        .vis-timeline { border: none !important; background: transparent !important; }
        .vis-item { background: #3b82f6; border-color: #60a5fa; color: white; border-radius: 4px; font-size: 11px; }
        .vis-item.mobile { background: #10b981; border-color: #34d399; }
        .vis-item.overlap { background: #ef4444 !important; border-color: #f87171 !important; }
        .vis-item.vis-selected { box-shadow: 0 0 10px rgba(59, 130, 246, 0.5); }
        .vis-label { color: #94a3b8 !important; }
        .vis-labelset .vis-label { background: rgba(15, 23, 42, 0.8) !important; border-bottom: 1px solid rgba(71, 85, 105, 0.3) !important; }
        .vis-time-axis .vis-text { color: #64748b !important; fill: #64748b !important; }
        .vis-time-axis .vis-grid.vis-minor { border-color: rgba(71, 85, 105, 0.2) !important; }
        .vis-time-axis .vis-grid.vis-major { border-color: rgba(71, 85, 105, 0.4) !important; }
        .vis-panel.vis-background { background: rgba(15, 23, 42, 0.5) !important; }
        .vis-panel.vis-center { border-color: rgba(71, 85, 105, 0.3) !important; }
        .vis-panel.vis-left { background: rgba(15, 23, 42, 0.8) !important; border-right: 1px solid rgba(71, 85, 105, 0.3) !important; }
        .vis-foreground .vis-group { border-bottom: 1px solid rgba(71, 85, 105, 0.2) !important; }

        /* Frappe Gantt dark theme */
        .gantt-container { overflow-x: auto; }
        .gantt .grid-background { fill: rgba(15, 23, 42, 0.5); }
        .gantt .grid-header { fill: rgba(30, 41, 59, 0.8); stroke: rgba(71, 85, 105, 0.3); }
        .gantt .grid-row { fill: transparent; }
        .gantt .grid-row:nth-child(even) { fill: rgba(51, 65, 85, 0.2); }
        .gantt .row-line { stroke: rgba(71, 85, 105, 0.3); }
        .gantt .tick { stroke: rgba(71, 85, 105, 0.3); }
        .gantt .tick text, .gantt .lower-text, .gantt .upper-text { fill: #64748b !important; }
        .gantt .bar { rx: 4; ry: 4; }
        .gantt .bar-label { fill: white; font-size: 10px; }

        .stat-box { background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(71, 85, 105, 0.4); }
    </style>
</head>
<body class="min-h-screen text-white p-6">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-6">
            <h1 class="text-3xl font-bold mb-2">
                <i class="fas fa-chart-line text-blue-400 mr-2"></i>
                Abuse Timeline Chart Karşılaştırma
            </h1>
            <p class="text-slate-400">4 farklı chart library ile gerçek abuse verisi</p>
        </div>

        <!-- Real Data Info -->
        <div class="chart-card rounded-lg p-4 mb-6">
            <div class="flex flex-wrap items-center justify-between gap-4">
                <div>
                    <h3 class="text-lg font-semibold mb-1">
                        <i class="fas fa-database text-blue-400 mr-2"></i>Gerçek Veri: Türk Bilişim
                    </h3>
                    <p class="text-slate-400 text-sm">Rapor #3 - 22 Aralık 2025</p>
                </div>
                <div class="flex gap-4 text-center">
                    <div class="stat-box rounded-lg px-4 py-2">
                        <div class="text-2xl font-bold text-white">76</div>
                        <div class="text-xs text-slate-500">Toplam Play</div>
                    </div>
                    <div class="stat-box rounded-lg px-4 py-2">
                        <div class="text-2xl font-bold text-blue-400">65</div>
                        <div class="text-xs text-slate-500">Desktop</div>
                    </div>
                    <div class="stat-box rounded-lg px-4 py-2">
                        <div class="text-2xl font-bold text-green-400">11</div>
                        <div class="text-xs text-slate-500">Mobile</div>
                    </div>
                    <div class="stat-box rounded-lg px-4 py-2">
                        <div class="text-2xl font-bold text-red-400">193</div>
                        <div class="text-xs text-slate-500">Çakışma</div>
                    </div>
                    <div class="stat-box rounded-lg px-4 py-2">
                        <div class="text-2xl font-bold text-orange-400">305m</div>
                        <div class="text-xs text-slate-500">Abuse Score</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts -->
        <div class="space-y-6">

            <!-- 1. ApexCharts -->
            <div class="chart-card rounded-lg p-4">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold text-blue-400">
                        <span class="bg-blue-500/20 text-blue-400 px-2 py-1 rounded text-sm mr-2">1</span>
                        ApexCharts (Timeline/Range Bar)
                    </h3>
                    <a href="https://apexcharts.com/javascript-chart-demos/timeline-charts/" target="_blank" class="text-xs text-slate-500 hover:text-blue-400">
                        <i class="fas fa-external-link-alt mr-1"></i>apexcharts.com
                    </a>
                </div>
                <div id="apexChart" style="min-height: 300px;"></div>
                <div class="mt-3 grid grid-cols-2 gap-4 text-sm">
                    <div class="text-green-400">
                        <i class="fas fa-plus mr-1"></i>
                        Modern UI, tooltip, zoom, responsive, geniş ekosistem
                    </div>
                    <div class="text-red-400">
                        <i class="fas fa-minus mr-1"></i>
                        Grup bazlı satırlar için workaround gerekli
                    </div>
                </div>
            </div>

            <!-- 2. Chart.js -->
            <div class="chart-card rounded-lg p-4">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold text-green-400">
                        <span class="bg-green-500/20 text-green-400 px-2 py-1 rounded text-sm mr-2">2</span>
                        Chart.js (Floating Bar)
                    </h3>
                    <a href="https://www.chartjs.org/docs/latest/charts/bar.html#floating-bars" target="_blank" class="text-xs text-slate-500 hover:text-green-400">
                        <i class="fas fa-external-link-alt mr-1"></i>chartjs.org
                    </a>
                </div>
                <div style="height: 300px;">
                    <canvas id="chartJs"></canvas>
                </div>
                <div class="mt-3 grid grid-cols-2 gap-4 text-sm">
                    <div class="text-green-400">
                        <i class="fas fa-plus mr-1"></i>
                        Hafif (~60KB), popüler, kolay entegrasyon
                    </div>
                    <div class="text-red-400">
                        <i class="fas fa-minus mr-1"></i>
                        Native timeline desteği yok, karmaşık setup
                    </div>
                </div>
            </div>

            <!-- 3. vis-timeline (RECOMMENDED) -->
            <div class="chart-card rounded-lg p-4 border-2 border-purple-500/50">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold text-purple-400">
                        <span class="bg-purple-500/20 text-purple-400 px-2 py-1 rounded text-sm mr-2">3</span>
                        vis-timeline
                        <span class="ml-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full">ÖNERİLEN</span>
                    </h3>
                    <a href="https://visjs.github.io/vis-timeline/examples/timeline/" target="_blank" class="text-xs text-slate-500 hover:text-purple-400">
                        <i class="fas fa-external-link-alt mr-1"></i>visjs.org
                    </a>
                </div>
                <div id="visTimeline" style="min-height: 350px;"></div>
                <div class="mt-3 grid grid-cols-2 gap-4 text-sm">
                    <div class="text-green-400">
                        <i class="fas fa-plus mr-1"></i>
                        Timeline için özel tasarım, native gruplar, zoom/pan, drag, tooltip
                    </div>
                    <div class="text-red-400">
                        <i class="fas fa-minus mr-1"></i>
                        Büyük dosya boyutu (~500KB)
                    </div>
                </div>
            </div>

            <!-- 4. Frappe Gantt -->
            <div class="chart-card rounded-lg p-4">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold text-orange-400">
                        <span class="bg-orange-500/20 text-orange-400 px-2 py-1 rounded text-sm mr-2">4</span>
                        Frappe Gantt
                    </h3>
                    <a href="https://frappe.io/gantt" target="_blank" class="text-xs text-slate-500 hover:text-orange-400">
                        <i class="fas fa-external-link-alt mr-1"></i>frappe.io/gantt
                    </a>
                </div>
                <div id="frappeGantt" class="gantt-container" style="min-height: 300px;"></div>
                <div class="mt-3 grid grid-cols-2 gap-4 text-sm">
                    <div class="text-green-400">
                        <i class="fas fa-plus mr-1"></i>
                        Basit API, SVG, hafif (~50KB)
                    </div>
                    <div class="text-red-400">
                        <i class="fas fa-minus mr-1"></i>
                        Saat bazlı değil (gün/hafta bazlı), proje yönetimi için tasarlanmış
                    </div>
                </div>
            </div>

        </div>

        <!-- Comparison Table -->
        <div class="chart-card rounded-lg p-4 mt-6">
            <h3 class="text-lg font-semibold mb-4">
                <i class="fas fa-table text-slate-400 mr-2"></i>Karşılaştırma Tablosu
            </h3>
            <div class="overflow-x-auto">
                <table class="w-full text-sm">
                    <thead>
                        <tr class="text-slate-400 border-b border-slate-700">
                            <th class="text-left py-2 px-2">Özellik</th>
                            <th class="text-center py-2 px-2">ApexCharts</th>
                            <th class="text-center py-2 px-2">Chart.js</th>
                            <th class="text-center py-2 px-2 bg-purple-500/10">vis-timeline</th>
                            <th class="text-center py-2 px-2">Frappe</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="border-b border-slate-800">
                            <td class="py-2 px-2">Timeline Desteği</td>
                            <td class="text-center px-2"><span class="text-yellow-400">Orta</span></td>
                            <td class="text-center px-2"><span class="text-red-400">Zayıf</span></td>
                            <td class="text-center px-2 bg-purple-500/10"><span class="text-green-400 font-bold">Mükemmel</span></td>
                            <td class="text-center px-2"><span class="text-yellow-400">İyi</span></td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-2 px-2">Saat/Dakika Bazlı</td>
                            <td class="text-center px-2"><span class="text-green-400">✓</span></td>
                            <td class="text-center px-2"><span class="text-green-400">✓</span></td>
                            <td class="text-center px-2 bg-purple-500/10"><span class="text-green-400">✓</span></td>
                            <td class="text-center px-2"><span class="text-red-400">✗</span></td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-2 px-2">Zoom/Pan</td>
                            <td class="text-center px-2"><span class="text-green-400">✓</span></td>
                            <td class="text-center px-2"><span class="text-yellow-400">Plugin</span></td>
                            <td class="text-center px-2 bg-purple-500/10"><span class="text-green-400">✓ Native</span></td>
                            <td class="text-center px-2"><span class="text-green-400">✓</span></td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-2 px-2">Cihaz Grupları</td>
                            <td class="text-center px-2"><span class="text-yellow-400">Manuel</span></td>
                            <td class="text-center px-2"><span class="text-yellow-400">Manuel</span></td>
                            <td class="text-center px-2 bg-purple-500/10"><span class="text-green-400 font-bold">Native</span></td>
                            <td class="text-center px-2"><span class="text-red-400">✗</span></td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-2 px-2">Overlap Renklendirme</td>
                            <td class="text-center px-2"><span class="text-green-400">✓</span></td>
                            <td class="text-center px-2"><span class="text-green-400">✓</span></td>
                            <td class="text-center px-2 bg-purple-500/10"><span class="text-green-400">✓</span></td>
                            <td class="text-center px-2"><span class="text-green-400">✓</span></td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-2 px-2">Tooltip</td>
                            <td class="text-center px-2"><span class="text-green-400">✓</span></td>
                            <td class="text-center px-2"><span class="text-green-400">✓</span></td>
                            <td class="text-center px-2 bg-purple-500/10"><span class="text-green-400">✓ HTML</span></td>
                            <td class="text-center px-2"><span class="text-green-400">✓</span></td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-2 px-2">Dosya Boyutu</td>
                            <td class="text-center px-2">~450KB</td>
                            <td class="text-center px-2 text-green-400">~60KB</td>
                            <td class="text-center px-2 bg-purple-500/10">~500KB</td>
                            <td class="text-center px-2 text-green-400">~50KB</td>
                        </tr>
                        <tr class="font-bold">
                            <td class="py-3 px-2">SONUÇ</td>
                            <td class="text-center px-2 text-yellow-400">Genel Amaçlı</td>
                            <td class="text-center px-2 text-yellow-400">Basit Chart</td>
                            <td class="text-center px-2 bg-purple-500/10 text-green-400">EN UYGUN ✓</td>
                            <td class="text-center px-2 text-red-400">Proje Yönetimi</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Recommendation -->
        <div class="chart-card rounded-lg p-4 mt-6 border-l-4 border-green-500">
            <h3 class="text-lg font-semibold text-green-400 mb-2">
                <i class="fas fa-check-circle mr-2"></i>Öneri: vis-timeline
            </h3>
            <p class="text-slate-300 mb-3">
                Abuse detection timeline için <strong>vis-timeline</strong> en uygun seçenek:
            </p>
            <ul class="grid grid-cols-2 gap-2 text-sm text-slate-400">
                <li><i class="fas fa-check text-green-400 mr-2"></i>Cihaz grupları native destekleniyor</li>
                <li><i class="fas fa-check text-green-400 mr-2"></i>Saat/dakika bazlı hassas timeline</li>
                <li><i class="fas fa-check text-green-400 mr-2"></i>Overlap'leri farklı renkte göstermek kolay</li>
                <li><i class="fas fa-check text-green-400 mr-2"></i>Zoom ile detaya inme</li>
                <li><i class="fas fa-check text-green-400 mr-2"></i>HTML tooltip desteği</li>
                <li><i class="fas fa-check text-green-400 mr-2"></i>Drag & drop özelliği</li>
            </ul>
        </div>

        <!-- Footer -->
        <div class="text-center mt-8 text-slate-500 text-sm">
            <p>Claude AI - Abuse Detection Chart Comparison</p>
            <p>29 Aralık 2025</p>
        </div>
    </div>

    <script>
    // GERÇEK VERİ - Türk Bilişim Raporu #3
    const realData = {
        "report_id": 3,
        "user_name": "Türk Bilişim",
        "items": [
            {"id":311,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Death Of A Bachelor","start":"2025-12-22 10:56:58","end":"2025-12-22T10:59:05+03:00","className":"desktop chrome","title":"Death Of A Bachelor\n10:56:58 - 10:59:05\nDesktop / Chrome (Unknown)"},
            {"id":312,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Test Upload - 01:56:57","start":"2025-12-22 13:03:08","end":"2025-12-22T13:06:03+03:00","className":"desktop chrome overlap","title":"Test Upload - 01:56:57\n13:03:08 - 13:06:03\nDesktop / Chrome (Unknown)"},
            {"id":313,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Every Step","start":"2025-12-22 13:04:32","end":"2025-12-22T13:07:56+03:00","className":"desktop chrome overlap","title":"Every Step\n13:04:32 - 13:07:56\nDesktop / Chrome (Unknown)"},
            {"id":314,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Dancin","start":"2025-12-22 13:40:00","end":"2025-12-22T13:43:36+03:00","className":"desktop chrome overlap","title":"Dancin\n13:40:00 - 13:43:36\nDesktop / Chrome (Unknown)"},
            {"id":315,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Cold Love","start":"2025-12-22 13:40:12","end":"2025-12-22T13:42:15+03:00","className":"desktop chrome overlap","title":"Cold Love\n13:40:12 - 13:42:15\nDesktop / Chrome (Unknown)"},
            {"id":316,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Bulk Upload Test 3","start":"2025-12-22 13:40:50","end":"2025-12-22T13:43:45+03:00","className":"desktop chrome overlap","title":"Bulk Upload Test 3\n13:40:50 - 13:43:45\nDesktop / Chrome (Unknown)"},
            {"id":317,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Cupid","start":"2025-12-22 13:40:59","end":"2025-12-22T13:43:36+03:00","className":"desktop chrome overlap","title":"Cupid\n13:40:59 - 13:43:36\nDesktop / Chrome (Unknown)"},
            {"id":318,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Devil In Your Eyes","start":"2025-12-22 13:42:04","end":"2025-12-22T13:44:07+03:00","className":"desktop chrome overlap","title":"Devil In Your Eyes\n13:42:04 - 13:44:07\nDesktop / Chrome (Unknown)"},
            {"id":319,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Don't You Worry","start":"2025-12-22 13:48:18","end":"2025-12-22T13:51:28+03:00","className":"desktop chrome overlap","title":"Don't You Worry\n13:48:18 - 13:51:28\nDesktop / Chrome (Unknown)"},
            {"id":320,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"DAYDREAMING","start":"2025-12-22 13:49:42","end":"2025-12-22T13:52:10+03:00","className":"desktop chrome overlap","title":"DAYDREAMING\n13:49:42 - 13:52:10\nDesktop / Chrome (Unknown)"},
            {"id":321,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Cold Love","start":"2025-12-22 13:50:40","end":"2025-12-22T13:52:43+03:00","className":"desktop chrome overlap","title":"Cold Love\n13:50:40 - 13:52:43\nDesktop / Chrome (Unknown)"},
            {"id":322,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Dancin","start":"2025-12-22 14:45:26","end":"2025-12-22T14:49:02+03:00","className":"desktop chrome overlap","title":"Dancin\n14:45:26 - 14:49:02\nDesktop / Chrome (Unknown)"},
            {"id":323,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Enchanted Forest","start":"2025-12-22 14:45:43","end":"2025-12-22T14:48:36+03:00","className":"desktop chrome overlap","title":"Enchanted Forest\n14:45:43 - 14:48:36\nDesktop / Chrome (Unknown)"},
            {"id":324,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Every Step","start":"2025-12-22 14:46:17","end":"2025-12-22T14:49:41+03:00","className":"desktop chrome overlap","title":"Every Step\n14:46:17 - 14:49:41\nDesktop / Chrome (Unknown)"},
            {"id":325,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Don't You Worry","start":"2025-12-22 14:46:40","end":"2025-12-22T14:49:50+03:00","className":"desktop chrome overlap","title":"Don't You Worry\n14:46:40 - 14:49:50\nDesktop / Chrome (Unknown)"},
            {"id":326,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Dancin","start":"2025-12-22 14:58:36","end":"2025-12-22T15:02:12+03:00","className":"desktop chrome overlap","title":"Dancin\n14:58:36 - 15:02:12\nDesktop / Chrome (Unknown)"},
            {"id":327,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"En Su Lugar","start":"2025-12-22 14:58:57","end":"2025-12-22T15:01:35+03:00","className":"desktop chrome overlap","title":"En Su Lugar\n14:58:57 - 15:01:35\nDesktop / Chrome (Unknown)"},
            {"id":328,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Enchanted Forest","start":"2025-12-22 14:59:42","end":"2025-12-22T15:02:35+03:00","className":"desktop chrome overlap","title":"Enchanted Forest\n14:59:42 - 15:02:35\nDesktop / Chrome (Unknown)"},
            {"id":329,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"Devil In Your Eyes","start":"2025-12-22 14:59:50","end":"2025-12-22T15:01:53+03:00","className":"desktop chrome overlap","title":"Devil In Your Eyes\n14:59:50 - 15:01:53\nDesktop / Chrome (Unknown)"},
            {"id":330,"group":"desktop","browser":"chrome","platform":"Unknown","device_key":"Unknown-chrome-89.180","ip":"88.230.89.180","content":"En Su Lugar","start":"2025-12-22 17:03:36","end":"2025-12-22T17:06:14+03:00","className":"desktop chrome","title":"En Su Lugar\n17:03:36 - 17:06:14\nDesktop / Chrome (Unknown)"}
        ],
        "overlaps": [
            {"play1":{"id":312,"song":"Test Upload","device":"desktop","browser":"chrome"},"play2":{"id":313,"song":"Every Step","device":"desktop","browser":"chrome"},"overlap_seconds":91,"overlap_start":"2025-12-22 13:04:32","same_browser":true},
            {"play1":{"id":314,"song":"Dancin","device":"desktop","browser":"chrome"},"play2":{"id":315,"song":"Cold Love","device":"desktop","browser":"chrome"},"overlap_seconds":123,"overlap_start":"2025-12-22 13:40:12","same_browser":true},
            {"play1":{"id":314,"song":"Dancin","device":"desktop","browser":"chrome"},"play2":{"id":316,"song":"Bulk Upload Test 3","device":"desktop","browser":"chrome"},"overlap_seconds":166,"overlap_start":"2025-12-22 13:40:50","same_browser":true},
            {"play1":{"id":314,"song":"Dancin","device":"desktop","browser":"chrome"},"play2":{"id":317,"song":"Cupid","device":"desktop","browser":"chrome"},"overlap_seconds":157,"overlap_start":"2025-12-22 13:40:59","same_browser":true}
        ],
        "stats": {"total_plays":76,"desktop_plays":65,"mobile_plays":11,"overlap_count":193,"abuse_score":18315}
    };

    // Helper: Parse date string
    function parseDate(str) {
        if (!str) return new Date();
        // Handle ISO format with timezone
        if (str.includes('T')) {
            return new Date(str);
        }
        // Handle "2025-12-22 13:03:08" format
        return new Date(str.replace(' ', 'T') + '+03:00');
    }

    // 1. ApexCharts
    const apexData = realData.items.map(item => ({
        x: item.content.substring(0, 20),
        y: [parseDate(item.start).getTime(), parseDate(item.end).getTime()],
        fillColor: item.className.includes('overlap') ? '#ef4444' : '#3b82f6'
    }));

    const apexOptions = {
        series: [{
            name: 'Dinlemeler',
            data: apexData
        }],
        chart: {
            type: 'rangeBar',
            height: 300,
            background: 'transparent',
            toolbar: { show: true },
            zoom: { enabled: true }
        },
        plotOptions: {
            bar: { horizontal: true, barHeight: '70%', rangeBarGroupRows: true }
        },
        xaxis: {
            type: 'datetime',
            labels: {
                style: { colors: '#94a3b8' },
                datetimeFormatter: { hour: 'HH:mm', minute: 'HH:mm' }
            }
        },
        yaxis: {
            labels: {
                style: { colors: '#94a3b8', fontSize: '10px' },
                maxWidth: 150
            }
        },
        tooltip: {
            theme: 'dark',
            x: { format: 'HH:mm:ss' },
            custom: function({ dataPointIndex }) {
                const item = realData.items[dataPointIndex];
                const isOverlap = item.className.includes('overlap');
                return `<div class="p-2 text-xs">
                    <strong>${item.content}</strong><br>
                    ${item.start.split(' ')[1]} - ${item.end.split('T')[1]?.substring(0,8) || ''}<br>
                    ${item.browser} / ${item.platform}<br>
                    ${isOverlap ? '<span style="color:#ef4444">⚠️ ÇAKIŞMA</span>' : ''}
                </div>`;
            }
        },
        grid: { borderColor: 'rgba(71, 85, 105, 0.3)' },
        theme: { mode: 'dark' }
    };
    new ApexCharts(document.querySelector("#apexChart"), apexOptions).render();

    // 2. Chart.js - Zaman aralığını hesapla
    const chartJsCtx = document.getElementById('chartJs').getContext('2d');

    // Tüm tarihleri parse et ve min/max bul
    const allTimes = [];
    realData.items.forEach(item => {
        allTimes.push(parseDate(item.start).getTime());
        allTimes.push(parseDate(item.end).getTime());
    });
    const minTime = Math.min(...allTimes);
    const maxTime = Math.max(...allTimes);

    const chartJsData = {
        labels: realData.items.map(item => item.content.substring(0, 15)),
        datasets: [{
            label: 'Dinleme Süresi',
            data: realData.items.map(item => {
                const start = parseDate(item.start).getTime();
                const end = parseDate(item.end).getTime();
                return [start, end];
            }),
            backgroundColor: realData.items.map(item =>
                item.className.includes('overlap') ? 'rgba(239, 68, 68, 0.8)' : 'rgba(59, 130, 246, 0.8)'
            ),
            borderColor: realData.items.map(item =>
                item.className.includes('overlap') ? '#f87171' : '#60a5fa'
            ),
            borderWidth: 1,
            borderRadius: 4,
            barPercentage: 0.8
        }]
    };
    new Chart(chartJsCtx, {
        type: 'bar',
        data: chartJsData,
        options: {
            indexAxis: 'y',
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: {
                    type: 'time',
                    min: minTime - (5 * 60 * 1000), // 5 dakika önceden başla
                    max: maxTime + (5 * 60 * 1000), // 5 dakika sonrasına kadar
                    time: {
                        unit: 'minute',
                        stepSize: 30,
                        displayFormats: { minute: 'HH:mm', hour: 'HH:mm' }
                    },
                    grid: { color: 'rgba(71, 85, 105, 0.3)' },
                    ticks: { color: '#94a3b8' }
                },
                y: {
                    grid: { color: 'rgba(71, 85, 105, 0.3)' },
                    ticks: { color: '#94a3b8', font: { size: 10 } }
                }
            },
            plugins: {
                legend: { display: false },
                tooltip: {
                    backgroundColor: 'rgba(30, 41, 59, 0.95)',
                    titleColor: '#e2e8f0',
                    bodyColor: '#94a3b8',
                    callbacks: {
                        label: function(context) {
                            const item = realData.items[context.dataIndex];
                            return [
                                item.content,
                                `${item.browser} / ${item.platform}`,
                                item.className.includes('overlap') ? '⚠️ ÇAKIŞMA' : ''
                            ].filter(Boolean);
                        }
                    }
                }
            }
        }
    });

    // 3. vis-timeline (RECOMMENDED)
    const visContainer = document.getElementById('visTimeline');

    // Grupları device_key'e göre oluştur
    const deviceKeys = [...new Set(realData.items.map(item => item.device_key))];
    const visGroups = new vis.DataSet(deviceKeys.map((key, idx) => {
        const item = realData.items.find(i => i.device_key === key);
        const icon = item.group === 'mobile' ? 'fa-mobile-alt' : 'fa-desktop';
        const color = item.group === 'mobile' ? '#34d399' : '#60a5fa';
        return {
            id: key,
            content: `<div style="padding: 4px;">
                <i class="fas ${icon}" style="color: ${color}; margin-right: 4px;"></i>
                <span style="font-size: 11px;">${item.browser}</span>
                <div style="font-size: 9px; color: #64748b;">${item.platform}</div>
            </div>`,
            style: `min-height: 50px;`
        };
    }));

    const visItems = new vis.DataSet(realData.items.map(item => {
        const isOverlap = item.className.includes('overlap');
        return {
            id: item.id,
            group: item.device_key,
            content: `<span style="font-size: 10px;">${item.content.substring(0, 15)}</span>`,
            start: parseDate(item.start),
            end: parseDate(item.end),
            className: item.group + (isOverlap ? ' overlap' : ''),
            title: `<div style="padding: 8px; max-width: 250px;">
                <strong style="color: #e2e8f0;">${item.content}</strong><br>
                <span style="color: #94a3b8;">${item.start.split(' ')[1]} - ${item.end.split('T')[1]?.substring(0,8) || ''}</span><br>
                <span style="color: #64748b;">${item.browser} / ${item.platform}</span><br>
                <span style="color: #64748b;">IP: ${item.ip}</span>
                ${isOverlap ? '<br><strong style="color: #ef4444;">⚠️ ÇAKIŞMA TESPİT EDİLDİ</strong>' : ''}
            </div>`
        };
    }));

    const visOptions = {
        stack: false,
        showMajorLabels: true,
        showMinorLabels: true,
        zoomMin: 1000 * 60 * 5,  // 5 min
        zoomMax: 1000 * 60 * 60 * 12, // 12 hour
        orientation: 'top',
        margin: { item: { horizontal: 0, vertical: 5 } },
        tooltip: { followMouse: true, overflowMethod: 'cap' },
        start: parseDate('2025-12-22 13:00:00'),
        end: parseDate('2025-12-22 16:00:00')
    };

    new vis.Timeline(visContainer, visItems, visGroups, visOptions);

    // 4. Frappe Gantt
    const frappeContainer = document.getElementById('frappeGantt');

    // Frappe saat bazlı değil, gün bazlı - gösterim amaçlı
    const frappeTasks = realData.items.slice(0, 10).map((item, idx) => {
        const isOverlap = item.className.includes('overlap');
        return {
            id: 'task-' + item.id,
            name: item.content.substring(0, 25),
            start: '2025-12-22',
            end: '2025-12-22',
            progress: 100,
            custom_class: isOverlap ? 'bar-overlap' : 'bar-normal'
        };
    });

    try {
        const gantt = new Gantt(frappeContainer, frappeTasks, {
            view_mode: 'Day',
            date_format: 'YYYY-MM-DD',
            bar_height: 25,
            bar_corner_radius: 4,
            padding: 15,
            custom_popup_html: function(task) {
                const item = realData.items.find(i => 'task-' + i.id === task.id);
                if (!item) return `<div class="p-2 text-xs">${task.name}</div>`;
                return `<div style="padding: 8px; background: #1e293b; border: 1px solid #334155; border-radius: 4px; color: #e2e8f0; font-size: 11px;">
                    <strong>${item.content}</strong><br>
                    <span style="color: #94a3b8;">${item.start.split(' ')[1]}</span><br>
                    <span style="color: #64748b;">${item.browser}</span>
                </div>`;
            }
        });
    } catch(e) {
        frappeContainer.innerHTML = `
            <div class="text-center py-8">
                <i class="fas fa-exclamation-triangle text-yellow-400 text-2xl mb-2"></i>
                <div class="text-yellow-400">Frappe Gantt saat bazlı timeline için uygun değil</div>
                <div class="text-slate-500 text-sm mt-1">Gün/Hafta bazlı proje yönetimi için tasarlanmış</div>
            </div>`;
    }

    // Style Frappe bars
    setTimeout(() => {
        document.querySelectorAll('.gantt .bar').forEach((bar, idx) => {
            const item = realData.items[idx];
            if (item && item.className.includes('overlap')) {
                bar.style.fill = '#ef4444';
                bar.style.stroke = '#f87171';
            } else {
                bar.style.fill = '#3b82f6';
                bar.style.stroke = '#60a5fa';
            }
        });
    }, 500);
    </script>
</body>
</html>
