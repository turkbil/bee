<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abuse Detection - User #1 Haftalık Timeline (v6)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gradient-bg { background: linear-gradient(135deg, #1e293b 0%, #0f172a 50%, #1e1b4b 100%); }
        .card { background: rgba(30, 41, 59, 0.8); backdrop-filter: blur(10px); }
        .overlap-high { border-left: 4px solid #ef4444; background: rgba(239, 68, 68, 0.1); }
        .overlap-medium { border-left: 4px solid #f59e0b; background: rgba(245, 158, 11, 0.1); }
        .overlap-low { border-left: 4px solid #22c55e; background: rgba(34, 197, 94, 0.1); }
        .device-desktop { background: #3b82f6; }
        .device-mobile { background: #10b981; }
        .timeline-line { position: relative; }
        .timeline-line::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, #3b82f6, #8b5cf6, #ec4899);
        }
        .play-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            position: relative;
            z-index: 10;
        }
    </style>
</head>
<body class="gradient-bg min-h-screen text-white">
    <!-- Header -->
    <header class="border-b border-white/10 py-6">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex items-center justify-between">
                <div>
                    <span class="px-3 py-1 bg-red-500/20 text-red-400 text-xs font-bold rounded-full border border-red-500/30">
                        <i class="fas fa-shield-alt mr-1"></i> ABUSE DETECTION v6
                    </span>
                    <h1 class="text-3xl font-bold mt-3 bg-gradient-to-r from-white to-gray-400 bg-clip-text text-transparent">
                        User #1 - Haftalık Timeline Analizi
                    </h1>
                    <p class="text-gray-400 mt-1">22-29 Aralık 2025 | Otomatik JSON Tabanlı Analiz</p>
                </div>
                <div class="text-right">
                    <div class="text-sm text-gray-400">Rapor Tarihi</div>
                    <div class="text-xl font-bold">29 Aralık 2025</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Stats Cards -->
    <div class="max-w-7xl mx-auto px-4 py-6">
        <div class="grid grid-cols-2 md:grid-cols-5 gap-4" id="stats-cards">
            <!-- Dinamik olarak doldurulacak -->
        </div>
    </div>

    <!-- Overlap Alerts -->
    <div class="max-w-7xl mx-auto px-4 py-4" id="overlap-alerts">
        <!-- Dinamik olarak doldurulacak -->
    </div>

    <!-- Daily Timeline -->
    <div class="max-w-7xl mx-auto px-4 py-6" id="daily-timeline">
        <!-- Dinamik olarak doldurulacak -->
    </div>

    <!-- JSON Export -->
    <div class="max-w-7xl mx-auto px-4 py-6">
        <div class="card rounded-xl p-6 border border-white/10">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-bold"><i class="fas fa-code mr-2 text-purple-400"></i>Raw JSON Data</h3>
                <button onclick="copyJSON()" class="px-4 py-2 bg-purple-500/20 text-purple-400 rounded-lg hover:bg-purple-500/30 transition">
                    <i class="fas fa-copy mr-1"></i> Kopyala
                </button>
            </div>
            <pre id="json-output" class="bg-slate-900/50 rounded-lg p-4 text-xs text-gray-400 overflow-x-auto max-h-96"></pre>
        </div>
    </div>

    <!-- Footer -->
    <footer class="border-t border-white/10 py-6 mt-8">
        <div class="max-w-7xl mx-auto px-4 text-center text-gray-500 text-sm">
            <p>Muzibu B2B Music Platform - Abuse Detection System</p>
            <p class="mt-1">Claude AI tarafından otomatik oluşturuldu | v6.0</p>
        </div>
    </footer>

    <script>
    // =================================================================
    // RAW DATABASE DATA - JSON FORMAT
    // =================================================================
    const rawPlayData = [
        {"id":368,"song_id":344,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"desktop","time":"2025-12-22 20:46:59"},
        {"id":369,"song_id":351,"title":"Don't You Worry","duration":190,"ip":"92.44.171.31","device":"desktop","time":"2025-12-22 20:48:27"},
        {"id":370,"song_id":460,"title":"Bulk Upload Test 3","duration":175,"ip":"92.44.171.31","device":"desktop","time":"2025-12-22 20:51:35"},
        {"id":371,"song_id":459,"title":"Bulk Upload Test 2","duration":175,"ip":"92.44.171.31","device":"desktop","time":"2025-12-22 21:50:05"},
        {"id":372,"song_id":348,"title":"DAYDREAMING","duration":148,"ip":"92.44.171.31","device":"desktop","time":"2025-12-22 21:52:52"},
        {"id":373,"song_id":457,"title":"Test Upload","duration":175,"ip":"92.44.171.31","device":"desktop","time":"2025-12-22 23:15:52"},
        {"id":374,"song_id":356,"title":"Faded","duration":205,"ip":"92.44.171.31","device":"desktop","time":"2025-12-23 00:04:59"},
        {"id":375,"song_id":349,"title":"Death Of A Bachelor","duration":127,"ip":"92.44.171.31","device":"desktop","time":"2025-12-23 00:08:30"},
        {"id":376,"song_id":349,"title":"Death Of A Bachelor","duration":127,"ip":"92.44.171.31","device":"desktop","time":"2025-12-23 00:09:01"},
        {"id":377,"song_id":345,"title":"Cupid","duration":157,"ip":"92.44.171.31","device":"desktop","time":"2025-12-23 00:10:33"},
        {"id":378,"song_id":346,"title":"Dancin","duration":216,"ip":"92.44.171.31","device":"desktop","time":"2025-12-23 00:13:04"},
        {"id":379,"song_id":346,"title":"Dancin","duration":216,"ip":"92.44.171.31","device":"desktop","time":"2025-12-23 00:17:13"},
        {"id":380,"song_id":348,"title":"DAYDREAMING","duration":148,"ip":"92.44.171.31","device":"desktop","time":"2025-12-23 00:19:19"},
        {"id":381,"song_id":458,"title":"Bulk Upload Test 1","duration":175,"ip":"92.44.171.31","device":"desktop","time":"2025-12-23 00:21:41"},
        {"id":382,"song_id":458,"title":"Bulk Upload Test 1","duration":175,"ip":"92.44.171.31","device":"desktop","time":"2025-12-23 00:22:12"},
        {"id":383,"song_id":460,"title":"Bulk Upload Test 3","duration":175,"ip":"92.44.171.31","device":"desktop","time":"2025-12-23 00:24:31"},
        {"id":384,"song_id":457,"title":"Test Upload","duration":175,"ip":"92.44.171.31","device":"desktop","time":"2025-12-23 00:27:20"},
        {"id":385,"song_id":352,"title":"En Su Lugar","duration":158,"ip":"92.44.171.31","device":"desktop","time":"2025-12-23 00:30:11"},
        {"id":386,"song_id":356,"title":"Faded","duration":205,"ip":"92.44.171.31","device":"desktop","time":"2025-12-23 00:53:38"},
        {"id":392,"song_id":356,"title":"Faded","duration":205,"ip":"92.44.171.31","device":"desktop","time":"2025-12-24 04:20:48"},
        {"id":395,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"desktop","time":"2025-12-24 17:08:02"},
        {"id":397,"song_id":464,"title":"Yalniz Kurt","duration":175,"ip":"92.44.171.31","device":"desktop","time":"2025-12-24 18:04:20"},
        {"id":398,"song_id":464,"title":"Yalniz Kurt","duration":175,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 01:26:04"},
        {"id":399,"song_id":474,"title":"Angels","duration":148,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 01:37:46"},
        {"id":400,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 01:39:45"},
        {"id":401,"song_id":468,"title":"All Again","duration":146,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 01:43:07"},
        {"id":402,"song_id":479,"title":"Go","duration":189,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 02:02:35"},
        {"id":403,"song_id":464,"title":"Yalniz Kurt","duration":175,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 02:03:10"},
        {"id":404,"song_id":399,"title":"Overrater","duration":181,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 03:30:26"},
        {"id":412,"song_id":314,"title":"A Bar Song","duration":210,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 04:35:33"},
        {"id":413,"song_id":479,"title":"Go","duration":189,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 04:37:41"},
        {"id":414,"song_id":466,"title":"After Hours","duration":167,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 04:52:11"},
        {"id":415,"song_id":320,"title":"All Night Long","duration":120,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 05:19:28"},
        {"id":421,"song_id":475,"title":"ASHES & BLOOM","duration":160,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 20:14:45"},
        {"id":422,"song_id":473,"title":"Amen","duration":157,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 20:56:21"},
        {"id":423,"song_id":316,"title":"A Great Day","duration":186,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 22:00:42"},
        {"id":424,"song_id":373,"title":"Happier","duration":179,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 22:11:16"},
        {"id":426,"song_id":460,"title":"Bulk Upload Test 3","duration":175,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 23:51:52"},
        {"id":427,"song_id":323,"title":"ALONE","duration":175,"ip":"92.44.171.31","device":"desktop","time":"2025-12-25 23:59:19"},
        {"id":428,"song_id":334,"title":"Bless the Broken Road","duration":151,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 00:07:35"},
        {"id":429,"song_id":343,"title":"Cigarette Daydreams","duration":163,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 00:12:41"},
        {"id":430,"song_id":314,"title":"A Bar Song","duration":210,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 00:24:32"},
        {"id":431,"song_id":369,"title":"GOD","duration":142,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 00:25:43"},
        {"id":432,"song_id":314,"title":"A Bar Song","duration":210,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 00:26:08"},
        {"id":433,"song_id":314,"title":"A Bar Song","duration":210,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 00:27:07"},
        {"id":434,"song_id":320,"title":"All Night Long","duration":120,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 00:27:57"},
        {"id":435,"song_id":377,"title":"Lucky Lady","duration":179,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 00:34:46"},
        {"id":436,"song_id":435,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 00:42:45"},
        {"id":437,"song_id":472,"title":"ALONE","duration":175,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 01:36:37"},
        {"id":438,"song_id":320,"title":"All Night Long","duration":120,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 01:52:45"},
        {"id":439,"song_id":323,"title":"ALONE","duration":175,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 01:54:15"},
        {"id":440,"song_id":337,"title":"Butterflies","duration":123,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 01:57:03"},
        {"id":441,"song_id":337,"title":"Butterflies","duration":123,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 01:57:35"},
        {"id":442,"song_id":337,"title":"Butterflies","duration":123,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 03:02:10"},
        {"id":443,"song_id":459,"title":"Bulk Upload Test 2","duration":175,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 03:30:53"},
        {"id":444,"song_id":356,"title":"Faded","duration":205,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 04:38:08"},
        {"id":445,"song_id":401,"title":"Punchin Bag","duration":200,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 04:40:55"},
        {"id":446,"song_id":401,"title":"Punchin Bag","duration":200,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 04:41:26"},
        {"id":447,"song_id":391,"title":"No Lie","duration":155,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 04:44:09"},
        {"id":448,"song_id":395,"title":"Off We Go","duration":132,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 04:46:39"},
        {"id":449,"song_id":395,"title":"Off We Go","duration":132,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 04:47:10"},
        {"id":450,"song_id":471,"title":"ALMA","duration":124,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 04:48:46"},
        {"id":451,"song_id":374,"title":"How Will I Know","duration":159,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 04:49:03"},
        {"id":452,"song_id":479,"title":"Go","duration":189,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 04:49:40"},
        {"id":453,"song_id":479,"title":"Go","duration":189,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 04:50:11"},
        {"id":494,"song_id":401,"title":"Punchin Bag","duration":200,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 15:12:10"},
        {"id":495,"song_id":347,"title":"Dark Days","duration":138,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 15:12:18"},
        {"id":511,"song_id":347,"title":"Dark Days","duration":138,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 16:04:12"},
        {"id":518,"song_id":340,"title":"Charisma","duration":136,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 20:44:38"},
        {"id":519,"song_id":379,"title":"Mirror","duration":160,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 20:58:48"},
        {"id":520,"song_id":476,"title":"Gestures","duration":179,"ip":"92.44.171.31","device":"desktop","time":"2025-12-26 21:45:50"},
        {"id":521,"song_id":478,"title":"Give the People","duration":131,"ip":"92.44.171.31","device":"desktop","time":"2025-12-27 03:06:28"},
        {"id":522,"song_id":478,"title":"Give the People","duration":131,"ip":"92.44.171.31","device":"desktop","time":"2025-12-27 03:37:12"},
        {"id":523,"song_id":476,"title":"Gestures","duration":179,"ip":"92.44.171.31","device":"desktop","time":"2025-12-27 03:41:30"},
        {"id":524,"song_id":476,"title":"Gestures","duration":179,"ip":"92.44.171.31","device":"mobile","time":"2025-12-27 04:16:28"},
        {"id":525,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-27 04:18:22"},
        {"id":526,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-27 04:48:28"},
        {"id":527,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"mobile","time":"2025-12-27 04:49:26"},
        {"id":528,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"mobile","time":"2025-12-27 04:56:37"},
        {"id":529,"song_id":464,"title":"Yalniz Kurt","duration":175,"ip":"92.44.171.31","device":"desktop","time":"2025-12-27 05:11:00"},
        {"id":530,"song_id":468,"title":"All Again","duration":146,"ip":"92.44.171.31","device":"desktop","time":"2025-12-27 05:19:25"},
        {"id":531,"song_id":468,"title":"All Again","duration":146,"ip":"92.44.171.31","device":"desktop","time":"2025-12-27 05:42:27"},
        {"id":532,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"desktop","time":"2025-12-27 05:43:09"},
        {"id":533,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"desktop","time":"2025-12-27 05:43:53"},
        {"id":534,"song_id":465,"title":"Kar Tanesi","duration":146,"ip":"92.44.171.31","device":"desktop","time":"2025-12-27 05:46:24"},
        {"id":535,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"desktop","time":"2025-12-27 05:47:23"},
        {"id":536,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"desktop","time":"2025-12-27 05:49:28"},
        {"id":537,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"desktop","time":"2025-12-27 05:50:22"},
        {"id":564,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"desktop","time":"2025-12-27 21:12:15"},
        {"id":569,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"desktop","time":"2025-12-27 22:54:47"},
        {"id":570,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"desktop","time":"2025-12-27 23:10:51"},
        {"id":571,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 00:43:27"},
        {"id":572,"song_id":466,"title":"After Hours","duration":167,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 00:44:08"},
        {"id":573,"song_id":479,"title":"Go","duration":189,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 00:45:42"},
        {"id":574,"song_id":465,"title":"Kar Tanesi","duration":146,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 00:53:48"},
        {"id":575,"song_id":466,"title":"After Hours","duration":167,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 00:54:16"},
        {"id":576,"song_id":466,"title":"After Hours","duration":167,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 00:55:02"},
        {"id":577,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 00:55:24"},
        {"id":578,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 00:56:56"},
        {"id":579,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 01:05:01"},
        {"id":580,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 02:31:24"},
        {"id":581,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 02:36:14"},
        {"id":582,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 02:36:58"},
        {"id":583,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 02:53:20"},
        {"id":584,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 02:56:30"},
        {"id":585,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 03:00:30"},
        {"id":586,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 03:21:13"},
        {"id":587,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 03:23:02"},
        {"id":588,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 03:30:32"},
        {"id":589,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 03:32:26"},
        {"id":590,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 03:35:02"},
        {"id":591,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 03:40:54"},
        {"id":592,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 03:43:46"},
        {"id":593,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 03:59:59"},
        {"id":594,"song_id":464,"title":"Yalniz Kurt","duration":175,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 04:01:12"},
        {"id":595,"song_id":464,"title":"Yalniz Kurt","duration":175,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 04:05:38"},
        {"id":596,"song_id":464,"title":"Yalniz Kurt","duration":175,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 04:09:55"},
        {"id":597,"song_id":464,"title":"Yalniz Kurt","duration":175,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 04:13:18"},
        {"id":598,"song_id":391,"title":"No Lie","duration":155,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 04:15:48"},
        {"id":599,"song_id":344,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 04:19:36"},
        {"id":600,"song_id":344,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 04:28:45"},
        {"id":601,"song_id":344,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 04:29:49"},
        {"id":602,"song_id":322,"title":"ALMA","duration":124,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 04:30:01"},
        {"id":603,"song_id":319,"title":"All Again","duration":146,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 04:31:07"},
        {"id":604,"song_id":477,"title":"Give Me the Power","duration":156,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 04:34:53"},
        {"id":605,"song_id":469,"title":"All Night Long","duration":120,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 04:35:48"},
        {"id":606,"song_id":469,"title":"All Night Long","duration":120,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 04:42:42"},
        {"id":607,"song_id":469,"title":"All Night Long","duration":120,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 04:45:42"},
        {"id":608,"song_id":466,"title":"After Hours","duration":167,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 04:45:53"},
        {"id":609,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"mobile","time":"2025-12-28 04:46:43"},
        {"id":613,"song_id":467,"title":"Afterimage","duration":192,"ip":"31.143.0.193","device":"mobile","time":"2025-12-28 16:30:34"},
        {"id":614,"song_id":467,"title":"Afterimage","duration":192,"ip":"31.143.0.193","device":"mobile","time":"2025-12-28 16:47:28"},
        {"id":617,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 20:43:23"},
        {"id":618,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 20:53:05"},
        {"id":622,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 21:18:12"},
        {"id":623,"song_id":353,"title":"Enchanted Forest","duration":173,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 21:46:35"},
        {"id":624,"song_id":353,"title":"Enchanted Forest","duration":173,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 22:02:48"},
        {"id":625,"song_id":344,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 22:19:21"},
        {"id":626,"song_id":347,"title":"Dark Days","duration":138,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 22:35:56"},
        {"id":627,"song_id":347,"title":"Dark Days","duration":138,"ip":"92.44.171.31","device":"desktop","time":"2025-12-28 22:40:59"},
        {"id":628,"song_id":344,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"desktop","time":"2025-12-29 01:24:02"},
        {"id":629,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"desktop","time":"2025-12-29 02:29:03"},
        {"id":630,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"desktop","time":"2025-12-29 03:14:13"},
        {"id":639,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 14:48:11"},
        {"id":640,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 15:52:42"},
        {"id":641,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 15:55:49"},
        {"id":642,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"desktop","time":"2025-12-29 15:56:53"},
        {"id":643,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 15:58:59"},
        {"id":644,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:01:02"},
        {"id":645,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:03:54"},
        {"id":646,"song_id":465,"title":"Kar Tanesi","duration":146,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:04:27"},
        {"id":647,"song_id":466,"title":"After Hours","duration":167,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:07:27"},
        {"id":648,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:10:15"},
        {"id":649,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:11:38"},
        {"id":650,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:12:46"},
        {"id":651,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:14:30"},
        {"id":652,"song_id":464,"title":"Yalniz Kurt","duration":175,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:16:20"},
        {"id":653,"song_id":464,"title":"Yalniz Kurt","duration":175,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:17:26"},
        {"id":654,"song_id":464,"title":"Yalniz Kurt","duration":175,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:19:27"},
        {"id":655,"song_id":464,"title":"Yalniz Kurt","duration":175,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:21:13"},
        {"id":656,"song_id":465,"title":"Kar Tanesi","duration":146,"ip":"92.44.171.31","device":"desktop","time":"2025-12-29 16:21:35"},
        {"id":657,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:22:04"},
        {"id":658,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:25:19"},
        {"id":659,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:29:28"},
        {"id":660,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:30:17"},
        {"id":661,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:31:26"},
        {"id":662,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:34:03"},
        {"id":663,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:42:11"},
        {"id":664,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:44:14"},
        {"id":665,"song_id":463,"title":"Saksidaki Cicekler","duration":157,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:45:00"},
        {"id":666,"song_id":464,"title":"Yalniz Kurt","duration":175,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:47:37"},
        {"id":667,"song_id":465,"title":"Kar Tanesi","duration":146,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:50:32"},
        {"id":668,"song_id":466,"title":"After Hours","duration":167,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:52:59"},
        {"id":669,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:55:47"},
        {"id":670,"song_id":468,"title":"All Again","duration":146,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 16:58:59"},
        {"id":671,"song_id":470,"title":"You Are Not a Soldier","duration":203,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:00:57"},
        {"id":672,"song_id":472,"title":"ALONE","duration":175,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:02:41"},
        {"id":673,"song_id":473,"title":"Amen","duration":157,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:05:36"},
        {"id":674,"song_id":474,"title":"Angels","duration":148,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:08:14"},
        {"id":675,"song_id":475,"title":"ASHES & BLOOM","duration":160,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:10:11"},
        {"id":676,"song_id":476,"title":"Gestures","duration":179,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:12:43"},
        {"id":677,"song_id":477,"title":"Give Me the Power","duration":156,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:15:41"},
        {"id":678,"song_id":477,"title":"Give Me the Power","duration":156,"ip":"92.44.171.31","device":"desktop","time":"2025-12-29 17:18:09"},
        {"id":679,"song_id":478,"title":"Give the People","duration":131,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:18:20"},
        {"id":680,"song_id":462,"title":"Cold Love","duration":123,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:20:28"},
        {"id":681,"song_id":464,"title":"Yalniz Kurt","duration":175,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:22:31"},
        {"id":682,"song_id":466,"title":"After Hours","duration":167,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:25:26"},
        {"id":683,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:28:14"},
        {"id":684,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"desktop","time":"2025-12-29 17:34:21"},
        {"id":685,"song_id":468,"title":"All Again","duration":146,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:43:18"},
        {"id":686,"song_id":469,"title":"All Night Long","duration":120,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:45:45"},
        {"id":687,"song_id":470,"title":"You Are Not a Soldier","duration":203,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:47:46"},
        {"id":688,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"desktop","time":"2025-12-29 17:49:18"},
        {"id":689,"song_id":471,"title":"ALMA","duration":124,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:51:08"},
        {"id":690,"song_id":472,"title":"ALONE","duration":175,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 17:53:13"},
        {"id":691,"song_id":467,"title":"Afterimage","duration":192,"ip":"92.44.171.31","device":"desktop","time":"2025-12-29 17:54:12"},
        {"id":692,"song_id":319,"title":"All Again","duration":146,"ip":"92.44.171.31","device":"desktop","time":"2025-12-29 18:04:44"},
        {"id":693,"song_id":474,"title":"Angels","duration":148,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 18:07:26"},
        {"id":694,"song_id":475,"title":"ASHES & BLOOM","duration":160,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 18:08:31"},
        {"id":695,"song_id":476,"title":"Gestures","duration":179,"ip":"92.44.171.31","device":"mobile","time":"2025-12-29 18:11:13"}
    ];

    // =================================================================
    // ANALYSIS FUNCTIONS
    // =================================================================

    function parseTime(timeStr) {
        return new Date(timeStr.replace(' ', 'T'));
    }

    function formatDuration(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = seconds % 60;
        return `${mins}:${secs.toString().padStart(2, '0')}`;
    }

    function getDate(timeStr) {
        return timeStr.split(' ')[0];
    }

    function getTimeOnly(timeStr) {
        return timeStr.split(' ')[1];
    }

    // Detect overlaps
    function detectOverlaps(plays) {
        const overlaps = [];

        for (let i = 0; i < plays.length - 1; i++) {
            const play1 = plays[i];
            const play2 = plays[i + 1];

            const play1Start = parseTime(play1.time);
            const play1End = new Date(play1Start.getTime() + play1.duration * 1000);
            const play2Start = parseTime(play2.time);

            if (play1End > play2Start) {
                const overlapSeconds = Math.floor((play1End - play2Start) / 1000);

                // Only count if different devices (concurrent streaming)
                const differentDevices = play1.device !== play2.device;

                overlaps.push({
                    play1: play1,
                    play2: play2,
                    overlapSeconds: overlapSeconds,
                    differentDevices: differentDevices,
                    severity: overlapSeconds > 60 ? 'high' : (overlapSeconds > 30 ? 'medium' : 'low'),
                    play1End: play1End.toTimeString().split(' ')[0],
                    play2Start: play2Start.toTimeString().split(' ')[0]
                });
            }
        }

        return overlaps;
    }

    // Group plays by date
    function groupByDate(plays) {
        const groups = {};
        plays.forEach(play => {
            const date = getDate(play.time);
            if (!groups[date]) groups[date] = [];
            groups[date].push(play);
        });
        return groups;
    }

    // =================================================================
    // RENDER FUNCTIONS
    // =================================================================

    function renderStats(plays, overlaps) {
        const totalPlays = plays.length;
        const totalDuration = plays.reduce((sum, p) => sum + p.duration, 0);
        const desktopPlays = plays.filter(p => p.device === 'desktop').length;
        const mobilePlays = plays.filter(p => p.device === 'mobile').length;
        const concurrentOverlaps = overlaps.filter(o => o.differentDevices);
        const totalAbuseScore = concurrentOverlaps.reduce((sum, o) => sum + o.overlapSeconds, 0);
        const uniqueDays = [...new Set(plays.map(p => getDate(p.time)))].length;

        const html = `
            <div class="card rounded-xl p-4 border border-white/10">
                <div class="text-2xl font-bold text-blue-400">${totalPlays}</div>
                <div class="text-sm text-gray-400">Toplam Play</div>
            </div>
            <div class="card rounded-xl p-4 border border-white/10">
                <div class="text-2xl font-bold text-green-400">${formatDuration(totalDuration)}</div>
                <div class="text-sm text-gray-400">Toplam Sure</div>
            </div>
            <div class="card rounded-xl p-4 border border-white/10">
                <div class="flex gap-2">
                    <span class="text-xl font-bold text-blue-400"><i class="fas fa-desktop mr-1"></i>${desktopPlays}</span>
                    <span class="text-xl font-bold text-green-400"><i class="fas fa-mobile-alt mr-1"></i>${mobilePlays}</span>
                </div>
                <div class="text-sm text-gray-400">Cihaz Dagilimi</div>
            </div>
            <div class="card rounded-xl p-4 border border-white/10">
                <div class="text-2xl font-bold text-yellow-400">${overlaps.length}</div>
                <div class="text-sm text-gray-400">Toplam Overlap</div>
            </div>
            <div class="card rounded-xl p-4 border border-white/10 ${totalAbuseScore > 300 ? 'border-red-500/50' : ''}">
                <div class="text-2xl font-bold ${totalAbuseScore > 300 ? 'text-red-400' : 'text-orange-400'}">${totalAbuseScore}s</div>
                <div class="text-sm text-gray-400">Abuse Score (${concurrentOverlaps.length} esz.)</div>
            </div>
        `;
        document.getElementById('stats-cards').innerHTML = html;
    }

    function renderOverlapAlerts(overlaps) {
        const concurrentOverlaps = overlaps.filter(o => o.differentDevices);

        if (concurrentOverlaps.length === 0) {
            document.getElementById('overlap-alerts').innerHTML = `
                <div class="card rounded-xl p-6 border border-green-500/30 bg-green-500/10">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-check-circle text-3xl text-green-400"></i>
                        <div>
                            <h3 class="text-lg font-bold text-green-400">Esz. Dinleme Tespit Edilmedi</h3>
                            <p class="text-gray-400">Bu kullanici haftada ${overlaps.length} overlap yapmis ama hepsi ayni cihazda.</p>
                        </div>
                    </div>
                </div>
            `;
            return;
        }

        let html = `
            <div class="card rounded-xl p-6 border border-red-500/30 bg-red-500/10">
                <div class="flex items-center gap-3 mb-4">
                    <i class="fas fa-exclamation-triangle text-3xl text-red-400"></i>
                    <div>
                        <h3 class="text-lg font-bold text-red-400">ES ZAMANLI DINLEME TESPIT EDILDI!</h3>
                        <p class="text-gray-400">${concurrentOverlaps.length} farkli cihazda esz. dinleme - B2B kurali ihlali</p>
                    </div>
                </div>
                <div class="space-y-3">
        `;

        concurrentOverlaps.forEach((o, idx) => {
            html += `
                <div class="overlap-${o.severity} rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <span class="font-bold text-${o.severity === 'high' ? 'red' : o.severity === 'medium' ? 'yellow' : 'green'}-400">
                            Overlap #${idx + 1} - ${o.overlapSeconds} saniye
                        </span>
                        <span class="text-xs text-gray-500">${getDate(o.play1.time)}</span>
                    </div>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div class="bg-blue-500/20 rounded p-2">
                            <div class="text-blue-400 font-medium"><i class="fas fa-${o.play1.device === 'desktop' ? 'desktop' : 'mobile-alt'} mr-1"></i>${o.play1.device.toUpperCase()}</div>
                            <div class="text-white">${o.play1.title}</div>
                            <div class="text-gray-400">${getTimeOnly(o.play1.time)} - ${o.play1End}</div>
                        </div>
                        <div class="bg-green-500/20 rounded p-2">
                            <div class="text-green-400 font-medium"><i class="fas fa-${o.play2.device === 'desktop' ? 'desktop' : 'mobile-alt'} mr-1"></i>${o.play2.device.toUpperCase()}</div>
                            <div class="text-white">${o.play2.title}</div>
                            <div class="text-gray-400">${getTimeOnly(o.play2.time)} basladi</div>
                        </div>
                    </div>
                </div>
            `;
        });

        html += '</div></div>';
        document.getElementById('overlap-alerts').innerHTML = html;
    }

    function renderDailyTimeline(groupedPlays, overlaps) {
        let html = '';
        const dates = Object.keys(groupedPlays).sort().reverse();

        dates.forEach(date => {
            const plays = groupedPlays[date];
            const dayOverlaps = overlaps.filter(o => getDate(o.play1.time) === date);
            const desktopCount = plays.filter(p => p.device === 'desktop').length;
            const mobileCount = plays.filter(p => p.device === 'mobile').length;

            // Format date for display
            const dateObj = new Date(date);
            const dayNames = ['Pazar', 'Pazartesi', 'Sali', 'Carsamba', 'Persembe', 'Cuma', 'Cumartesi'];
            const dayName = dayNames[dateObj.getDay()];

            html += `
                <div class="card rounded-xl border border-white/10 mb-4 overflow-hidden">
                    <div class="bg-gradient-to-r from-blue-500/20 to-purple-500/20 p-4 border-b border-white/10">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="text-xl font-bold">${date}</h3>
                                <p class="text-gray-400">${dayName}</p>
                            </div>
                            <div class="flex gap-4 text-sm">
                                <span class="px-3 py-1 bg-blue-500/20 rounded-full text-blue-400">
                                    <i class="fas fa-desktop mr-1"></i>${desktopCount}
                                </span>
                                <span class="px-3 py-1 bg-green-500/20 rounded-full text-green-400">
                                    <i class="fas fa-mobile-alt mr-1"></i>${mobileCount}
                                </span>
                                <span class="px-3 py-1 bg-purple-500/20 rounded-full text-purple-400">
                                    <i class="fas fa-music mr-1"></i>${plays.length} play
                                </span>
                                ${dayOverlaps.length > 0 ? `
                                    <span class="px-3 py-1 bg-red-500/20 rounded-full text-red-400">
                                        <i class="fas fa-exclamation-triangle mr-1"></i>${dayOverlaps.length} overlap
                                    </span>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                    <div class="p-4 max-h-96 overflow-y-auto">
                        <div class="timeline-line space-y-2 pl-8">
            `;

            plays.forEach((play, idx) => {
                const isOverlapPlay = overlaps.some(o => o.play1.id === play.id || o.play2.id === play.id);
                const deviceClass = play.device === 'desktop' ? 'device-desktop' : 'device-mobile';

                html += `
                    <div class="relative flex items-center gap-3 ${isOverlapPlay ? 'bg-red-500/10 rounded-lg p-2 -ml-2' : ''}">
                        <div class="play-dot ${deviceClass}"></div>
                        <div class="flex-1 flex items-center justify-between">
                            <div>
                                <span class="text-white font-medium">${play.title}</span>
                                <span class="text-gray-500 text-xs ml-2">#${play.id}</span>
                            </div>
                            <div class="flex items-center gap-3 text-sm">
                                <span class="text-gray-400">${formatDuration(play.duration)}</span>
                                <span class="text-gray-500">${getTimeOnly(play.time)}</span>
                                <i class="fas fa-${play.device === 'desktop' ? 'desktop text-blue-400' : 'mobile-alt text-green-400'}"></i>
                            </div>
                        </div>
                    </div>
                `;
            });

            html += `
                        </div>
                    </div>
                </div>
            `;
        });

        document.getElementById('daily-timeline').innerHTML = html;
    }

    function copyJSON() {
        const analysisResult = {
            user_id: 1,
            period: "2025-12-22 to 2025-12-29",
            total_plays: rawPlayData.length,
            overlaps: detectOverlaps(rawPlayData),
            raw_data: rawPlayData
        };
        navigator.clipboard.writeText(JSON.stringify(analysisResult, null, 2));
        alert('JSON kopyalandi!');
    }

    // =================================================================
    // INIT
    // =================================================================
    document.addEventListener('DOMContentLoaded', () => {
        const overlaps = detectOverlaps(rawPlayData);
        const groupedPlays = groupByDate(rawPlayData);

        renderStats(rawPlayData, overlaps);
        renderOverlapAlerts(overlaps);
        renderDailyTimeline(groupedPlays, overlaps);

        // JSON output
        const analysisResult = {
            user_id: 1,
            period: "2025-12-22 to 2025-12-29",
            generated_at: new Date().toISOString(),
            stats: {
                total_plays: rawPlayData.length,
                total_overlaps: overlaps.length,
                concurrent_overlaps: overlaps.filter(o => o.differentDevices).length,
                abuse_score: overlaps.filter(o => o.differentDevices).reduce((s, o) => s + o.overlapSeconds, 0)
            },
            concurrent_overlaps: overlaps.filter(o => o.differentDevices)
        };
        document.getElementById('json-output').textContent = JSON.stringify(analysisResult, null, 2);
    });
    </script>
</body>
</html>
