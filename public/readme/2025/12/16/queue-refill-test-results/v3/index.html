<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Queue Refill - 200 ÅarkÄ±lÄ±k Tek Request Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-slate-100 min-h-screen">
    <div class="max-w-7xl mx-auto px-4 py-12">
        <!-- Header -->
        <header class="mb-16 pb-8 border-b border-slate-700">
            <div class="flex items-center gap-4 mb-4">
                <h1 class="text-5xl font-bold bg-gradient-to-r from-pink-400 via-purple-400 to-blue-400 bg-clip-text text-transparent">
                    ğŸ² Rastgele TÄ±klamayla BaÅŸlayan Queue
                </h1>
            </div>
            <div class="text-slate-400 text-lg mb-4">
                Tek Request ile 200 ÅarkÄ±lÄ±k Random Queue Doldurma Testi
            </div>
            <div class="flex flex-wrap gap-4 text-sm text-slate-500">
                <span>ğŸ“… 16 AralÄ±k 2025</span>
                <span>ğŸ¯ Muzibu (Tenant 1001)</span>
                <span>ğŸµ 102 Aktif ÅarkÄ±</span>
                <span>ğŸ² limit=200 (Tek Request)</span>
            </div>
        </header>

        <!-- Use Case Scenario -->
        <section class="mb-16">
            <div class="bg-gradient-to-br from-pink-900/30 to-purple-800/30 border-l-4 border-pink-500 rounded-lg p-8">
                <h2 class="text-3xl font-bold mb-4 text-pink-400">ğŸ¯ KullanÄ±m Senaryosu</h2>
                <p class="text-slate-300 text-lg leading-relaxed mb-4">
                    KullanÄ±cÄ± <strong>rastgele bir ÅŸarkÄ±ya</strong> tÄ±kladÄ±ÄŸÄ±nda, player queue'sunu doldurmak iÃ§in
                    <strong>tek bir API request'i</strong> ile <strong>200 ÅŸarkÄ±</strong> random olarak Ã§ekilir.
                </p>
                <div class="bg-slate-800/50 rounded-lg p-4 mb-4">
                    <div class="font-mono text-sm text-slate-300">
                        <div class="text-blue-400 mb-2">// Frontend JavaScript</div>
                        <div>fetch('/api/queue/refill', {</div>
                        <div class="pl-4">method: 'POST',</div>
                        <div class="pl-4">body: JSON.stringify({</div>
                        <div class="pl-8">type: 'popular',  // veya genre, playlist...</div>
                        <div class="pl-8"><span class="text-yellow-300">limit: 200</span>,    // 200 ÅŸarkÄ± iste</div>
                        <div class="pl-4">})</div>
                        <div>})</div>
                    </div>
                </div>
                <p class="text-slate-400 text-sm">
                    Her kullanÄ±cÄ± tÄ±klamasÄ± tamamen farklÄ± queue sÄ±rasÄ± oluÅŸturur - SQL random sayesinde!
                </p>
            </div>
        </section>

        <!-- Test Results -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-blue-400">ğŸ“Š Test SonuÃ§larÄ±</h2>

            <!-- Scenario: Random Click -->
            <div class="bg-slate-800/50 border-l-4 border-purple-500 rounded-lg p-6 mb-6">
                <h3 class="text-2xl font-bold text-purple-300 mb-4">ğŸ² Rastgele ÅarkÄ± TÄ±klama SimÃ¼lasyonu</h3>

                <div class="grid md:grid-cols-3 gap-4 mb-6">
                    <div class="bg-slate-900/50 rounded p-4 text-center">
                        <div class="text-slate-400 text-sm mb-2">Request Limit</div>
                        <div class="text-4xl font-bold text-purple-400">200</div>
                    </div>
                    <div class="bg-slate-900/50 rounded p-4 text-center">
                        <div class="text-slate-400 text-sm mb-2">DÃ¶nen ÅarkÄ±</div>
                        <div class="text-4xl font-bold text-green-400">102</div>
                    </div>
                    <div class="bg-slate-900/50 rounded p-4 text-center">
                        <div class="text-slate-400 text-sm mb-2">Aktif Pool</div>
                        <div class="text-4xl font-bold text-blue-400">102</div>
                    </div>
                </div>

                <div class="space-y-4">
                    <!-- Request 1 -->
                    <div class="bg-purple-900/20 border border-purple-500/30 rounded-lg p-4">
                        <div class="text-purple-400 font-semibold mb-2">ğŸ‘¤ KullanÄ±cÄ± 1 - TÄ±klama</div>
                        <div class="font-mono text-xs text-slate-300">
                            <div class="text-slate-400 mb-1">Ä°lk 20 ÅŸarkÄ±:</div>
                            <div class="mb-2">356, 321, 340, 320, 388, 341, 392, 430, 382, 405, 399, 378, 434, 380, 371, 344, 362, 369, 437, 336</div>
                            <div class="text-slate-400 mb-1">Son 20 ÅŸarkÄ±:</div>
                            <div>374, 381, 379, 386, 373, 352, 348, 370, 390, 368, 387, 337, 324, 442, 347, 322, 440, 318, 429, 406</div>
                        </div>
                    </div>

                    <!-- Request 2 -->
                    <div class="bg-blue-900/20 border border-blue-500/30 rounded-lg p-4">
                        <div class="text-blue-400 font-semibold mb-2">ğŸ‘¤ KullanÄ±cÄ± 2 - TÄ±klama</div>
                        <div class="font-mono text-xs text-slate-300">
                            <div class="text-slate-400 mb-1">Ä°lk 20 ÅŸarkÄ±:</div>
                            <div class="mb-2">406, 381, 319, 404, 339, 409, 430, 395, 369, 342, 349, 334, 377, 361, 436, 402, 375, 396, 398, 383</div>
                            <div class="text-slate-400 mb-1">Son 20 ÅŸarkÄ±:</div>
                            <div>385, 390, 351, 343, 401, 408, 367, 434, 441, 392, 431, 373, 340, 435, 366, 437, 352, 388, 362, 400</div>
                        </div>
                    </div>
                </div>

                <div class="mt-4 flex items-center gap-3 p-4 bg-green-900/20 border border-green-500/30 rounded-lg">
                    <div class="text-4xl">âœ…</div>
                    <div>
                        <div class="text-green-400 font-semibold">Tamamen FarklÄ± SÄ±ra!</div>
                        <div class="text-slate-300 text-sm">Her tÄ±klama unique queue sÄ±rasÄ± oluÅŸturdu - SQL random mÃ¼kemmel Ã§alÄ±ÅŸÄ±yor</div>
                    </div>
                </div>
            </div>

            <!-- Context Comparison -->
            <div class="bg-slate-800/50 rounded-lg p-6 border border-slate-700 mb-6">
                <h3 class="text-2xl font-bold text-green-400 mb-4">ğŸ“¦ Context BazlÄ± 200 ÅarkÄ± Testi</h3>

                <div class="space-y-4">
                    <!-- Genre Context -->
                    <div class="flex items-start gap-4">
                        <div class="bg-blue-500 text-white font-bold rounded-full w-10 h-10 flex items-center justify-center flex-shrink-0">G</div>
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-2">
                                <h4 class="text-lg font-bold text-blue-300">Genre Context (Metal)</h4>
                                <span class="px-3 py-1 bg-blue-600 text-white text-xs rounded-full">23 ÅŸarkÄ±</span>
                            </div>
                            <div class="text-slate-400 text-sm mb-2">Request limit: 200 | DÃ¶nen: 23 (genre'deki tÃ¼m ÅŸarkÄ±lar)</div>
                            <div class="bg-slate-900/50 rounded p-3 font-mono text-xs">
                                <div class="text-slate-400">Ä°lk 15:</div>
                                <div class="text-green-300">406, 407, 395, 408, 390, 410, 393, 389, 394, 392, 398, 404, 403, 409, 401</div>
                            </div>
                        </div>
                    </div>

                    <!-- Playlist Context -->
                    <div class="flex items-start gap-4">
                        <div class="bg-purple-500 text-white font-bold rounded-full w-10 h-10 flex items-center justify-center flex-shrink-0">P</div>
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-2">
                                <h4 class="text-lg font-bold text-purple-300">Playlist Context (Ã–ÄŸle YemeÄŸi)</h4>
                                <span class="px-3 py-1 bg-purple-600 text-white text-xs rounded-full">22 ÅŸarkÄ±</span>
                            </div>
                            <div class="text-slate-400 text-sm mb-2">Request limit: 200 | DÃ¶nen: 22 (playlist'teki tÃ¼m ÅŸarkÄ±lar)</div>
                            <div class="bg-slate-900/50 rounded p-3 font-mono text-xs">
                                <div class="text-slate-400">Ä°lk 15:</div>
                                <div class="text-green-300">342, 369, 375, 399, 338, 408, 363, 364, 322, 392, 320, 359, 343, 314, 395</div>
                            </div>
                        </div>
                    </div>

                    <!-- Popular Context -->
                    <div class="flex items-start gap-4">
                        <div class="bg-yellow-500 text-white font-bold rounded-full w-10 h-10 flex items-center justify-center flex-shrink-0">â­</div>
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-2">
                                <h4 class="text-lg font-bold text-yellow-300">Popular Context</h4>
                                <span class="px-3 py-1 bg-yellow-600 text-white text-xs rounded-full">Top 100 limit</span>
                            </div>
                            <div class="text-slate-400 text-sm mb-2">Request limit: 200 | DÃ¶nen: 100 (tasarÄ±m gereÄŸi top 100 ile sÄ±nÄ±rlÄ±)</div>
                            <div class="bg-yellow-900/20 border border-yellow-500/30 rounded p-3 text-sm text-slate-300">
                                â„¹ï¸ Popular context, en Ã§ok dinlenen 100 ÅŸarkÄ±dan random seÃ§im yapar (play_count sÄ±ralÄ±)
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SQL Random Analysis -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-purple-400">ğŸ”¬ SQL Random Analiz</h2>

            <div class="grid md:grid-cols-2 gap-6">
                <!-- Randomness Quality -->
                <div class="bg-slate-800/50 rounded-lg p-6 border border-slate-700">
                    <h3 class="text-xl font-bold text-green-400 mb-4">âœ… Randomness Kalitesi</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-slate-300">Request 1 vs Request 2:</span>
                            <span class="text-green-400 font-bold">%0 AynÄ± SÄ±ra</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-slate-300">Ortak ÅarkÄ±lar:</span>
                            <span class="text-blue-400 font-bold">102/102 (%100)</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-slate-300">FarklÄ± SÄ±ralama:</span>
                            <span class="text-purple-400 font-bold">%100 FarklÄ±</span>
                        </div>
                    </div>
                    <div class="mt-4 p-3 bg-green-900/20 border border-green-500/30 rounded text-sm text-slate-300">
                        <strong class="text-green-400">SonuÃ§:</strong> AynÄ± ÅŸarkÄ± pool'undan tamamen farklÄ± sÄ±ralar oluÅŸturuluyor
                    </div>
                </div>

                <!-- Performance -->
                <div class="bg-slate-800/50 rounded-lg p-6 border border-slate-700">
                    <h3 class="text-xl font-bold text-blue-400 mb-4">âš¡ Performans</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-slate-300">Tek Request Limit:</span>
                            <span class="text-blue-400 font-bold">200 ÅŸarkÄ±</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-slate-300">Aktif Pool:</span>
                            <span class="text-yellow-400 font-bold">102 ÅŸarkÄ±</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-slate-300">SQL Random:</span>
                            <span class="text-green-400 font-bold">inRandomOrder()</span>
                        </div>
                    </div>
                    <div class="mt-4 p-3 bg-blue-900/20 border border-blue-500/30 rounded text-sm text-slate-300">
                        <strong class="text-blue-400">Not:</strong> Limit 200 olsa da aktif ÅŸarkÄ± sayÄ±sÄ± kadar (102) dÃ¶ner
                    </div>
                </div>
            </div>
        </section>

        <!-- SQL Query Pattern -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-yellow-400">ğŸ’» SQL Query Pattern</h2>

            <div class="bg-slate-800/50 rounded-lg p-6 border border-slate-700">
                <h3 class="text-xl font-bold text-blue-400 mb-4">Rastgele TÄ±klamayla BaÅŸlayan Queue Doldurma</h3>
                <pre class="bg-slate-900 rounded p-4 text-sm text-slate-300 overflow-x-auto"><code>// TÃ¼m aktif ÅŸarkÄ±lardan 200 random seÃ§im
$songs = Song::where('is_active', 1)
    ->inRandomOrder()    // ğŸ² SQL: ORDER BY RAND()
    ->limit(200)         // Maksimum 200 ÅŸarkÄ±
    ->get();

// Context bazlÄ± (Genre Ã¶rneÄŸi)
$songs = Song::where('genre_id', $genreId)
    ->where('is_active', 1)
    ->when(!empty($excludeIds), fn($q) => $q->whereNotIn('song_id', $excludeIds))
    ->with(['album.artist'])
    ->inRandomOrder()    // ğŸ² Her request farklÄ± sÄ±ra
    ->limit(200)
    ->get();</code></pre>

                <div class="mt-4 grid md:grid-cols-2 gap-4">
                    <div class="bg-green-900/20 border border-green-500/30 rounded p-4">
                        <div class="text-green-400 font-semibold mb-2">âœ… Avantajlar</div>
                        <ul class="text-sm text-slate-300 space-y-1">
                            <li>â€¢ SQL seviyesinde random (hÄ±zlÄ±)</li>
                            <li>â€¢ Her request farklÄ± sÄ±ra</li>
                            <li>â€¢ Memory efficient</li>
                            <li>â€¢ Tek query ile 200 ÅŸarkÄ±</li>
                        </ul>
                    </div>
                    <div class="bg-blue-900/20 border border-blue-500/30 rounded p-4">
                        <div class="text-blue-400 font-semibold mb-2">ğŸ¯ KullanÄ±m</div>
                        <ul class="text-sm text-slate-300 space-y-1">
                            <li>â€¢ Queue doldurma</li>
                            <li>â€¢ Shuffle playlist</li>
                            <li>â€¢ Radio mode</li>
                            <li>â€¢ Discovery features</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Context Behavior -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-pink-400">ğŸ­ Context DavranÄ±ÅŸlarÄ±</h2>

            <div class="space-y-4">
                <div class="bg-slate-800/50 rounded-lg p-6 border-l-4 border-blue-500">
                    <h3 class="text-lg font-bold text-blue-400 mb-2">Genre / Album / Playlist</h3>
                    <p class="text-slate-300 mb-2">Context iÃ§indeki <strong>tÃ¼m ÅŸarkÄ±larÄ±</strong> dÃ¶ndÃ¼rÃ¼r (max limit kadar)</p>
                    <div class="text-slate-400 text-sm">
                        Ã–rnek: Metal genre'de 23 ÅŸarkÄ± var â†’ limit=200 olsa da 23 ÅŸarkÄ± dÃ¶ner
                    </div>
                </div>

                <div class="bg-slate-800/50 rounded-lg p-6 border-l-4 border-yellow-500">
                    <h3 class="text-lg font-bold text-yellow-400 mb-2">Popular</h3>
                    <p class="text-slate-300 mb-2"><strong>Top 100</strong> en Ã§ok dinlenen ÅŸarkÄ±dan random seÃ§im</p>
                    <div class="text-slate-400 text-sm">
                        play_count'a gÃ¶re sÄ±ralanmÄ±ÅŸ ilk 100 ÅŸarkÄ± â†’ sonra SQL random
                    </div>
                </div>

                <div class="bg-slate-800/50 rounded-lg p-6 border-l-4 border-purple-500">
                    <h3 class="text-lg font-bold text-purple-400 mb-2">Recent</h3>
                    <p class="text-slate-300 mb-2">En yeni eklenen 50 ÅŸarkÄ±dan random + <strong>Infinite Loop</strong></p>
                    <div class="text-slate-400 text-sm">
                        Exclude list dolunca otomatik baÅŸa sarÄ±yor
                    </div>
                </div>

                <div class="bg-slate-800/50 rounded-lg p-6 border-l-4 border-green-500">
                    <h3 class="text-lg font-bold text-green-400 mb-2">Sector / Radio</h3>
                    <p class="text-slate-300 mb-2">Ä°liÅŸkili playlist'lerdeki ÅŸarkÄ±lardan random seÃ§im</p>
                    <div class="text-slate-400 text-sm">
                        Pivot table Ã¼zerinden song ID'leri toplanÄ±r â†’ SQL random uygulanÄ±r
                    </div>
                </div>
            </div>
        </section>

        <!-- Conclusion -->
        <section class="mb-16">
            <div class="bg-gradient-to-br from-purple-900/30 to-pink-800/30 border-2 border-purple-500 rounded-lg p-8">
                <h2 class="text-3xl font-bold mb-4 text-purple-400">ğŸ‰ SonuÃ§</h2>
                <p class="text-slate-300 text-lg leading-relaxed mb-4">
                    <strong>Tek request ile 200 ÅŸarkÄ±lÄ±k queue doldurma</strong> baÅŸarÄ±yla Ã§alÄ±ÅŸÄ±yor.
                    SQL-level <code class="bg-slate-700 px-2 py-1 rounded">inRandomOrder()</code> her tÄ±klamada
                    tamamen farklÄ± queue sÄ±rasÄ± oluÅŸturuyor.
                </p>
                <div class="grid md:grid-cols-3 gap-4 text-sm">
                    <div class="bg-slate-800/50 rounded p-4">
                        <div class="text-green-400 font-semibold mb-2">âœ… SQL Random</div>
                        <div class="text-slate-300">Her request %100 farklÄ± sÄ±ra</div>
                    </div>
                    <div class="bg-slate-800/50 rounded p-4">
                        <div class="text-blue-400 font-semibold mb-2">âš¡ Performans</div>
                        <div class="text-slate-300">Tek query, 200 ÅŸarkÄ± limit</div>
                    </div>
                    <div class="bg-slate-800/50 rounded p-4">
                        <div class="text-purple-400 font-semibold mb-2">ğŸ¯ Context Aware</div>
                        <div class="text-slate-300">8 farklÄ± context desteÄŸi</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Git Commit -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-slate-400">ğŸ“ Git Commit</h2>
            <div class="bg-slate-800/50 rounded-lg p-6 border border-slate-700">
                <div class="flex items-center gap-3 mb-4">
                    <div class="bg-blue-600 text-white px-3 py-1 rounded font-mono text-sm">
                        9fe46058d
                    </div>
                    <div class="text-slate-300">
                        Fix: Queue refill random & SQL issues
                    </div>
                </div>
                <div class="text-slate-400 text-sm space-y-1">
                    <div>âœ… Tek request 200 ÅŸarkÄ± limit testi passed</div>
                    <div>âœ… SQL random %100 farklÄ± sÄ±ralar oluÅŸturuyor</div>
                    <div>âœ… TÃ¼m context'ler destekleniyor</div>
                    <div>âœ… Production ready</div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="mt-20 pt-8 border-t border-slate-700 text-center text-slate-500 text-sm">
            <p>ğŸ¤– Claude AI tarafÄ±ndan oluÅŸturuldu - 200 ÅarkÄ±lÄ±k Queue Test Raporu v3</p>
            <p class="mt-2">Muzibu Queue Refill System - Single Request 200 Songs Test</p>
        </footer>
    </div>
</body>
</html>
