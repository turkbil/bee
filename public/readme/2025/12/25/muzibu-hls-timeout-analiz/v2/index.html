<!DOCTYPE html>
<html lang="tr" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Muzibu Console Hata Analizi - HLS Timeout (ÅarkÄ± Bilgisi)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        slate: {
                            850: '#1a202e',
                            950: '#0f1419'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
    </style>
</head>
<body class="bg-slate-950 text-slate-100 p-4 sm:p-8">
    <div class="max-w-5xl mx-auto space-y-8">

        <!-- Header -->
        <header class="border-b border-slate-700 pb-6">
            <div class="flex items-center gap-3 mb-4">
                <span class="px-3 py-1 bg-red-900/30 border border-red-700 rounded-lg text-red-300 text-sm font-medium">
                    ğŸš¨ Kritik Hata
                </span>
                <span class="px-3 py-1 bg-purple-900/30 border border-purple-700 rounded-lg text-purple-300 text-sm font-medium">
                    Muzibu.com.tr
                </span>
                <span class="px-3 py-1 bg-blue-900/30 border border-blue-700 rounded-lg text-blue-300 text-sm font-medium">
                    v2 - ÅarkÄ± Tespit
                </span>
            </div>
            <h1 class="text-4xl font-bold text-white mb-2">
                HLS Timeout - Hangi ÅarkÄ±?
            </h1>
            <p class="text-slate-400 text-lg">
                Console'da "Object" yazÄ±yor ama ÅŸarkÄ± bilgisi iÃ§inde var!
            </p>
            <div class="flex items-center gap-4 mt-4 text-sm text-slate-400">
                <span>ğŸ“… 25 AralÄ±k 2025</span>
                <span>â€¢</span>
                <span>ğŸ” Kod analizi: player-core.js:2296</span>
            </div>
        </header>

        <!-- KeÅŸif: ÅarkÄ± Bilgisi Object Ä°Ã§inde -->
        <section class="bg-yellow-900/20 border border-yellow-800 rounded-lg p-6">
            <h2 class="text-2xl font-bold text-yellow-300 mb-4 flex items-center gap-2">
                <span>ğŸ”</span>
                KeÅŸif: ÅarkÄ± Bilgisi AslÄ±nda Var!
            </h2>
            <div class="space-y-4 text-slate-200">
                <p class="text-lg leading-relaxed">
                    Console'da sadece "Object" gÃ¶rÃ¼nÃ¼yor ama <strong>kodda ÅŸarkÄ± bilgisi loglanÄ±yor!</strong>
                </p>
                <div class="bg-slate-900/50 rounded-lg p-4 border border-slate-700">
                    <h3 class="text-lg font-semibold text-yellow-200 mb-3">Kod: player-core.js (satÄ±r 2296-2301)</h3>
                    <pre class="bg-slate-950 text-slate-300 p-4 rounded-lg overflow-x-auto text-sm border border-slate-800"><code>console.warn('âš ï¸ HLS TIMEOUT:', {
    song: self.currentSong?.title,              // ğŸµ ÅARKI BAÅLIÄI
    timeout: hlsTimeoutMs + 'ms',               // â±ï¸ TIMEOUT SÃœRESÄ°
    reason: 'HLS yÃ¼klenemedi (timeout)',        // âŒ SEBEP
    position_sec: Math.round(currentPos)        // ğŸ“ POZÄ°SYON
});</code></pre>
                </div>
                <p class="text-lg leading-relaxed">
                    <strong>Sorun:</strong> Console'da object otomatik expand edilmemiÅŸ, bu yÃ¼zden sadece "Object" yazÄ±yor. <strong>Object'e tÄ±klaman lazÄ±m!</strong>
                </p>
            </div>
        </section>

        <!-- Basit AnlatÄ±m: NasÄ±l GÃ¶rebilirim? -->
        <section class="bg-green-900/20 border border-green-800 rounded-lg p-6">
            <h2 class="text-2xl font-bold text-green-300 mb-4 flex items-center gap-2">
                <span>ğŸ“</span>
                Basit AnlatÄ±m: Hangi ÅarkÄ± OlduÄŸunu NasÄ±l GÃ¶rebilirim?
            </h2>
            <div class="space-y-4 text-slate-200">

                <div class="bg-slate-900/50 rounded-lg p-4 border border-slate-700">
                    <h3 class="text-lg font-semibold text-green-200 mb-3">
                        <span class="text-green-400">YÃ–NtEM 1:</span> Console'da Object'e TÄ±kla (En Kolay)
                    </h3>
                    <ol class="space-y-2 text-slate-300">
                        <li class="flex items-start gap-2">
                            <span class="text-green-400 font-bold">1.</span>
                            <span>Browser console'u aÃ§ (F12 â†’ Console tab)</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-green-400 font-bold">2.</span>
                            <span><code class="bg-slate-800 px-2 py-1 rounded text-sm">âš ï¸ HLS TIMEOUT: Object</code> satÄ±rÄ±nÄ± bul</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-green-400 font-bold">3.</span>
                            <span><strong>"Object"</strong> yazÄ±sÄ±nÄ±n solundaki <strong>Ã¼Ã§gen ok (â–¶)</strong> iÅŸaretine <strong>tÄ±kla</strong></span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-green-400 font-bold">4.</span>
                            <span>Object aÃ§Ä±lÄ±nca <code class="bg-slate-800 px-2 py-1 rounded text-sm">song: "ÅarkÄ± AdÄ±"</code> gÃ¶receksin!</span>
                        </li>
                    </ol>
                    <div class="mt-4 bg-slate-950 rounded-lg p-3 border border-slate-800">
                        <p class="text-slate-400 text-sm mb-2">Ã–rnek expanded object:</p>
                        <pre class="text-slate-300 text-xs"><code>â–¶ Object
  song: "YalnÄ±zlÄ±k Senfonisi"
  timeout: "45000ms"
  reason: "HLS yÃ¼klenemedi (timeout)"
  position_sec: 0</code></pre>
                    </div>
                </div>

                <div class="bg-slate-900/50 rounded-lg p-4 border border-slate-700">
                    <h3 class="text-lg font-semibold text-green-200 mb-3">
                        <span class="text-green-400">YÃ–NTEM 2:</span> Network Tab'den Bak
                    </h3>
                    <ol class="space-y-2 text-slate-300">
                        <li class="flex items-start gap-2">
                            <span class="text-green-400 font-bold">1.</span>
                            <span>F12 â†’ <strong>Network</strong> tab'ine geÃ§</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-green-400 font-bold">2.</span>
                            <span>Filter'a <code class="bg-slate-800 px-2 py-1 rounded text-sm">.m3u8</code> veya <code class="bg-slate-800 px-2 py-1 rounded text-sm">hls</code> yaz</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-green-400 font-bold">3.</span>
                            <span>KÄ±rmÄ±zÄ± (failed) request'leri bul</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-green-400 font-bold">4.</span>
                            <span>URL'de ÅŸarkÄ± ID'si var: <code class="bg-slate-800 px-2 py-1 rounded text-sm">/songs/<strong>1234</strong>/hls/</code></span>
                        </li>
                    </ol>
                </div>

                <div class="bg-slate-900/50 rounded-lg p-4 border border-slate-700">
                    <h3 class="text-lg font-semibold text-green-200 mb-3">
                        <span class="text-green-400">YÃ–NTEM 3:</span> Player Store'u Ä°ncele
                    </h3>
                    <ol class="space-y-2 text-slate-300">
                        <li class="flex items-start gap-2">
                            <span class="text-green-400 font-bold">1.</span>
                            <span>Console'da ÅŸunu yaz:</span>
                        </li>
                    </ol>
                    <div class="mt-2 bg-slate-950 rounded-lg p-3 border border-slate-800">
                        <pre class="text-slate-300 text-sm"><code>Alpine.store('player').currentSong</code></pre>
                    </div>
                    <p class="text-slate-400 text-sm mt-2 ml-6">
                        Bu komut ÅŸu anda Ã§alan (veya Ã§almaya Ã§alÄ±ÅŸan) ÅŸarkÄ±nÄ±n tÃ¼m bilgilerini gÃ¶sterir.
                    </p>
                </div>

            </div>
        </section>

        <!-- Teknik Detaylar -->
        <section class="bg-blue-900/20 border border-blue-800 rounded-lg p-6">
            <h2 class="text-2xl font-bold text-blue-300 mb-4 flex items-center gap-2">
                <span>ğŸ”§</span>
                Teknik Detaylar
            </h2>
            <div class="space-y-4">

                <div class="bg-slate-900/50 rounded-lg p-4 border border-slate-700">
                    <h3 class="text-lg font-semibold text-blue-200 mb-3">Console.warn Object YapÄ±sÄ±</h3>
                    <pre class="bg-slate-950 text-slate-300 p-4 rounded-lg overflow-x-auto text-sm border border-slate-800"><code>{
    song: self.currentSong?.title,              // String | undefined
    timeout: hlsTimeoutMs + 'ms',               // "45000ms"
    reason: 'HLS yÃ¼klenemedi (timeout)',        // String
    position_sec: Math.round(currentPos)        // Number (saniye)
}</code></pre>
                </div>

                <div class="bg-slate-900/50 rounded-lg p-4 border border-slate-700">
                    <h3 class="text-lg font-semibold text-blue-200 mb-3">Timeout SÃ¼resi</h3>
                    <ul class="space-y-2 text-slate-300 text-sm">
                        <li class="flex items-start gap-2">
                            <span class="text-blue-400">â±ï¸</span>
                            <span><strong>45 saniye:</strong> HLS stream yÃ¼klenme timeout'u</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-blue-400">ğŸ“</span>
                            <span><strong>Kod notu:</strong> <code class="text-xs">15s â†’ 45s (increased for stability)</code></span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-blue-400">ğŸ”§</span>
                            <span>EÄŸer 45 saniyede yÃ¼klenmezse â†’ Retry veya MP3 fallback</span>
                        </li>
                    </ul>
                </div>

                <div class="bg-slate-900/50 rounded-lg p-4 border border-slate-700">
                    <h3 class="text-lg font-semibold text-blue-200 mb-3">Retry MekanizmasÄ±</h3>
                    <p class="text-slate-300 mb-3">
                        Timeout olunca kod ÅŸunu yapÄ±yor:
                    </p>
                    <pre class="bg-slate-950 text-slate-300 p-4 rounded-lg text-sm border border-slate-800"><code>// 1. Yeni signed URL al (satÄ±r 2303)
const retried = await self.retryHlsWithNewUrl(
    targetVolume, autoplay, 'timeout', currentPos
);

// 2. Retry baÅŸarÄ±sÄ±zsa MP3 fallback (satÄ±r 2304-2306)
if (!retried) {
    self.triggerMp3Fallback(audio, targetVolume, 'timeout');
}</code></pre>
                    <p class="text-slate-400 text-sm mt-3">
                        <strong>Sorun:</strong> Retry'da da timeout oluyor â†’ Sonsuz dÃ¶ngÃ¼!
                    </p>
                </div>

            </div>
        </section>

        <!-- Ã‡Ã–ZÃ¼m: Log'u Ä°yileÅŸtir -->
        <section class="bg-emerald-900/20 border border-emerald-800 rounded-lg p-6">
            <h2 class="text-2xl font-bold text-emerald-300 mb-4 flex items-center gap-2">
                <span>ğŸ› ï¸</span>
                Ã‡Ã¶zÃ¼m: Log'u Ä°yileÅŸtir (Object Yerine String)
            </h2>
            <div class="space-y-4">
                <p class="text-slate-200">
                    Console'da "Object" yazmasÄ±n, direkt <strong>ÅŸarkÄ± adÄ±</strong> yazsÄ±n.
                </p>

                <div class="bg-slate-900/50 rounded-lg p-4 border border-slate-700">
                    <h3 class="text-lg font-semibold text-emerald-200 mb-3">
                        Mevcut Kod (SatÄ±r 2296-2301)
                    </h3>
                    <pre class="bg-slate-950 text-red-300 p-4 rounded-lg overflow-x-auto text-sm border border-red-800/50"><code>console.warn('âš ï¸ HLS TIMEOUT:', {
    song: self.currentSong?.title,
    timeout: hlsTimeoutMs + 'ms',
    reason: 'HLS yÃ¼klenemedi (timeout)',
    position_sec: Math.round(currentPos)
});</code></pre>
                    <p class="text-slate-400 text-sm mt-2">
                        âŒ Sorun: Object expand edilmeden ÅŸarkÄ± adÄ± gÃ¶rÃ¼nmÃ¼yor
                    </p>
                </div>

                <div class="bg-slate-900/50 rounded-lg p-4 border border-slate-700">
                    <h3 class="text-lg font-semibold text-emerald-200 mb-3">
                        Ä°yileÅŸtirilmiÅŸ Kod (Ã–nerilen)
                    </h3>
                    <pre class="bg-slate-950 text-green-300 p-4 rounded-lg overflow-x-auto text-sm border border-green-800/50"><code>// ğŸ”¥ Ã–nce ÅŸarkÄ± adÄ±nÄ± string olarak logla
console.warn('âš ï¸ HLS TIMEOUT:',
    self.currentSong?.title || 'Bilinmeyen ÅarkÄ±',
    '(' + hlsTimeoutMs + 'ms)'
);

// ğŸ” DetaylÄ± bilgi iÃ§in object de logla (opsiyonel)
console.warn('ğŸ“Š Timeout DetaylarÄ±:', {
    song_id: self.currentSong?.song_id,
    song_title: self.currentSong?.title,
    artist: self.currentSong?.artist?.name,
    timeout: hlsTimeoutMs + 'ms',
    reason: 'HLS yÃ¼klenemedi (timeout)',
    position_sec: Math.round(currentPos),
    hls_url: self._lastHlsUrl
});</code></pre>
                    <p class="text-slate-400 text-sm mt-2">
                        âœ… Avantaj: Console'da direkt ÅŸarkÄ± adÄ± gÃ¶rÃ¼nÃ¼r, detay iÃ§in object'i expand edebilirsin
                    </p>
                </div>

                <div class="bg-slate-900/50 rounded-lg p-4 border border-slate-700">
                    <h3 class="text-lg font-semibold text-emerald-200 mb-3">
                        Ã–rnek Console Ã‡Ä±ktÄ±sÄ± (Ä°yileÅŸtirilmiÅŸ)
                    </h3>
                    <pre class="bg-slate-950 text-slate-300 p-3 rounded-lg text-sm border border-slate-800"><code>âš ï¸ HLS TIMEOUT: YalnÄ±zlÄ±k Senfonisi (45000ms)
ğŸ“Š Timeout DetaylarÄ±: â–¶ Object
    song_id: 1234
    song_title: "YalnÄ±zlÄ±k Senfonisi"
    artist: "Sezen Aksu"
    timeout: "45000ms"
    reason: "HLS yÃ¼klenemedi (timeout)"
    position_sec: 0
    hls_url: "https://..."</code></pre>
                </div>

            </div>
        </section>

        <!-- HÄ±zlÄ± Test: Åimdi Ne YapmalÄ±? -->
        <section class="bg-purple-900/20 border border-purple-800 rounded-lg p-6">
            <h2 class="text-2xl font-bold text-purple-300 mb-4 flex items-center gap-2">
                <span>âš¡</span>
                HÄ±zlÄ± Test: Åimdi Ne YapmalÄ±?
            </h2>
            <div class="space-y-4">
                <div class="bg-slate-900/50 rounded-lg p-4 border border-slate-700">
                    <h3 class="text-lg font-semibold text-purple-200 mb-3">
                        <span class="text-purple-400">ADIM 1:</span> Console'da Object'i Expand Et
                    </h3>
                    <ol class="space-y-2 text-slate-300 text-sm">
                        <li>1. Muzibu.com.tr'ye git, F12 aÃ§</li>
                        <li>2. Bir ÅŸarkÄ± Ã§al (timeout olacak)</li>
                        <li>3. Console'da <code class="bg-slate-800 px-1">âš ï¸ HLS TIMEOUT: Object</code> gÃ¶r</li>
                        <li>4. Object'e tÄ±kla, <code class="bg-slate-800 px-1">song: "..."</code> kÄ±smÄ±nÄ± bul</li>
                        <li>5. ÅarkÄ± adÄ±nÄ± not et</li>
                    </ol>
                </div>

                <div class="bg-slate-900/50 rounded-lg p-4 border border-slate-700">
                    <h3 class="text-lg font-semibold text-purple-200 mb-3">
                        <span class="text-purple-400">ADIM 2:</span> O ÅarkÄ±nÄ±n Storage Durumunu Kontrol Et
                    </h3>
                    <pre class="bg-slate-950 text-slate-300 p-3 rounded-lg text-sm border border-slate-800"><code># Ã–rnek: ÅarkÄ± adÄ± "YalnÄ±zlÄ±k Senfonisi", ID: 1234
ls -lah storage/tenant1001/app/public/songs/1234/hls/</code></pre>
                </div>

                <div class="bg-slate-900/50 rounded-lg p-4 border border-slate-700">
                    <h3 class="text-lg font-semibold text-purple-200 mb-3">
                        <span class="text-purple-400">ADIM 3:</span> Network Tab'den HLS URL'i Test Et
                    </h3>
                    <pre class="bg-slate-950 text-slate-300 p-3 rounded-lg text-sm border border-slate-800"><code># Network tab'den URL kopyala ve test et
curl -I https://muzibu.com/storage/songs/1234/hls/master.m3u8</code></pre>
                </div>

                <div class="bg-slate-900/50 rounded-lg p-4 border border-slate-700">
                    <h3 class="text-lg font-semibold text-purple-200 mb-3">
                        <span class="text-purple-400">ADIM 4:</span> Sorunu Tespit Et
                    </h3>
                    <ul class="space-y-2 text-slate-300 text-sm">
                        <li class="flex items-start gap-2">
                            <span>âœ…</span>
                            <span><strong>200 OK:</strong> HLS dosyasÄ± var, sorun timeout/network â†’ Timeout sÃ¼resini artÄ±r</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span>âŒ</span>
                            <span><strong>404 Not Found:</strong> HLS dosyasÄ± yok â†’ Conversion job Ã§alÄ±ÅŸmamÄ±ÅŸ</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span>âŒ</span>
                            <span><strong>403 Forbidden:</strong> Permission sorunu â†’ Nginx/storage config</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span>âŒ</span>
                            <span><strong>500 Server Error:</strong> PHP/Nginx hatasÄ± â†’ Log'lara bak</span>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="border-t border-slate-700 pt-6 text-center text-slate-400 text-sm">
            <p>ğŸ¤– Claude AI tarafÄ±ndan analiz edildi</p>
            <p class="mt-2">v2 - Console object expand + log iyileÅŸtirme Ã¶nerileri</p>
        </footer>

    </div>
</body>
</html>
