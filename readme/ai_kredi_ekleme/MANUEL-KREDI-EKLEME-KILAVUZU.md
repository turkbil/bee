# üéØ Manuel AI Kredi Ekleme Kƒ±lavuzu

**Tarih:** 27 Ekim 2025
**Sistem:** Tuufi Multi-Tenant AI Credit System
**Sorun:** Tenant'a manuel kredi ekleme i≈ülemi

---

## üìã ƒ∞√áƒ∞NDEKƒ∞LER

1. [Sistem Mimarisi](#sistem-mimarisi)
2. [Sorun Analizi](#sorun-analizi)
3. [Manuel Kredi Ekleme Adƒ±mlarƒ±](#manuel-kredi-ekleme-adƒ±mlarƒ±)
4. [Otomatik Kredi Ekleme (√ñnerilen)](#otomatik-kredi-ekleme-√∂nerilen)
5. [Sorun Giderme](#sorun-giderme)
6. [Gelecek Geli≈ütirmeler](#gelecek-geli≈ütirmeler)

---

## üèóÔ∏è Sƒ∞STEM Mƒ∞MARƒ∞Sƒ∞

### Kredi Saklama Yapƒ±sƒ±

Sistemde AI kredileri **3 farklƒ± yerde** tutulmaktadƒ±r:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  AI KREDƒ∞ Sƒ∞STEMƒ∞ - √ú√á KATMANLI YAPI                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                         ‚îÇ
‚îÇ  1Ô∏è‚É£  ai_credit_purchases Tablosu                       ‚îÇ
‚îÇ     ‚îú‚îÄ Satƒ±n alma kayƒ±tlarƒ± (purchase history)         ‚îÇ
‚îÇ     ‚îú‚îÄ Her satƒ±n alma ayrƒ± bir kayƒ±t                   ‚îÇ
‚îÇ     ‚îî‚îÄ Status: 'completed' olanlar ge√ßerli             ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  2Ô∏è‚É£  tenants.ai_credits_balance Kolonu (INTEGER)       ‚îÇ
‚îÇ     ‚îú‚îÄ Tenant'ƒ±n ger√ßek kullanƒ±labilir kredisi         ‚îÇ
‚îÇ     ‚îú‚îÄ Direkt veritabanƒ± kolonu                        ‚îÇ
‚îÇ     ‚îî‚îÄ ai_get_credit_balance() bu kolonu okur          ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  3Ô∏è‚É£  tenants.data JSON (Virtual Column - Stancl)       ‚îÇ
‚îÇ     ‚îú‚îÄ Stancl Tenancy Virtual Column sistemi           ‚îÇ
‚îÇ     ‚îú‚îÄ Eloquent Model bu deƒüeri √∂ncelikli kullanƒ±r     ‚îÇ
‚îÇ     ‚îî‚îÄ CRITICAL: Bu g√ºncellenmezse kredi g√∂r√ºnmez!     ‚îÇ
‚îÇ                                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Neden 3 Yer?

1. **`ai_credit_purchases`**: Satƒ±n alma ge√ßmi≈üi, raporlama, fatura
2. **`tenants.ai_credits_balance`**: Hƒ±zlƒ± balance query i√ßin
3. **`tenants.data` JSON**: Stancl Tenancy paketi extra kolonlarƒ± JSON'da saklar (Virtual Column sistemi)

---

## üêõ SORUN ANALƒ∞Zƒ∞

### Kar≈üƒ±la≈üƒ±lan Sorun

**Kullanƒ±cƒ± bildirimi:**
> "üí≥ AI Kredi D√º≈ü√ºk seviye - Mevcut: 8.00 kredi"

**Beklenen:** 100,300 kredi
**G√∂r√ºnen:** 8.00 kredi

### K√∂k Sebep

Manuel kredi ekleme yapƒ±lƒ±rken **sadece 2 yer g√ºncellendi:**

```sql
-- ‚úÖ YAPILAN:
INSERT INTO ai_credit_purchases (tenant_id, credit_amount, ...)
VALUES (2, 100000, 'completed', ...);

UPDATE tenants SET ai_credits_balance = ai_credits_balance + 100000
WHERE id = 2;

-- ‚ùå YAPILMAYAN (KRƒ∞Tƒ∞K!):
UPDATE tenants SET data = JSON_SET(data, '$.ai_credits_balance', [YENƒ∞_DEƒûER])
WHERE id = 2;
```

### Neden `data` JSON G√ºncellemesi Kritik?

**Stancl Tenancy Virtual Column Trait'i** Eloquent Model'de `data` JSON i√ßindeki deƒüeri **override** ediyor:

```php
// Stancl\VirtualColumn\VirtualColumn trait'i
// tenants.data JSON i√ßindeki deƒüerler -> Model attribute'lara map ediliyor

// Sonu√ß:
$tenant->ai_credits_balance
// ‚Üì ƒ∞lk olarak data JSON'a bakƒ±yor
// ‚Üì Orada bulamazsa veya farklƒ±ysa, JSON deƒüerini kullanƒ±yor
// ‚úÖ Dolayƒ±sƒ±yla JSON g√ºncellemesi ZORUNLU!
```

---

## üìù MANUEL KREDƒ∞ EKLEME ADIMLARI

### Senaryo: Tenant'a 100,000 Kredi Ekleme

**Tenant ID:** 2 (ixtif.com)
**Eklenecek Kredi:** 100,000

### Adƒ±m 1: Mevcut Durumu Kontrol Et

```bash
# Veritabanƒ± kontrol√º
mariadb -u kullanici -p'sifre' veritabani -e "
SELECT
    id,
    title,
    ai_credits_balance as kolon_kredisi,
    JSON_EXTRACT(data, '\$.ai_credits_balance') as json_kredisi
FROM tenants
WHERE id = 2;
"

# Purchases kontrol√º
mariadb -u kullanici -p'sifre' veritabani -e "
SELECT
    tenant_id,
    SUM(credit_amount) as toplam_purchase,
    COUNT(*) as kayit_sayisi
FROM ai_credit_purchases
WHERE tenant_id = 2 AND status = 'completed'
GROUP BY tenant_id;
"
```

**√ñrnek √áƒ±ktƒ±:**
```
id  title       kolon_kredisi  json_kredisi
2   ixtif.com   75000          8
```

### Adƒ±m 2: Purchase Kaydƒ± Olu≈ütur

```sql
INSERT INTO ai_credit_purchases (
    tenant_id,
    user_id,
    package_id,
    credit_amount,
    price_paid,
    amount,
    currency,
    status,
    payment_method,
    notes,
    purchased_at,
    created_at,
    updated_at
) VALUES (
    2,                              -- tenant_id
    NULL,                           -- user_id (admin grant)
    1,                              -- package_id (referans i√ßin)
    100000,                         -- credit_amount
    0.00,                           -- price_paid (√ºcretsiz)
    0.00,                           -- amount
    'TRY',                          -- currency
    'completed',                    -- status
    'admin_grant',                  -- payment_method
    'Manuel kredi ekleme - [SEBEP YAZIN]',  -- notes
    NOW(),                          -- purchased_at
    NOW(),                          -- created_at
    NOW()                           -- updated_at
);
```

### Adƒ±m 3: Tenant Kolonunu G√ºncelle

```sql
UPDATE tenants
SET ai_credits_balance = ai_credits_balance + 100000
WHERE id = 2;
```

### Adƒ±m 4: Data JSON Kolonunu G√ºncelle (KRƒ∞Tƒ∞K!)

```sql
-- √ñnce yeni toplam deƒüeri hesaplayƒ±n
SET @yeni_toplam = (
    SELECT ai_credits_balance + 100000
    FROM tenants
    WHERE id = 2
);

-- Sonra JSON'u g√ºncelleyin
UPDATE tenants
SET data = JSON_SET(data, '$.ai_credits_balance', @yeni_toplam)
WHERE id = 2;
```

**VEYA** (tek komutla):

```sql
UPDATE tenants
SET data = JSON_SET(data, '$.ai_credits_balance', ai_credits_balance)
WHERE id = 2;
```

### Adƒ±m 5: Cache Temizle

```bash
php artisan cache:clear
php artisan tinker --execute="Cache::forget('tenant_credits_2');"
```

### Adƒ±m 6: Doƒürulama

```bash
# Laravel Tinker ile kontrol
php artisan tinker --execute="
use Modules\AI\App\Services\AICreditService;
\$service = app(AICreditService::class);
echo '‚úÖ Tenant 2 Bakiye: ' . format_credit(\$service->getTenantCredits(2));
"

# Veritabanƒ± kontrol√º
mariadb -u kullanici -p'sifre' veritabani -e "
SELECT
    'Purchases' as kaynak,
    SUM(credit_amount) as toplam
FROM ai_credit_purchases
WHERE tenant_id=2 AND status='completed'
UNION ALL
SELECT 'Tenant Kolon', ai_credits_balance
FROM tenants WHERE id=2
UNION ALL
SELECT 'Data JSON', JSON_EXTRACT(data, '\$.ai_credits_balance')
FROM tenants WHERE id=2;
"
```

**Ba≈üarƒ±lƒ± √áƒ±ktƒ±:**
```
‚úÖ Tenant 2 Bakiye: 175.000,00 Kredi

kaynak          toplam
Purchases       100300
Tenant Kolon    175000
Data JSON       175000
```

---

## ü§ñ OTOMATƒ∞K KREDƒ∞ EKLEME (√ñNERƒ∞LEN)

### Laravel Tinker ile Tek Komut

En g√ºvenli ve √∂nerilen y√∂ntem:

```bash
php artisan tinker
```

```php
use App\Models\Tenant;
use Modules\AI\App\Models\AICreditPurchase;

// Tenant'ƒ± bul
$tenant = Tenant::find(2);

// Eklenecek kredi miktarƒ±
$creditAmount = 100000;

// 1. Purchase kaydƒ± olu≈ütur
$purchase = AICreditPurchase::create([
    'tenant_id' => $tenant->id,
    'user_id' => null,
    'package_id' => 1,
    'credit_amount' => $creditAmount,
    'price_paid' => 0.00,
    'amount' => 0.00,
    'currency' => 'TRY',
    'status' => 'completed',
    'payment_method' => 'admin_grant',
    'notes' => 'Manuel kredi ekleme - ' . now()->format('Y-m-d H:i'),
    'purchased_at' => now(),
]);

// 2. Tenant kolonunu ve JSON'u g√ºncelle
$tenant->increment('ai_credits_balance', $creditAmount);
$tenant->ai_credits_balance = $tenant->ai_credits_balance; // Virtual column sync
$tenant->save();

// 3. Cache temizle
Cache::forget("tenant_credits_{$tenant->id}");

// 4. Doƒürulama
echo "‚úÖ Kredi Eklendi!\n";
echo "Purchase ID: {$purchase->id}\n";
echo "Yeni Bakiye: " . format_credit($tenant->fresh()->ai_credits_balance) . "\n";
```

### Artisan Command Olu≈üturma (Gelecek i√ßin)

**Dosya:** `app/Console/Commands/AddAICreditsCommand.php`

```php
<?php

namespace App\Console\Commands;

use Illuminate\Console\Command;
use App\Models\Tenant;
use Modules\AI\App\Models\AICreditPurchase;
use Illuminate\Support\Facades\Cache;

class AddAICreditsCommand extends Command
{
    protected $signature = 'ai:add-credits
                            {tenant : Tenant ID}
                            {amount : Kredi miktarƒ±}
                            {--reason= : Ekleme sebebi}';

    protected $description = 'Tenant\'a manuel AI kredi ekler';

    public function handle()
    {
        $tenantId = $this->argument('tenant');
        $amount = (int) $this->argument('amount');
        $reason = $this->option('reason') ?? 'Manuel ekleme';

        // Tenant kontrol√º
        $tenant = Tenant::find($tenantId);
        if (!$tenant) {
            $this->error("‚ùå Tenant bulunamadƒ±: {$tenantId}");
            return 1;
        }

        $this->info("üì¶ Tenant: {$tenant->title}");
        $this->info("üí∞ Eklenecek: " . format_credit($amount));

        if (!$this->confirm('Devam edilsin mi?')) {
            $this->warn('ƒ∞ptal edildi.');
            return 0;
        }

        // 1. Purchase kaydƒ±
        $purchase = AICreditPurchase::create([
            'tenant_id' => $tenant->id,
            'user_id' => null,
            'package_id' => 1,
            'credit_amount' => $amount,
            'price_paid' => 0.00,
            'amount' => 0.00,
            'currency' => 'TRY',
            'status' => 'completed',
            'payment_method' => 'admin_grant',
            'notes' => $reason,
            'purchased_at' => now(),
        ]);

        // 2. Tenant g√ºncelleme
        $oldBalance = $tenant->ai_credits_balance;
        $tenant->increment('ai_credits_balance', $amount);
        $tenant->ai_credits_balance = $tenant->fresh()->ai_credits_balance;
        $tenant->save();

        // 3. Cache temizle
        Cache::forget("tenant_credits_{$tenant->id}");

        // Sonu√ß
        $this->info("‚úÖ Ba≈üarƒ±lƒ±!");
        $this->table(
            ['√ñzellik', 'Deƒüer'],
            [
                ['Purchase ID', $purchase->id],
                ['Eski Bakiye', format_credit($oldBalance)],
                ['Eklenen', format_credit($amount)],
                ['Yeni Bakiye', format_credit($tenant->fresh()->ai_credits_balance)],
            ]
        );

        return 0;
    }
}
```

**Kullanƒ±m:**

```bash
# Tenant 2'ye 100,000 kredi ekle
php artisan ai:add-credits 2 100000 --reason="Promosyon kredisi"

# Tenant 3'e 50,000 kredi ekle
php artisan ai:add-credits 3 50000 --reason="Test kredisi"
```

---

## üîß SORUN Gƒ∞DERME

### Problem 1: "Kredi G√∂r√ºnm√ºyor"

**Belirti:** Veritabanƒ±nda kredi var ama panelde 0 g√∂r√ºn√ºyor

**√á√∂z√ºm:**

```bash
# 1. Cache temizle
php artisan cache:clear
php artisan tinker --execute="Cache::forget('tenant_credits_2');"

# 2. Data JSON kontrol√º
mariadb -u kullanici -p'sifre' veritabani -e "
SELECT
    id,
    ai_credits_balance as kolon,
    JSON_EXTRACT(data, '\$.ai_credits_balance') as json_data
FROM tenants WHERE id = 2;
"

# 3. JSON farklƒ±ysa d√ºzelt
mariadb -u kullanici -p'sifre' veritabani -e "
UPDATE tenants
SET data = JSON_SET(data, '\$.ai_credits_balance', ai_credits_balance)
WHERE id = 2;
"
```

### Problem 2: "Eloquent Farklƒ± Deƒüer D√∂nd√ºr√ºyor"

**Belirti:** SQL query 175,000 ama `$tenant->ai_credits_balance` 8 d√∂nd√ºr√ºyor

**Sebep:** Stancl Virtual Column trait'i data JSON'u override ediyor

**√á√∂z√ºm:** Yukarƒ±daki JSON g√ºncelleme SQL'ini √ßalƒ±≈ütƒ±r

### Problem 3: "getTenantCredits() vs ai_get_credit_balance() Farkƒ±"

**Fark:**

```php
// 1. getTenantCredits() - PURCHASES BAZLI
$balance = app(AICreditService::class)->getTenantCredits(2);
// Hesaplama: SUM(purchases.credit_amount) - SUM(usage.credits_used)

// 2. ai_get_credit_balance() - TENANT KOLONU BAZLI
$balance = ai_get_credit_balance(2);
// Direkt: tenants.ai_credits_balance kolonunu okur
```

**Hangi Kullanƒ±lmalƒ±?**

- **Frontend/UI:** `ai_get_credit_balance()` (daha hƒ±zlƒ±, tenant kolonundan direkt)
- **Raporlama:** `getTenantCredits()` (purchases ge√ßmi≈üine g√∂re)

### Problem 4: "Cache Temizlenmiyor"

```bash
# T√ºm cache'i temizle
php artisan cache:clear

# Redis kullanƒ±yorsanƒ±z
redis-cli FLUSHALL

# Tenant-specific cache
php artisan tinker --execute="
Cache::forget('tenant_credits_2');
Cache::forget('user_credits_' . auth()->id());
Cache::forget('credit_breakdown_' . auth()->id());
"
```

---

## üöÄ GELECEK GELƒ∞≈ûTƒ∞RMELER

### 1. Otomatik Sync Sistemi

**Observer olu≈ütur:** `app/Observers/TenantObserver.php`

```php
<?php

namespace App\Observers;

use App\Models\Tenant;

class TenantObserver
{
    public function saving(Tenant $tenant)
    {
        // ai_credits_balance deƒüi≈ütiƒüinde data JSON'u otomatik sync et
        if ($tenant->isDirty('ai_credits_balance')) {
            $data = $tenant->data ?? [];
            $data['ai_credits_balance'] = $tenant->ai_credits_balance;
            $tenant->data = $data;
        }
    }
}
```

**Register et:** `app/Providers/EventServiceProvider.php`

```php
use App\Models\Tenant;
use App\Observers\TenantObserver;

public function boot()
{
    Tenant::observe(TenantObserver::class);
}
```

### 2. Admin Panel UI

**Route:** `routes/admin.php`

```php
Route::post('/tenants/{tenant}/add-credits', [TenantController::class, 'addCredits'])
    ->middleware('role:root')
    ->name('tenants.add-credits');
```

**Controller:** `app/Http/Controllers/Admin/TenantController.php`

```php
public function addCredits(Request $request, Tenant $tenant)
{
    $request->validate([
        'amount' => 'required|integer|min:1',
        'reason' => 'required|string|max:500',
    ]);

    $amount = $request->amount;

    // Purchase kaydƒ±
    $purchase = AICreditPurchase::create([
        'tenant_id' => $tenant->id,
        'user_id' => auth()->id(),
        'package_id' => 1,
        'credit_amount' => $amount,
        'price_paid' => 0.00,
        'amount' => 0.00,
        'currency' => 'TRY',
        'status' => 'completed',
        'payment_method' => 'admin_grant',
        'notes' => $request->reason,
        'purchased_at' => now(),
    ]);

    // Tenant g√ºncelleme
    $tenant->increment('ai_credits_balance', $amount);
    $tenant->ai_credits_balance = $tenant->fresh()->ai_credits_balance;
    $tenant->save();

    // Cache temizle
    Cache::forget("tenant_credits_{$tenant->id}");

    return redirect()->back()->with('success',
        format_credit($amount) . ' kredi ba≈üarƒ±yla eklendi!'
    );
}
```

### 3. Webhook/API Endpoint

√ñdeme gateway'lerinden otomatik kredi ekleme:

```php
// routes/api.php
Route::post('/webhooks/payment/success', [PaymentWebhookController::class, 'success'])
    ->middleware('verify-webhook-signature');

// Controller
public function success(Request $request)
{
    $tenantId = $request->tenant_id;
    $amount = $request->credit_amount;

    // Kredi ekleme i≈ülemi...

    return response()->json(['status' => 'success']);
}
```

---

## üìö ƒ∞LGƒ∞Lƒ∞ DOSYALAR

### Core Files

- **Helper:** `/app/Helpers/CreditHelpers.php` (satƒ±r 203-254: `ai_get_credit_balance()`)
- **Service:** `/Modules/AI/app/Services/AICreditService.php` (satƒ±r 276-301: `getTenantCredits()`)
- **Model:** `/app/Models/Tenant.php` (satƒ±r 32: Virtual Column cast)
- **Migration:** `/Modules/AI/database/migrations/2025_07_01_000002_create_ai_credit_purchases_table.php`

### Routes

- **Admin Routes:** `/Modules/AI/routes/admin.php` (satƒ±r 465-468: `/admin/ai/credits/purchases`)
- **Credit Stats API:** `/Modules/AI/routes/admin.php` (satƒ±r 270-298: `/admin/ai/credit-stats`)

### Views

- **Purchases List:** `/Modules/AI/resources/views/admin/credits/purchases.blade.php` (demo veri - g√ºncellenmeli!)

---

## ‚ö†Ô∏è √ñNEMLƒ∞ NOTLAR

### 1. Stancl Tenancy Virtual Column Sistemi

Stancl Tenancy paketi, `tenants` tablosuna eklenen **custom kolonlarƒ±** otomatik olarak `data` JSON field'ƒ±nda da saklar. Bu sistem:

- **Ïû•Ï†ê:** Esnek, migration'sƒ±z yeni alan ekleme
- **Dezavantaj:** JSON ve kolon senkronizasyonu manuel yapƒ±lmalƒ±

**Trait:** `Stancl\VirtualColumn\VirtualColumn`

### 2. Data JSON Yapƒ±sƒ±

```json
{
  "is_premium": 1,
  "fullname": "Ahmet Kƒ±rmƒ±zƒ±",
  "email": "ahmet@kirmizi.test",
  "phone": "+90 532 111 11 11",
  "ai_credits_balance": 175000,  // ‚Üê KRƒ∞Tƒ∞K!
  "ai_last_used_at": "2025-10-15 01:57:05",
  "tenant_ai_provider_id": null,
  "tenant_ai_provider_model_id": null,
  "created_at": "2025-10-13 21:13:09",
  "updated_at": "2025-10-13 21:13:09"
}
```

### 3. Premium Tenant Kontrol√º

Premium tenant'lar **sƒ±nƒ±rsƒ±z kredi**ye sahiptir:

```php
// Tenant.php - satƒ±r 231-239
public function hasEnoughCredits(float $creditsNeeded): bool
{
    if ($this->isPremium()) {
        return true; // Sƒ±nƒ±rsƒ±z!
    }
    return $this->ai_credits_balance >= $creditsNeeded;
}
```

Tenant 2 (ixtif.com) **is_premium = 1** durumunda!

---

## üìû DESTEK

**Sorun ya≈üarsanƒ±z:**

1. Bu dok√ºmandaki [Sorun Giderme](#sorun-giderme) b√∂l√ºm√ºn√º kontrol edin
2. Log dosyalarƒ±nƒ± inceleyin: `storage/logs/laravel.log`
3. Debug mode a√ßƒ±n: `.env` dosyasƒ±nda `APP_DEBUG=true`
4. Cache temizliƒüi yapƒ±n: `php artisan cache:clear`

**Log kontrol:**

```bash
# Son 50 satƒ±r
tail -n 50 storage/logs/laravel.log

# Kredi ile ilgili loglar
grep -i "credit" storage/logs/laravel.log | tail -20

# Real-time izleme
tail -f storage/logs/laravel.log
```

---

## ‚úÖ CHECKLIST: Manuel Kredi Ekleme

**ƒ∞≈ülem √∂ncesi:**
- [ ] Tenant ID'yi doƒürula
- [ ] Mevcut kredi bakiyesini kaydet
- [ ] Ekleme sebebini belirle (notes)

**ƒ∞≈ülem sƒ±rasƒ±:**
- [ ] 1. Purchase kaydƒ± olu≈ütur (`ai_credit_purchases`)
- [ ] 2. Tenant kolonunu g√ºncelle (`tenants.ai_credits_balance`)
- [ ] 3. Data JSON'u g√ºncelle (`tenants.data`)
- [ ] 4. Cache temizle
- [ ] 5. Doƒürulama yap

**ƒ∞≈ülem sonrasƒ±:**
- [ ] Admin panelden bakiye kontrol et
- [ ] Purchases listesinde kayƒ±t g√∂r√ºn√ºyor mu?
- [ ] Eloquent model doƒüru deƒüer d√∂nd√ºr√ºyor mu?
- [ ] Log kayƒ±tlarƒ±nƒ± kontrol et

---

**Son G√ºncelleme:** 27 Ekim 2025
**Versiyon:** 1.0
**Yazar:** Claude AI + Nurullah

---

**üí° ƒ∞PUCU:** Gelecekte manuel ekleme yapmak yerine yukarƒ±daki **Otomatik Kredi Ekleme** b√∂l√ºm√ºndeki `AddAICreditsCommand` Artisan komutunu kullanmanƒ±zƒ± √∂neririm!
